<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/footprinting/windows_remote_management_protocol/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.4"><title>Windows - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#rdp class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Windows </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../changelog/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1 checked> <label class=md-nav__link for=__nav_2_3_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_2 type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_3 type=checkbox id=__nav_2_3_1_3 checked> <label class=md-nav__link for=__nav_2_3_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Windows <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Windows </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#footprinting-the-service class=md-nav__link> Footprinting the Service </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_1 type=checkbox id=__nav_2_3_2_1> <label class=md-nav__link for=__nav_2_3_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_2 type=checkbox id=__nav_2_3_2_2> <label class=md-nav__link for=__nav_2_3_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1 type=checkbox id=__nav_2_3_3_1> <label class=md-nav__link for=__nav_2_3_3_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_3_3_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_2 type=checkbox id=__nav_2_3_3_1_2> <label class=md-nav__link for=__nav_2_3_3_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_3 type=checkbox id=__nav_2_3_3_1_3> <label class=md-nav__link for=__nav_2_3_3_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_4 type=checkbox id=__nav_2_3_3_1_4> <label class=md-nav__link for=__nav_2_3_3_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_5 type=checkbox id=__nav_2_3_3_1_5> <label class=md-nav__link for=__nav_2_3_3_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_6 type=checkbox id=__nav_2_3_3_1_6> <label class=md-nav__link for=__nav_2_3_3_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_7 type=checkbox id=__nav_2_3_3_1_7> <label class=md-nav__link for=__nav_2_3_3_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_8 type=checkbox id=__nav_2_3_3_1_8> <label class=md-nav__link for=__nav_2_3_3_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_transfers/methods/ class=md-nav__link> Methods </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_6 type=checkbox id=__nav_2_3_6> <label class=md-nav__link for=__nav_2_3_6> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_7 type=checkbox id=__nav_2_3_7> <label class=md-nav__link for=__nav_2_3_7> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_common_apps/setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/containers_software_dev/ class=md-nav__link> Servlet Containers/Software Development </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_8 type=checkbox id=__nav_2_3_8> <label class=md-nav__link for=__nav_2_3_8> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_8> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_web_applications/http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/idor/ class=md-nav__link> Insecure Direct Object References </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9 type=checkbox id=__nav_2_3_9> <label class=md-nav__link for=__nav_2_3_9> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_3_9> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_1 type=checkbox id=__nav_2_3_9_1> <label class=md-nav__link for=__nav_2_3_9_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_2 type=checkbox id=__nav_2_3_9_2> <label class=md-nav__link for=__nav_2_3_9_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_3 type=checkbox id=__nav_2_3_9_3> <label class=md-nav__link for=__nav_2_3_9_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_4 type=checkbox id=__nav_2_3_9_4> <label class=md-nav__link for=__nav_2_3_9_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example3/ class=md-nav__link> SSTI Example3 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10 type=checkbox id=__nav_2_3_10> <label class=md-nav__link for=__nav_2_3_10> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_3_10> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_2 type=checkbox id=__nav_2_3_10_2> <label class=md-nav__link for=__nav_2_3_10_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_3 type=checkbox id=__nav_2_3_10_3> <label class=md-nav__link for=__nav_2_3_10_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_11 type=checkbox id=__nav_2_3_11> <label class=md-nav__link for=__nav_2_3_11> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_3_11> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shells_payloads/msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/windows_shells/ class=md-nav__link> Windows Shells </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_12 type=checkbox id=__nav_2_3_12> <label class=md-nav__link for=__nav_2_3_12> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_3_12> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_3 type=checkbox id=__nav_2_4_2_3> <label class=md-nav__link for=__nav_2_4_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_4 type=checkbox id=__nav_2_4_2_4> <label class=md-nav__link for=__nav_2_4_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#footprinting-the-service class=md-nav__link> Footprinting the Service </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=rdp>RDP<a class=headerlink href=#rdp title="Permanent link">&para;</a></h1> <p>The <a href=https://docs.microsoft.com/en-us/troubleshoot/windows-server/remote/understanding-remote-desktop-protocol>Remote Desktop Protocol</a> (<code>RDP</code>) is a protocol developed by Microsoft for remote access to a computer running the Windows operating system. This protocol allows display and control commands to be transmitted via the GUI encrypted over IP networks. RDP works at the application layer in the TCP/IP reference model, typically utilizing TCP port 3389 as the transport protocol. However, the connectionless UDP protocol can use port 3389 also for remote administration.</p> <p>For an RDP session to be established, both the network firewall and the firewall on the server must allow connections from the outside. If <a href=https://en.wikipedia.org/wiki/Network_address_translation>Network Address Translation</a> (<code>NAT</code>) is used on the route between client and server, as is often the case with Internet connections, the remote computer needs the public IP address to reach the server. In addition, port forwarding must be set up on the NAT router in the direction of the server.</p> <hr> <h2 id=footprinting-the-service>Footprinting the Service<a class=headerlink href=#footprinting-the-service title="Permanent link">&para;</a></h2> <p>Scanning the RDP service can quickly give us a lot of information about the host. For example, we can determine if NLA is enabled on the server or not, the product version, and the hostname.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>hrmns@htb[/htb]$ </span>nmap -sV -sC <span class=m>10</span>.129.201.248 -p3389 --script rdp*
<a id=__codelineno-0-2 name=__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=go>Starting Nmap 7.92 ( https://nmap.org ) at 2021-11-06 15:45 CET</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=go>Nmap scan report for 10.129.201.248</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=go>Host is up (0.036s latency).</span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=go>PORT     STATE SERVICE       VERSION</span>
<a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=go>3389/tcp open  ms-wbt-server Microsoft Terminal Services</span>
<a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=go>| rdp-enum-encryption: </span>
<a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=go>|   Security layer</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=go>|     CredSSP (NLA): SUCCESS</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a><span class=go>|     CredSSP with Early User Auth: SUCCESS</span>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=go>|_    RDSTLS: SUCCESS</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=go>| rdp-ntlm-info: </span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=go>|   Target_Name: ILF-SQL-01</span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=go>|   NetBIOS_Domain_Name: ILF-SQL-01</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=go>|   NetBIOS_Computer_Name: ILF-SQL-01</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=go>|   DNS_Domain_Name: ILF-SQL-01</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=go>|   DNS_Computer_Name: ILF-SQL-01</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=go>|   Product_Version: 10.0.17763</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=go>|_  System_Time: 2021-11-06T13:46:00+00:00</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=go>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=go>Nmap done: 1 IP address (1 host up) scanned in 8.26 seconds</span>
</code></pre></div> <p>In addition, we can use <code>--packet-trace</code> to track the individual packages and inspect their contents manually. We can see that the <code>RDP cookies</code> (<code>mstshash=nmap</code>) used by Nmap to interact with the RDP server can be identified by <code>threat hunters</code> and various security services such as <a href=https://en.wikipedia.org/wiki/Endpoint_detection_and_response>Endpoint Detection and Response</a> (<code>EDR</code>), and can lock us out as penetration testers on hardened networks.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=gp>hrmns@htb[/htb]$ </span>nmap -sV -sC <span class=m>10</span>.129.201.248 -p3389 --packet-trace --disable-arp-ping -n
<a id=__codelineno-1-2 name=__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=go>Starting Nmap 7.92 ( https://nmap.org ) at 2021-11-06 16:23 CET</span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=go>SENT (0.2506s) ICMP [10.10.14.20 &gt; 10.129.201.248 Echo request (type=8/code=0) id=8338 seq=0] IP [ttl=53 id=5122 iplen=28 ]</span>
<a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=go>SENT (0.2507s) TCP 10.10.14.20:55516 &gt; 10.129.201.248:443 S ttl=42 id=24195 iplen=44  seq=1926233369 win=1024 &lt;mss 1460&gt;</span>
<a id=__codelineno-1-6 name=__codelineno-1-6></a><span class=go>SENT (0.2507s) TCP 10.10.14.20:55516 &gt; 10.129.201.248:80 A ttl=55 id=50395 iplen=40  seq=0 win=1024</span>
<a id=__codelineno-1-7 name=__codelineno-1-7></a><span class=go>SENT (0.2517s) ICMP [10.10.14.20 &gt; 10.129.201.248 Timestamp request (type=13/code=0) id=8247 seq=0 orig=0 recv=0 trans=0] IP [ttl=38 id=62695 iplen=40 ]</span>
<a id=__codelineno-1-8 name=__codelineno-1-8></a><span class=go>RCVD (0.2814s) ICMP [10.129.201.248 &gt; 10.10.14.20 Echo reply (type=0/code=0) id=8338 seq=0] IP [ttl=127 id=38158 iplen=28 ]</span>
<a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=go>SENT (0.3264s) TCP 10.10.14.20:55772 &gt; 10.129.201.248:3389 S ttl=56 id=274 iplen=44  seq=2635590698 win=1024 &lt;mss 1460&gt;</span>
<a id=__codelineno-1-10 name=__codelineno-1-10></a><span class=go>RCVD (0.3565s) TCP 10.129.201.248:3389 &gt; 10.10.14.20:55772 SA ttl=127 id=38162 iplen=44  seq=3526777417 win=64000 &lt;mss 1357&gt;</span>
<a id=__codelineno-1-11 name=__codelineno-1-11></a><span class=go>NSOCK INFO [0.4500s] nsock_iod_new2(): nsock_iod_new (IOD #1)</span>
<a id=__codelineno-1-12 name=__codelineno-1-12></a><span class=go>NSOCK INFO [0.4500s] nsock_connect_tcp(): TCP connection requested to 10.129.201.248:3389 (IOD #1) EID 8</span>
<a id=__codelineno-1-13 name=__codelineno-1-13></a><span class=go>NSOCK INFO [0.4820s] nsock_trace_handler_callback(): Callback: CONNECT SUCCESS for EID 8 [10.129.201.248:3389]</span>
<a id=__codelineno-1-14 name=__codelineno-1-14></a><span class=go>Service scan sending probe NULL to 10.129.201.248:3389 (tcp)</span>
<a id=__codelineno-1-15 name=__codelineno-1-15></a><span class=go>NSOCK INFO [0.4830s] nsock_read(): Read request from IOD #1 [10.129.201.248:3389] (timeout: 6000ms) EID 18</span>
<a id=__codelineno-1-16 name=__codelineno-1-16></a><span class=go>NSOCK INFO [6.4880s] nsock_trace_handler_callback(): Callback: READ TIMEOUT for EID 18 [10.129.201.248:3389]</span>
<a id=__codelineno-1-17 name=__codelineno-1-17></a><span class=go>Service scan sending probe TerminalServerCookie to 10.129.201.248:3389 (tcp)</span>
<a id=__codelineno-1-18 name=__codelineno-1-18></a><span class=go>NSOCK INFO [6.4880s] nsock_write(): Write request for 42 bytes to IOD #1 EID 27 [10.129.201.248:3389]</span>
<a id=__codelineno-1-19 name=__codelineno-1-19></a><span class=go>NSOCK INFO [6.4880s] nsock_read(): Read request from IOD #1 [10.129.201.248:3389] (timeout: 5000ms) EID 34</span>
<a id=__codelineno-1-20 name=__codelineno-1-20></a><span class=go>NSOCK INFO [6.4880s] nsock_trace_handler_callback(): Callback: WRITE SUCCESS for EID 27 [10.129.201.248:3389]</span>
<a id=__codelineno-1-21 name=__codelineno-1-21></a><span class=go>NSOCK INFO [6.5240s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 34 [10.129.201.248:3389] (19 bytes): .........4.........</span>
<a id=__codelineno-1-22 name=__codelineno-1-22></a><span class=go>Service scan match (Probe TerminalServerCookie matched with TerminalServerCookie line 13640): 10.129.201.248:3389 is ms-wbt-server.  Version: |Microsoft Terminal Services|||</span>
<a id=__codelineno-1-23 name=__codelineno-1-23></a>
<a id=__codelineno-1-24 name=__codelineno-1-24></a><span class=go>...SNIP...</span>
<a id=__codelineno-1-25 name=__codelineno-1-25></a>
<a id=__codelineno-1-26 name=__codelineno-1-26></a><span class=go>NSOCK INFO [6.5610s] nsock_write(): Write request for 54 bytes to IOD #1 EID 27 [10.129.201.248:3389]</span>
<a id=__codelineno-1-27 name=__codelineno-1-27></a><span class=go>NSE: TCP 10.10.14.20:36630 &gt; 10.129.201.248:3389 | 00000000: 03 00 00 2a 25 e0 00 00 00 00 00 43 6f 6f 6b 69    *%      Cooki</span>
<a id=__codelineno-1-28 name=__codelineno-1-28></a><span class=go>00000010: 65 3a 20 6d 73 74 73 68 61 73 68 3d 6e 6d 61 70 e: mstshash=nmap</span>
<a id=__codelineno-1-29 name=__codelineno-1-29></a><span class=go>00000020: 0d 0a 01 00 08 00 0b 00 00 00  </span>
<a id=__codelineno-1-30 name=__codelineno-1-30></a>
<a id=__codelineno-1-31 name=__codelineno-1-31></a><span class=go>...SNIP...</span>
<a id=__codelineno-1-32 name=__codelineno-1-32></a>
<a id=__codelineno-1-33 name=__codelineno-1-33></a><span class=go>NSOCK INFO [6.6820s] nsock_write(): Write request for 57 bytes to IOD #2 EID 67 [10.129.201.248:3389]</span>
<a id=__codelineno-1-34 name=__codelineno-1-34></a><span class=go>NSOCK INFO [6.6820s] nsock_trace_handler_callback(): Callback: WRITE SUCCESS for EID 67 [10.129.201.248:3389]</span>
<a id=__codelineno-1-35 name=__codelineno-1-35></a><span class=go>NSE: TCP 10.10.14.20:36630 &gt; 10.129.201.248:3389 | SEND</span>
<a id=__codelineno-1-36 name=__codelineno-1-36></a><span class=go>NSOCK INFO [6.6820s] nsock_read(): Read request from IOD #2 [10.129.201.248:3389] (timeout: 5000ms) EID 74</span>
<a id=__codelineno-1-37 name=__codelineno-1-37></a><span class=go>NSOCK INFO [6.7180s] nsock_trace_handler_callback(): Callback: READ SUCCESS for EID 74 [10.129.201.248:3389] (211 bytes)</span>
<a id=__codelineno-1-38 name=__codelineno-1-38></a><span class=go>NSE: TCP 10.10.14.20:36630 &lt; 10.129.201.248:3389 | </span>
<a id=__codelineno-1-39 name=__codelineno-1-39></a><span class=go>00000000: 30 81 d0 a0 03 02 01 06 a1 81 c8 30 81 c5 30 81 0          0  0</span>
<a id=__codelineno-1-40 name=__codelineno-1-40></a><span class=go>00000010: c2 a0 81 bf 04 81 bc 4e 54 4c 4d 53 53 50 00 02        NTLMSSP</span>
<a id=__codelineno-1-41 name=__codelineno-1-41></a><span class=go>00000020: 00 00 00 14 00 14 00 38 00 00 00 35 82 8a e2 b9        8   5</span>
<a id=__codelineno-1-42 name=__codelineno-1-42></a><span class=go>00000030: 73 b0 b3 91 9f 1b 0d 00 00 00 00 00 00 00 00 70 s              p</span>
<a id=__codelineno-1-43 name=__codelineno-1-43></a><span class=go>00000040: 00 70 00 4c 00 00 00 0a 00 63 45 00 00 00 0f 49  p L     cE    I</span>
<a id=__codelineno-1-44 name=__codelineno-1-44></a><span class=go>00000050: 00 4c 00 46 00 2d 00 53 00 51 00 4c 00 2d 00 30  L F - S Q L - 0</span>
<a id=__codelineno-1-45 name=__codelineno-1-45></a><span class=go>00000060: 00 31 00 02 00 14 00 49 00 4c 00 46 00 2d 00 53  1     I L F - S</span>
<a id=__codelineno-1-46 name=__codelineno-1-46></a><span class=go>00000070: 00 51 00 4c 00 2d 00 30 00 31 00 01 00 14 00 49  Q L - 0 1     I</span>
<a id=__codelineno-1-47 name=__codelineno-1-47></a><span class=go>00000080: 00 4c 00 46 00 2d 00 53 00 51 00 4c 00 2d 00 30  L F - S Q L - 0</span>
<a id=__codelineno-1-48 name=__codelineno-1-48></a><span class=go>00000090: 00 31 00 04 00 14 00 49 00 4c 00 46 00 2d 00 53  1     I L F - S</span>
<a id=__codelineno-1-49 name=__codelineno-1-49></a><span class=go>000000a0: 00 51 00 4c 00 2d 00 30 00 31 00 03 00 14 00 49  Q L - 0 1     I</span>
<a id=__codelineno-1-50 name=__codelineno-1-50></a><span class=go>000000b0: 00 4c 00 46 00 2d 00 53 00 51 00 4c 00 2d 00 30  L F - S Q L - 0</span>
<a id=__codelineno-1-51 name=__codelineno-1-51></a><span class=go>000000c0: 00 31 00 07 00 08 00 1d b3 e8 f2 19 d3 d7 01 00  1</span>
<a id=__codelineno-1-52 name=__codelineno-1-52></a><span class=go>000000d0: 00 00 00</span>
<a id=__codelineno-1-53 name=__codelineno-1-53></a>
<a id=__codelineno-1-54 name=__codelineno-1-54></a><span class=go>...SNIP...</span>
</code></pre></div> <p>A Perl script named <a href=https://github.com/CiscoCXSecurity/rdp-sec-check>rdp-sec-check.pl</a> has also been developed by <a href=https://github.com/CiscoCXSecurity>Cisco CX Security Labs</a> that can unauthentically identify the security settings of RDP servers based on the handshakes.</p> <p>RDP Security Check - Installation <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo cpan
<a id=__codelineno-2-2 name=__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3></a><span class=go>Loading internal logger. Log::Log4perl recommended for better logging</span>
<a id=__codelineno-2-4 name=__codelineno-2-4></a>
<a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=go>CPAN.pm requires configuration, but most of it can be done automatically.</span>
<a id=__codelineno-2-6 name=__codelineno-2-6></a><span class=go>If you answer &#39;no&#39; below, you will enter an interactive dialog for each</span>
<a id=__codelineno-2-7 name=__codelineno-2-7></a><span class=go>configuration option instead.</span>
<a id=__codelineno-2-8 name=__codelineno-2-8></a>
<a id=__codelineno-2-9 name=__codelineno-2-9></a><span class=go>Would you like to configure as much as possible automatically? [yes] yes</span>
<a id=__codelineno-2-10 name=__codelineno-2-10></a>
<a id=__codelineno-2-11 name=__codelineno-2-11></a>
<a id=__codelineno-2-12 name=__codelineno-2-12></a><span class=go>Autoconfiguration complete.</span>
<a id=__codelineno-2-13 name=__codelineno-2-13></a>
<a id=__codelineno-2-14 name=__codelineno-2-14></a><span class=go>commit: wrote &#39;/root/.cpan/CPAN/MyConfig.pm&#39;</span>
<a id=__codelineno-2-15 name=__codelineno-2-15></a>
<a id=__codelineno-2-16 name=__codelineno-2-16></a><span class=go>You can re-run configuration any time with &#39;o conf init&#39; in the CPAN shell</span>
<a id=__codelineno-2-17 name=__codelineno-2-17></a>
<a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=go>cpan shell -- CPAN exploration and modules installation (v2.27)</span>
<a id=__codelineno-2-19 name=__codelineno-2-19></a><span class=go>Enter &#39;h&#39; for help.</span>
<a id=__codelineno-2-20 name=__codelineno-2-20></a>
<a id=__codelineno-2-21 name=__codelineno-2-21></a>
<a id=__codelineno-2-22 name=__codelineno-2-22></a><span class=go>cpan[1]&gt; install Encoding::BER</span>
<a id=__codelineno-2-23 name=__codelineno-2-23></a>
<a id=__codelineno-2-24 name=__codelineno-2-24></a><span class=go>Fetching with LWP:</span>
<a id=__codelineno-2-25 name=__codelineno-2-25></a><span class=go>http://www.cpan.org/authors/01mailrc.txt.gz</span>
<a id=__codelineno-2-26 name=__codelineno-2-26></a><span class=go>Reading &#39;/root/.cpan/sources/authors/01mailrc.txt.gz&#39;</span>
<a id=__codelineno-2-27 name=__codelineno-2-27></a><span class=go>............................................................................DONE</span>
<a id=__codelineno-2-28 name=__codelineno-2-28></a><span class=go>...SNIP...</span>
</code></pre></div></p> <p>RDP Security Check <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=gp>hrmns@htb[/htb]$ </span>git clone https://github.com/CiscoCXSecurity/rdp-sec-check.git <span class=o>&amp;&amp;</span> <span class=nb>cd</span> rdp-sec-check
<a id=__codelineno-3-2 name=__codelineno-3-2></a><span class=gp>hrmns@htb[/htb]$ </span>./rdp-sec-check.pl <span class=m>10</span>.129.201.248
<a id=__codelineno-3-3 name=__codelineno-3-3></a>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=go>Starting rdp-sec-check v0.9-beta ( http://labs.portcullis.co.uk/application/rdp-sec-check/ ) at Sun Nov  7 16:50:32 2021</span>
<a id=__codelineno-3-5 name=__codelineno-3-5></a>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=go>[+] Scanning 1 hosts</span>
<a id=__codelineno-3-7 name=__codelineno-3-7></a>
<a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=go>Target:    10.129.201.248</span>
<a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=go>IP:        10.129.201.248</span>
<a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=go>Port:      3389</span>
<a id=__codelineno-3-11 name=__codelineno-3-11></a>
<a id=__codelineno-3-12 name=__codelineno-3-12></a><span class=go>[+] Checking supported protocols</span>
<a id=__codelineno-3-13 name=__codelineno-3-13></a>
<a id=__codelineno-3-14 name=__codelineno-3-14></a><span class=go>[-] Checking if RDP Security (PROTOCOL_RDP) is supported...Not supported - HYBRID_REQUIRED_BY_SERVER</span>
<a id=__codelineno-3-15 name=__codelineno-3-15></a><span class=go>[-] Checking if TLS Security (PROTOCOL_SSL) is supported...Not supported - HYBRID_REQUIRED_BY_SERVER</span>
<a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=go>[-] Checking if CredSSP Security (PROTOCOL_HYBRID) is supported [uses NLA]...Supported</span>
<a id=__codelineno-3-17 name=__codelineno-3-17></a>
<a id=__codelineno-3-18 name=__codelineno-3-18></a><span class=go>[+] Checking RDP Security Layer</span>
<a id=__codelineno-3-19 name=__codelineno-3-19></a>
<a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=go>[-] Checking RDP Security Layer with encryption ENCRYPTION_METHOD_NONE...Not supported</span>
<a id=__codelineno-3-21 name=__codelineno-3-21></a><span class=go>[-] Checking RDP Security Layer with encryption ENCRYPTION_METHOD_40BIT...Not supported</span>
<a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=go>[-] Checking RDP Security Layer with encryption ENCRYPTION_METHOD_128BIT...Not supported</span>
<a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=go>[-] Checking RDP Security Layer with encryption ENCRYPTION_METHOD_56BIT...Not supported</span>
<a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=go>[-] Checking RDP Security Layer with encryption ENCRYPTION_METHOD_FIPS...Not supported</span>
<a id=__codelineno-3-25 name=__codelineno-3-25></a>
<a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=go>[+] Summary of protocol support</span>
<a id=__codelineno-3-27 name=__codelineno-3-27></a>
<a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=go>[-] 10.129.201.248:3389 supports PROTOCOL_SSL   : FALSE</span>
<a id=__codelineno-3-29 name=__codelineno-3-29></a><span class=go>[-] 10.129.201.248:3389 supports PROTOCOL_HYBRID: TRUE</span>
<a id=__codelineno-3-30 name=__codelineno-3-30></a><span class=go>[-] 10.129.201.248:3389 supports PROTOCOL_RDP   : FALSE</span>
<a id=__codelineno-3-31 name=__codelineno-3-31></a>
<a id=__codelineno-3-32 name=__codelineno-3-32></a><span class=go>[+] Summary of RDP encryption support</span>
<a id=__codelineno-3-33 name=__codelineno-3-33></a>
<a id=__codelineno-3-34 name=__codelineno-3-34></a><span class=go>[-] 10.129.201.248:3389 supports ENCRYPTION_METHOD_NONE   : FALSE</span>
<a id=__codelineno-3-35 name=__codelineno-3-35></a><span class=go>[-] 10.129.201.248:3389 supports ENCRYPTION_METHOD_40BIT  : FALSE</span>
<a id=__codelineno-3-36 name=__codelineno-3-36></a><span class=go>[-] 10.129.201.248:3389 supports ENCRYPTION_METHOD_128BIT : FALSE</span>
<a id=__codelineno-3-37 name=__codelineno-3-37></a><span class=go>[-] 10.129.201.248:3389 supports ENCRYPTION_METHOD_56BIT  : FALSE</span>
<a id=__codelineno-3-38 name=__codelineno-3-38></a><span class=go>[-] 10.129.201.248:3389 supports ENCRYPTION_METHOD_FIPS   : FALSE</span>
<a id=__codelineno-3-39 name=__codelineno-3-39></a>
<a id=__codelineno-3-40 name=__codelineno-3-40></a><span class=go>[+] Summary of security issues</span>
<a id=__codelineno-3-41 name=__codelineno-3-41></a>
<a id=__codelineno-3-42 name=__codelineno-3-42></a>
<a id=__codelineno-3-43 name=__codelineno-3-43></a><span class=go>rdp-sec-check v0.9-beta completed at Sun Nov  7 16:50:33 2021</span>
</code></pre></div></p> <hr> <h1 id=winrm>WinRM<a class=headerlink href=#winrm title="Permanent link">&para;</a></h1> <p>The Windows Remote Management (<code>WinRM</code>) is a simple Windows integrated remote management protocol based on the command line. WinRM uses the Simple Object Access Protocol (<code>SOAP</code>) to establish connections to remote hosts and their applications. Therefore, WinRM must be explicitly enabled and configured starting with Windows 10. WinRM relies on <code>TCP</code> ports <code>5985</code> and <code>5986</code> for communication, with the last port <code>5986 using HTTPS</code>, as ports 80 and 443 were previously used for this task.</p> <hr> <h2 id=footprinting-the-service_1>Footprinting the Service<a class=headerlink href=#footprinting-the-service_1 title="Permanent link">&para;</a></h2> <p>We will see that only HTTP (<code>TCP 5985</code>) is used instead of HTTPS (<code>TCP 5986</code>).</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=gp>rmns@htb[/htb]$ </span>nmap -sV -sC <span class=m>10</span>.129.201.248 -p5985,5986 --disable-arp-ping -n
<a id=__codelineno-4-2 name=__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3></a><span class=go>Starting Nmap 7.92 ( https://nmap.org ) at 2021-11-06 16:31 CET</span>
<a id=__codelineno-4-4 name=__codelineno-4-4></a><span class=go>Nmap scan report for 10.129.201.248</span>
<a id=__codelineno-4-5 name=__codelineno-4-5></a><span class=go>Host is up (0.030s latency).</span>
<a id=__codelineno-4-6 name=__codelineno-4-6></a>
<a id=__codelineno-4-7 name=__codelineno-4-7></a><span class=go>PORT     STATE SERVICE VERSION</span>
<a id=__codelineno-4-8 name=__codelineno-4-8></a><span class=go>5985/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span>
<a id=__codelineno-4-9 name=__codelineno-4-9></a><span class=go>|_http-title: Not Found</span>
<a id=__codelineno-4-10 name=__codelineno-4-10></a><span class=go>|_http-server-header: Microsoft-HTTPAPI/2.0</span>
<a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=go>Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows</span>
<a id=__codelineno-4-12 name=__codelineno-4-12></a>
<a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=go>Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<a id=__codelineno-4-14 name=__codelineno-4-14></a><span class=go>Nmap done: 1 IP address (1 host up) scanned in 7.34 seconds</span>
</code></pre></div> <p>If we want to find out whether one or more remote servers can be reached via WinRM, we can easily do this with the help of PowerShell. We can use the tool called <a href=https://github.com/Hackplayers/evil-winrm>evil-winrm</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=gp>hrmns@htb[/htb]$ </span>evil-winrm -i <span class=m>10</span>.129.201.248 -u Cry0l1t3 -p P455w0rD!
<a id=__codelineno-5-2 name=__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=go>Evil-WinRM shell v3.3</span>
<a id=__codelineno-5-4 name=__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=go>Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine</span>
<a id=__codelineno-5-6 name=__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7></a><span class=go>Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion</span>
<a id=__codelineno-5-8 name=__codelineno-5-8></a>
<a id=__codelineno-5-9 name=__codelineno-5-9></a><span class=go>Info: Establishing connection to remote endpoint</span>
<a id=__codelineno-5-10 name=__codelineno-5-10></a>
<a id=__codelineno-5-11 name=__codelineno-5-11></a><span class=go>*Evil-WinRM* PS C:\Users\Cry0l1t3\Documents&gt;</span>
</code></pre></div> <hr> <h1 id=wmi>WMI<a class=headerlink href=#wmi title="Permanent link">&para;</a></h1> <p>Windows Management Instrumentation (<code>WMI</code>) is Microsoft's implementation and also an extension of the Common Information Model (<code>CIM</code>), core functionality of the standardized Web-Based Enterprise Management (<code>WBEM</code>) for the Windows platform. WMI allows read and write access to almost all settings on Windows systems. Understandably, this makes it the most critical interface in the Windows environment for the administration and remote maintenance of Windows computers, regardless of whether they are PCs or servers. WMI is typically accessed via PowerShell, VBScript, or the Windows Management Instrumentation Console (<code>WMIC</code>). WMI is not a single program but consists of several programs and various databases, also known as repositories.</p> <hr> <h2 id=footprinting-the-service_2>Footprinting the Service<a class=headerlink href=#footprinting-the-service_2 title="Permanent link">&para;</a></h2> <p>The initialization of the WMI communication always takes place on <code>TCP</code> port <code>135</code>, and after the successful establishment of the connection, the communication is moved to a random port. For example, the program <a href=https://github.com/SecureAuthCorp/impacket/blob/master/examples/wmiexec.py>wmiexec.py</a> from the Impacket toolkit can be used for this.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=gp>hrmns@htb[/htb]$ </span>/usr/share/doc/python3-impacket/examples/wmiexec.py Cry0l1t3:<span class=s2>&quot;P455w0rD!&quot;</span>@10.129.201.248 <span class=s2>&quot;hostname&quot;</span>
<a id=__codelineno-6-2 name=__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3></a><span class=go>Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation</span>
<a id=__codelineno-6-4 name=__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5></a><span class=go>[*] SMBv3.0 dialect used</span>
<a id=__codelineno-6-6 name=__codelineno-6-6></a><span class=go>ILF-SQL-01</span>
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../linux_remote_management_protocol/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Linux" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Linux </div> </div> </a> <a href=../../basics_linux/linux/ class="md-footer__link md-footer__link--next" aria-label="Next: Linux" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Linux </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>